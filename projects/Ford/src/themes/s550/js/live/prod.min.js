
var OpenLayers={VERSION_NUMBER:"Release 2.12",singleFile:true,_getScriptLocation:function(){for(var a=/(^|(.*?\/))(OpenLayers[^\/]*?\.js)(\?|$)/,b=document.getElementsByTagName("script"),c,f="",d=0,e=b.length;d<e;d++)if(c=b[d].getAttribute("src"))if(c=c.match(a)){f=c[1];break}return function(){return f}}(),ImgPath:""};
OpenLayers.Class=function(){var a=arguments.length,b=arguments[0],c=arguments[a-1],f=typeof c.initialize=="function"?c.initialize:function(){b.prototype.initialize.apply(this,arguments)};if(a>1){a=[f,b].concat(Array.prototype.slice.call(arguments).slice(1,a-1),c);OpenLayers.inherit.apply(null,a)}else f.prototype=c;return f};
OpenLayers.inherit=function(a,b){var c=function(){};c.prototype=b.prototype;a.prototype=new c;var f,d;c=2;for(f=arguments.length;c<f;c++){d=arguments[c];if(typeof d==="function")d=d.prototype;OpenLayers.Util.extend(a.prototype,d)}};OpenLayers.Util=OpenLayers.Util||{};OpenLayers.Util.extend=function(a,b){a=a||{};if(b){for(var c in b){var f=b[c];if(f!==undefined)a[c]=f}if(!(typeof window.Event=="function"&&b instanceof window.Event)&&b.hasOwnProperty&&b.hasOwnProperty("toString"))a.toString=b.toString}return a};
OpenLayers.Animation=function(a){function b(h,i,j){i=i>0?i:Number.POSITIVE_INFINITY;var l=++e,k=+new Date;g[l]=function(){if(g[l]&&+new Date-k<=i){h();g[l]&&d(g[l],j)}else delete g[l]};d(g[l],j);return l}function c(h){delete g[h]}var f=!!(a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame),d=function(){var h=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||
a.msRequestAnimationFrame||function(i){a.setTimeout(i,16)};return function(i,j){h.apply(a,[i,j])}}(),e=0,g={};return{isNative:f,requestFrame:d,start:b,stop:c}}(window);
OpenLayers.Tween=OpenLayers.Class({easing:null,begin:null,finish:null,duration:null,callbacks:null,time:null,animationId:null,playing:false,initialize:function(a){this.easing=a?a:OpenLayers.Easing.Expo.easeOut},start:function(a,b,c,f){this.playing=true;this.begin=a;this.finish=b;this.duration=c;this.callbacks=f.callbacks;this.time=0;OpenLayers.Animation.stop(this.animationId);this.animationId=null;this.callbacks&&this.callbacks.start&&this.callbacks.start.call(this,this.begin);this.animationId=OpenLayers.Animation.start(OpenLayers.Function.bind(this.play,
this))},stop:function(){if(this.playing){this.callbacks&&this.callbacks.done&&this.callbacks.done.call(this,this.finish);OpenLayers.Animation.stop(this.animationId);this.animationId=null;this.playing=false}},play:function(){var a={};for(var b in this.begin){var c=this.begin[b],f=this.finish[b];if(c==null||f==null||isNaN(c)||isNaN(f))throw new TypeError("invalid value for Tween");a[b]=this.easing.apply(this,[this.time,c,f-c,this.duration])}this.time++;this.callbacks&&this.callbacks.eachStep&&this.callbacks.eachStep.call(this,
a);this.time>this.duration&&this.stop()},CLASS_NAME:"OpenLayers.Tween"});OpenLayers.Easing={CLASS_NAME:"OpenLayers.Easing"};OpenLayers.Easing.Linear={easeIn:function(a,b,c,f){return c*a/f+b},easeOut:function(a,b,c,f){return c*a/f+b},easeInOut:function(a,b,c,f){return c*a/f+b},CLASS_NAME:"OpenLayers.Easing.Linear"};
OpenLayers.Easing.Expo={easeIn:function(a,b,c,f){return a==0?b:c*Math.pow(2,10*(a/f-1))+b},easeOut:function(a,b,c,f){return a==f?b+c:c*(-Math.pow(2,-10*a/f)+1)+b},easeInOut:function(a,b,c,f){if(a==0)return b;if(a==f)return b+c;if((a/=f/2)<1)return c/2*Math.pow(2,10*(a-1))+b;return c/2*(-Math.pow(2,-10*--a)+2)+b},CLASS_NAME:"OpenLayers.Easing.Expo"};
OpenLayers.Easing.Quad={easeIn:function(a,b,c,f){return c*(a/=f)*a+b},easeOut:function(a,b,c,f){return-c*(a/=f)*(a-2)+b},easeInOut:function(a,b,c,f){if((a/=f/2)<1)return c/2*a*a+b;return-c/2*(--a*(a-2)-1)+b},CLASS_NAME:"OpenLayers.Easing.Quad"};
OpenLayers.String={startsWith:function(a,b){return a.indexOf(b)==0},contains:function(a,b){return a.indexOf(b)!=-1},trim:function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},camelize:function(a){a=a.split("-");for(var b=a[0],c=1,f=a.length;c<f;c++){var d=a[c];b+=d.charAt(0).toUpperCase()+d.substring(1)}return b},format:function(a,b,c){b||(b=window);return a.replace(OpenLayers.String.tokenRegEx,function(f,d){var e;f=d.split(/\.+/);for(d=0;d<f.length;d++){if(d==0)e=b;e=e[f[d]]}if(typeof e==
"function")e=c?e.apply(null,c):e();return typeof e=="undefined"?"undefined":e})},tokenRegEx:/\$\{([\w.]+?)\}/g,numberRegEx:/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,isNumeric:function(a){return OpenLayers.String.numberRegEx.test(a)},numericIf:function(a){return OpenLayers.String.isNumeric(a)?parseFloat(a):a}};
OpenLayers.Number={decimalSeparator:".",thousandsSeparator:",",limitSigDigs:function(a,b){var c=0;if(b>0)c=parseFloat(a.toPrecision(b));return c},format:function(a,b,c,f){b=typeof b!="undefined"?b:0;c=typeof c!="undefined"?c:OpenLayers.Number.thousandsSeparator;f=typeof f!="undefined"?f:OpenLayers.Number.decimalSeparator;if(b!=null)a=parseFloat(a.toFixed(b));var d=a.toString().split(".");if(d.length==1&&b==null)b=0;a=d[0];if(c)for(var e=/(-?[0-9]+)([0-9]{3})/;e.test(a);)a=a.replace(e,"$1"+c+"$2");
if(b==0)b=a;else{c=d.length>1?d[1]:"0";if(b!=null)c+=(new Array(b-c.length+1)).join("0");b=a+f+c}return b}};OpenLayers.Function={bind:function(a,b){var c=Array.prototype.slice.apply(arguments,[2]);return function(){var f=c.concat(Array.prototype.slice.apply(arguments,[0]));return a.apply(b,f)}},bindAsEventListener:function(a,b){return function(c){return a.call(b,c||window.event)}},False:function(){return false},True:function(){return true},Void:function(){}};
OpenLayers.Array={filter:function(a,b,c){var f=[];if(Array.prototype.filter)f=a.filter(b,c);else{var d=a.length;if(typeof b!="function")throw new TypeError;for(var e=0;e<d;e++)if(e in a){var g=a[e];b.call(c,g,e,a)&&f.push(g)}}return f}};
OpenLayers.Bounds=OpenLayers.Class({left:null,bottom:null,right:null,top:null,centerLonLat:null,initialize:function(a,b,c,f){if(OpenLayers.Util.isArray(a)){f=a[3];c=a[2];b=a[1];a=a[0]}if(a!=null)this.left=OpenLayers.Util.toFloat(a);if(b!=null)this.bottom=OpenLayers.Util.toFloat(b);if(c!=null)this.right=OpenLayers.Util.toFloat(c);if(f!=null)this.top=OpenLayers.Util.toFloat(f)},clone:function(){return new OpenLayers.Bounds(this.left,this.bottom,this.right,this.top)},equals:function(a){var b=false;if(a!=
null)b=this.left==a.left&&this.right==a.right&&this.top==a.top&&this.bottom==a.bottom;return b},toString:function(){return[this.left,this.bottom,this.right,this.top].join(",")},toArray:function(a){return a===true?[this.bottom,this.left,this.top,this.right]:[this.left,this.bottom,this.right,this.top]},toBBOX:function(a,b){if(a==null)a=6;var c=Math.pow(10,a);a=Math.round(this.left*c)/c;var f=Math.round(this.bottom*c)/c,d=Math.round(this.right*c)/c;c=Math.round(this.top*c)/c;return b===true?f+","+a+
","+c+","+d:a+","+f+","+d+","+c},toGeometry:function(){return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(this.left,this.bottom),new OpenLayers.Geometry.Point(this.right,this.bottom),new OpenLayers.Geometry.Point(this.right,this.top),new OpenLayers.Geometry.Point(this.left,this.top)])])},getWidth:function(){return this.right-this.left},getHeight:function(){return this.top-this.bottom},getSize:function(){return new OpenLayers.Size(this.getWidth(),
this.getHeight())},getCenterPixel:function(){return new OpenLayers.Pixel((this.left+this.right)/2,(this.bottom+this.top)/2)},getCenterLonLat:function(){if(!this.centerLonLat)this.centerLonLat=new OpenLayers.LonLat((this.left+this.right)/2,(this.bottom+this.top)/2);return this.centerLonLat},scale:function(a,b){if(b==null)b=this.getCenterLonLat();var c;if(b.CLASS_NAME=="OpenLayers.LonLat"){c=b.lon;b=b.lat}else{c=b.x;b=b.y}return new OpenLayers.Bounds((this.left-c)*a+c,(this.bottom-b)*a+b,(this.right-
c)*a+c,(this.top-b)*a+b)},add:function(a,b){if(a==null||b==null)throw new TypeError("Bounds.add cannot receive null values");return new OpenLayers.Bounds(this.left+a,this.bottom+b,this.right+a,this.top+b)},extend:function(a){var b=null;if(a){switch(a.CLASS_NAME){case "OpenLayers.LonLat":b=new OpenLayers.Bounds(a.lon,a.lat,a.lon,a.lat);break;case "OpenLayers.Geometry.Point":b=new OpenLayers.Bounds(a.x,a.y,a.x,a.y);break;case "OpenLayers.Bounds":b=a;break}if(b){this.centerLonLat=null;if(this.left==
null||b.left<this.left)this.left=b.left;if(this.bottom==null||b.bottom<this.bottom)this.bottom=b.bottom;if(this.right==null||b.right>this.right)this.right=b.right;if(this.top==null||b.top>this.top)this.top=b.top}}},containsLonLat:function(a,b){if(typeof b==="boolean")b={inclusive:b};b=b||{};var c=this.contains(a.lon,a.lat,b.inclusive),f=b.worldBounds;if(f&&!c){c=f.getWidth();f=Math.round((a.lon-(f.left+f.right)/2)/c);c=this.containsLonLat({lon:a.lon-f*c,lat:a.lat},{inclusive:b.inclusive})}return c},
containsPixel:function(a,b){return this.contains(a.x,a.y,b)},contains:function(a,b,c){if(c==null)c=true;if(a==null||b==null)return false;a=OpenLayers.Util.toFloat(a);b=OpenLayers.Util.toFloat(b);var f=false;return f=c?a>=this.left&&a<=this.right&&b>=this.bottom&&b<=this.top:a>this.left&&a<this.right&&b>this.bottom&&b<this.top},intersectsBounds:function(a,b){if(typeof b==="boolean")b={inclusive:b};b=b||{};if(b.worldBounds){var c=this.wrapDateLine(b.worldBounds);a=a.wrapDateLine(b.worldBounds)}else c=
this;if(b.inclusive==null)b.inclusive=true;var f=false,d=c.left==a.right||c.right==a.left||c.top==a.bottom||c.bottom==a.top;if(b.inclusive||!d){f=a.top>=c.bottom&&a.top<=c.top||c.top>a.bottom&&c.top<a.top;d=a.left>=c.left&&a.left<=c.right||c.left>=a.left&&c.left<=a.right;var e=a.right>=c.left&&a.right<=c.right||c.right>=a.left&&c.right<=a.right;f=(a.bottom>=c.bottom&&a.bottom<=c.top||c.bottom>=a.bottom&&c.bottom<=a.top||f)&&(d||e)}if(b.worldBounds&&!f){var g=b.worldBounds;d=g.getWidth();e=!g.containsBounds(c);
g=!g.containsBounds(a);if(e&&!g){a=a.add(-d,0);f=c.intersectsBounds(a,{inclusive:b.inclusive})}else if(g&&!e){c=c.add(-d,0);f=a.intersectsBounds(c,{inclusive:b.inclusive})}}return f},containsBounds:function(a,b,c){if(b==null)b=false;if(c==null)c=true;var f=this.contains(a.left,a.bottom,c),d=this.contains(a.right,a.bottom,c),e=this.contains(a.left,a.top,c);a=this.contains(a.right,a.top,c);return b?f||d||e||a:f&&d&&e&&a},determineQuadrant:function(a){var b="",c=this.getCenterLonLat();b+=a.lat<c.lat?
"b":"t";b+=a.lon<c.lon?"l":"r";return b},transform:function(a,b){this.centerLonLat=null;var c=OpenLayers.Projection.transform({x:this.left,y:this.bottom},a,b),f=OpenLayers.Projection.transform({x:this.right,y:this.bottom},a,b),d=OpenLayers.Projection.transform({x:this.left,y:this.top},a,b);a=OpenLayers.Projection.transform({x:this.right,y:this.top},a,b);this.left=Math.min(c.x,d.x);this.bottom=Math.min(c.y,f.y);this.right=Math.max(f.x,a.x);this.top=Math.max(d.y,a.y);return this},wrapDateLine:function(a,
b){b=b||{};var c=b.leftTolerance||0;b=b.rightTolerance||0;var f=this.clone();if(a){for(var d=a.getWidth();f.left<a.left&&f.right-b<=a.left;)f=f.add(d,0);for(;f.left+c>=a.right&&f.right>a.right;)f=f.add(-d,0);c=f.left+c;if(c<a.right&&c>a.left&&f.right-b>a.right)f=f.add(-d,0)}return f},CLASS_NAME:"OpenLayers.Bounds"});OpenLayers.Bounds.fromString=function(a,b){a=a.split(",");return OpenLayers.Bounds.fromArray(a,b)};
OpenLayers.Bounds.fromArray=function(a,b){return b===true?new OpenLayers.Bounds(a[1],a[0],a[3],a[2]):new OpenLayers.Bounds(a[0],a[1],a[2],a[3])};OpenLayers.Bounds.fromSize=function(a){return new OpenLayers.Bounds(0,a.h,a.w,0)};OpenLayers.Bounds.oppositeQuadrant=function(a){var b="";b+=a.charAt(0)=="t"?"b":"t";b+=a.charAt(1)=="l"?"r":"l";return b};
OpenLayers.Element={visible:function(a){return OpenLayers.Util.getElement(a).style.display!="none"},toggle:function(){for(var a=0,b=arguments.length;a<b;a++){var c=OpenLayers.Util.getElement(arguments[a]),f=OpenLayers.Element.visible(c)?"none":"";c.style.display=f}},remove:function(a){a=OpenLayers.Util.getElement(a);a.parentNode.removeChild(a)},getHeight:function(a){a=OpenLayers.Util.getElement(a);return a.offsetHeight},hasClass:function(a,b){a=a.className;return!!a&&(new RegExp("(^|\\s)"+b+"(\\s|$)")).test(a)},
addClass:function(a,b){OpenLayers.Element.hasClass(a,b)||(a.className+=(a.className?" ":"")+b);return a},removeClass:function(a,b){var c=a.className;if(c)a.className=OpenLayers.String.trim(c.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)")," "));return a},toggleClass:function(a,b){OpenLayers.Element.hasClass(a,b)?OpenLayers.Element.removeClass(a,b):OpenLayers.Element.addClass(a,b);return a},getStyle:function(a,b){a=OpenLayers.Util.getElement(a);var c=null;if(a&&a.style){c=a.style[OpenLayers.String.camelize(b)];
if(!c)if(document.defaultView&&document.defaultView.getComputedStyle)c=(c=document.defaultView.getComputedStyle(a,null))?c.getPropertyValue(b):null;else if(a.currentStyle)c=a.currentStyle[OpenLayers.String.camelize(b)];var f=["left","top","right","bottom"];if(window.opera&&OpenLayers.Util.indexOf(f,b)!=-1&&OpenLayers.Element.getStyle(a,"position")=="static")c="auto"}return c=="auto"?null:c}};
OpenLayers.LonLat=OpenLayers.Class({lon:0,lat:0,initialize:function(a,b){if(OpenLayers.Util.isArray(a)){b=a[1];a=a[0]}this.lon=OpenLayers.Util.toFloat(a);this.lat=OpenLayers.Util.toFloat(b)},toString:function(){return"lon="+this.lon+",lat="+this.lat},toShortString:function(){return this.lon+", "+this.lat},clone:function(){return new OpenLayers.LonLat(this.lon,this.lat)},add:function(a,b){if(a==null||b==null)throw new TypeError("LonLat.add cannot receive null values");return new OpenLayers.LonLat(this.lon+
OpenLayers.Util.toFloat(a),this.lat+OpenLayers.Util.toFloat(b))},equals:function(a){var b=false;if(a!=null)b=this.lon==a.lon&&this.lat==a.lat||isNaN(this.lon)&&isNaN(this.lat)&&isNaN(a.lon)&&isNaN(a.lat);return b},transform:function(a,b){a=OpenLayers.Projection.transform({x:this.lon,y:this.lat},a,b);this.lon=a.x;this.lat=a.y;return this},wrapDateLine:function(a){var b=this.clone();if(a){for(;b.lon<a.left;)b.lon+=a.getWidth();for(;b.lon>a.right;)b.lon-=a.getWidth()}return b},CLASS_NAME:"OpenLayers.LonLat"});
OpenLayers.LonLat.fromString=function(a){a=a.split(",");return new OpenLayers.LonLat(a[0],a[1])};OpenLayers.LonLat.fromArray=function(a){var b=OpenLayers.Util.isArray(a);return new OpenLayers.LonLat(b&&a[0],b&&a[1])};
OpenLayers.Pixel=OpenLayers.Class({x:0,y:0,initialize:function(a,b){this.x=parseFloat(a);this.y=parseFloat(b)},toString:function(){return"x="+this.x+",y="+this.y},clone:function(){return new OpenLayers.Pixel(this.x,this.y)},equals:function(a){var b=false;if(a!=null)b=this.x==a.x&&this.y==a.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(a.x)&&isNaN(a.y);return b},distanceTo:function(a){return Math.sqrt(Math.pow(this.x-a.x,2)+Math.pow(this.y-a.y,2))},add:function(a,b){if(a==null||b==null)throw new TypeError("Pixel.add cannot receive null values");
return new OpenLayers.Pixel(this.x+a,this.y+b)},offset:function(a){var b=this.clone();if(a)b=this.add(a.x,a.y);return b},CLASS_NAME:"OpenLayers.Pixel"});
OpenLayers.Size=OpenLayers.Class({w:0,h:0,initialize:function(a,b){this.w=parseFloat(a);this.h=parseFloat(b)},toString:function(){return"w="+this.w+",h="+this.h},clone:function(){return new OpenLayers.Size(this.w,this.h)},equals:function(a){var b=false;if(a!=null)b=this.w==a.w&&this.h==a.h||isNaN(this.w)&&isNaN(this.h)&&isNaN(a.w)&&isNaN(a.h);return b},CLASS_NAME:"OpenLayers.Size"});
OpenLayers.Console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){},userError:function(a){alert(a)},assert:function(){},dir:function(){},dirxml:function(){},trace:function(){},group:function(){},groupEnd:function(){},time:function(){},timeEnd:function(){},profile:function(){},profileEnd:function(){},count:function(){},CLASS_NAME:"OpenLayers.Console"};
(function(){for(var a=document.getElementsByTagName("script"),b=0,c=a.length;b<c;++b)if(a[b].src.indexOf("firebug.js")!=-1)if(console){OpenLayers.Util.extend(OpenLayers.Console,console);break}})();
OpenLayers.Lang={code:null,defaultCode:"en",getCode:function(){OpenLayers.Lang.code||OpenLayers.Lang.setCode();return OpenLayers.Lang.code},setCode:function(a){var b;a||(a=OpenLayers.BROWSER_NAME=="msie"?navigator.userLanguage:navigator.language);a=a.split("-");a[0]=a[0].toLowerCase();if(typeof OpenLayers.Lang[a[0]]=="object")b=a[0];if(a[1]){var c=a[0]+"-"+a[1].toUpperCase();if(typeof OpenLayers.Lang[c]=="object")b=c}if(!b){OpenLayers.Console.warn("Failed to find OpenLayers.Lang."+a.join("-")+" dictionary, falling back to default language");
b=OpenLayers.Lang.defaultCode}OpenLayers.Lang.code=b},translate:function(a,b){var c=OpenLayers.Lang[OpenLayers.Lang.getCode()];(c=c&&c[a])||(c=a);if(b)c=OpenLayers.String.format(c,b);return c}};OpenLayers.i18n=OpenLayers.Lang.translate;OpenLayers.Util=OpenLayers.Util||{};OpenLayers.Util.getElement=function(){for(var a=[],b=0,c=arguments.length;b<c;b++){var f=arguments[b];if(typeof f=="string")f=document.getElementById(f);if(arguments.length==1)return f;a.push(f)}return a};
OpenLayers.Util.isElement=function(a){return!!(a&&a.nodeType===1)};OpenLayers.Util.isArray=function(a){return Object.prototype.toString.call(a)==="[object Array]"};if(typeof window.$==="undefined")window.$=OpenLayers.Util.getElement;OpenLayers.Util.removeItem=function(a,b){for(var c=a.length-1;c>=0;c--)a[c]==b&&a.splice(c,1);return a};OpenLayers.Util.indexOf=function(a,b){if(typeof a.indexOf=="function")return a.indexOf(b);else{for(var c=0,f=a.length;c<f;c++)if(a[c]==b)return c;return-1}};
OpenLayers.Util.modifyDOMElement=function(a,b,c,f,d,e,g,h){if(b)a.id=b;if(c){a.style.left=c.x+"px";a.style.top=c.y+"px"}if(f){a.style.width=f.w+"px";a.style.height=f.h+"px"}if(d)a.style.position=d;if(e)a.style.border=e;if(g)a.style.overflow=g;if(parseFloat(h)>=0&&parseFloat(h)<1){a.style.filter="alpha(opacity="+h*100+")";a.style.opacity=h}else if(parseFloat(h)==1){a.style.filter="";a.style.opacity=""}};
OpenLayers.Util.createDiv=function(a,b,c,f,d,e,g,h){var i=document.createElement("div");if(f)i.style.backgroundImage="url("+f+")";a||(a=OpenLayers.Util.createUniqueID("OpenLayersDiv"));d||(d="absolute");OpenLayers.Util.modifyDOMElement(i,a,b,c,d,e,g,h);return i};
OpenLayers.Util.createImage=function(a,b,c,f,d,e,g,h){var i=document.createElement("img");a||(a=OpenLayers.Util.createUniqueID("OpenLayersDiv"));d||(d="relative");OpenLayers.Util.modifyDOMElement(i,a,b,c,d,e,null,g);if(h){i.style.display="none";function j(){i.style.display="";OpenLayers.Event.stopObservingElement(i)}OpenLayers.Event.observe(i,"load",j);OpenLayers.Event.observe(i,"error",j)}i.style.alt=a;i.galleryImg="no";if(f)i.src=f;return i};OpenLayers.IMAGE_RELOAD_ATTEMPTS=0;
OpenLayers.Util.alphaHackNeeded=null;OpenLayers.Util.alphaHack=function(){if(OpenLayers.Util.alphaHackNeeded==null){var a=navigator.appVersion.split("MSIE");a=parseFloat(a[1]);var b=false;try{b=!!document.body.filters}catch(c){}OpenLayers.Util.alphaHackNeeded=b&&a>=5.5&&a<7}return OpenLayers.Util.alphaHackNeeded};
OpenLayers.Util.modifyAlphaImageDiv=function(a,b,c,f,d,e,g,h,i){OpenLayers.Util.modifyDOMElement(a,b,c,f,e,null,null,i);b=a.childNodes[0];if(d)b.src=d;OpenLayers.Util.modifyDOMElement(b,a.id+"_innerImage",null,f,"relative",g);if(OpenLayers.Util.alphaHack()){if(a.style.display!="none")a.style.display="inline-block";if(h==null)h="scale";a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+b.src+"', sizingMethod='"+h+"')";if(parseFloat(a.style.opacity)>=0&&parseFloat(a.style.opacity)<
1)a.style.filter+=" alpha(opacity="+a.style.opacity*100+")";b.style.filter="alpha(opacity=0)"}};OpenLayers.Util.createAlphaImageDiv=function(a,b,c,f,d,e,g,h,i){var j=OpenLayers.Util.createDiv();i=OpenLayers.Util.createImage(null,null,null,null,null,null,null,i);i.className="olAlphaImg";j.appendChild(i);OpenLayers.Util.modifyAlphaImageDiv(j,a,b,c,f,d,e,g,h);return j};OpenLayers.Util.upperCaseObject=function(a){var b={};for(var c in a)b[c.toUpperCase()]=a[c];return b};
OpenLayers.Util.applyDefaults=function(a,b){a=a||{};var c=typeof window.Event=="function"&&b instanceof window.Event;for(var f in b)if(a[f]===undefined||!c&&b.hasOwnProperty&&b.hasOwnProperty(f)&&!a.hasOwnProperty(f))a[f]=b[f];if(!c&&b&&b.hasOwnProperty&&b.hasOwnProperty("toString")&&!a.hasOwnProperty("toString"))a.toString=b.toString;return a};
OpenLayers.Util.getParameterString=function(a){var b=[];for(var c in a){var f=a[c];if(f!=null&&typeof f!="function"){if(typeof f=="object"&&f.constructor==Array){for(var d=[],e,g=0,h=f.length;g<h;g++){e=f[g];d.push(encodeURIComponent(e===null||e===undefined?"":e))}f=d.join(",")}else f=encodeURIComponent(f);b.push(encodeURIComponent(c)+"="+f)}}return b.join("&")};OpenLayers.Util.urlAppend=function(a,b){var c=a;if(b){a=(a+" ").split(/[?&]/);c+=a.pop()===" "?b:a.length?"&"+b:"?"+b}return c};
OpenLayers.Util.getImagesLocation=function(){return OpenLayers.ImgPath||OpenLayers._getScriptLocation()+"img/"};OpenLayers.Util.getImageLocation=function(a){return OpenLayers.Util.getImagesLocation()+a};OpenLayers.Util.Try=function(){for(var a=null,b=0,c=arguments.length;b<c;b++){var f=arguments[b];try{a=f();break}catch(d){}}return a};
OpenLayers.Util.getXmlNodeValue=function(a){var b=null;OpenLayers.Util.Try(function(){b=a.text;if(!b)b=a.textContent;if(!b)b=a.firstChild.nodeValue},function(){b=a.textContent});return b};OpenLayers.Util.mouseLeft=function(a,b){for(a=a.relatedTarget?a.relatedTarget:a.toElement;a!=b&&a!=null;)a=a.parentNode;return a!=b};OpenLayers.Util.DEFAULT_PRECISION=14;OpenLayers.Util.toFloat=function(a,b){if(b==null)b=OpenLayers.Util.DEFAULT_PRECISION;if(typeof a!=="number")a=parseFloat(a);return b===0?a:parseFloat(a.toPrecision(b))};
OpenLayers.Util.rad=function(a){return a*Math.PI/180};OpenLayers.Util.deg=function(a){return a*180/Math.PI};OpenLayers.Util.VincentyConstants={a:6378137,b:6356752.3142,f:1/298.257223563};
OpenLayers.Util.distVincenty=function(a,b){var c=OpenLayers.Util.VincentyConstants,f=c.a,d=c.b;c=c.f;var e=OpenLayers.Util.rad(b.lon-a.lon);a=Math.atan((1-c)*Math.tan(OpenLayers.Util.rad(a.lat)));var g=Math.atan((1-c)*Math.tan(OpenLayers.Util.rad(b.lat)));b=Math.sin(a);a=Math.cos(a);var h=Math.sin(g);g=Math.cos(g);for(var i=e,j=2*Math.PI,l=20;Math.abs(i-j)>1.0E-12&&--l>0;){var k=Math.sin(i),m=Math.cos(i),n=Math.sqrt(g*k*g*k+(a*h-b*g*m)*(a*h-b*g*m));if(n==0)return 0;m=b*h+a*g*m;var q=Math.atan2(n,
m),p=Math.asin(a*g*k/n),o=Math.cos(p)*Math.cos(p);k=m-2*b*h/o;var t=c/16*o*(4+c*(4-3*o));j=i;i=e+(1-t)*c*Math.sin(p)*(q+t*n*(k+t*m*(-1+2*k*k)))}if(l==0)return NaN;f=o*(f*f-d*d)/(d*d);c=f/1024*(256+f*(-128+f*(74-47*f)));return(d*(1+f/16384*(4096+f*(-768+f*(320-175*f))))*(q-c*n*(k+c/4*(m*(-1+2*k*k)-c/6*k*(-3+4*n*n)*(-3+4*k*k))))).toFixed(3)/1E3};
OpenLayers.Util.destinationVincenty=function(a,b,c){var f=OpenLayers.Util,d=f.VincentyConstants,e=d.a,g=d.b,h=d.f;d=a.lon;a=a.lat;var i=f.rad(b);b=Math.sin(i);i=Math.cos(i);a=(1-h)*Math.tan(f.rad(a));var j=1/Math.sqrt(1+a*a),l=a*j,k=Math.atan2(a,i);a=j*b;var m=1-a*a;e=m*(e*e-g*g)/(g*g);var n=1+e/16384*(4096+e*(-768+e*(320-175*e))),q=e/1024*(256+e*(-128+e*(74-47*e)));e=c/(g*n);for(var p=2*Math.PI;Math.abs(e-p)>1.0E-12;){var o=Math.cos(2*k+e),t=Math.sin(e),u=Math.cos(e),s=q*t*(o+q/4*(u*(-1+2*o*o)-q/
6*o*(-3+4*t*t)*(-3+4*o*o)));p=e;e=c/(g*n)+s}c=l*t-j*u*i;g=Math.atan2(l*u+j*t*i,(1-h)*Math.sqrt(a*a+c*c));b=Math.atan2(t*b,j*u-l*t*i);i=h/16*m*(4+h*(4-3*m));o=b-(1-i)*h*a*(e+i*t*(o+i*u*(-1+2*o*o)));Math.atan2(a,-c);return new OpenLayers.LonLat(d+f.deg(o),f.deg(g))};
OpenLayers.Util.getParameters=function(a){a=a===null||a===undefined?window.location.href:a;var b="";if(OpenLayers.String.contains(a,"?")){b=a.indexOf("?")+1;var c=OpenLayers.String.contains(a,"#")?a.indexOf("#"):a.length;b=a.substring(b,c)}a={};b=b.split(/[&;]/);c=0;for(var f=b.length;c<f;++c){var d=b[c].split("=");if(d[0]){var e=d[0];try{e=decodeURIComponent(e)}catch(g){e=unescape(e)}d=(d[1]||"").replace(/\+/g," ");try{d=decodeURIComponent(d)}catch(h){d=unescape(d)}d=d.split(",");if(d.length==1)d=
d[0];a[e]=d}}return a};OpenLayers.Util.lastSeqID=0;OpenLayers.Util.createUniqueID=function(a){if(a==null)a="id_";OpenLayers.Util.lastSeqID+=1;return a+OpenLayers.Util.lastSeqID};OpenLayers.INCHES_PER_UNIT={inches:1,ft:12,mi:63360,m:39.3701,km:39370.1,dd:4374754,yd:36};OpenLayers.INCHES_PER_UNIT["in"]=OpenLayers.INCHES_PER_UNIT.inches;OpenLayers.INCHES_PER_UNIT.degrees=OpenLayers.INCHES_PER_UNIT.dd;OpenLayers.INCHES_PER_UNIT.nmi=1852*OpenLayers.INCHES_PER_UNIT.m;OpenLayers.METERS_PER_INCH=0.0254000508001016;
OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{Inch:OpenLayers.INCHES_PER_UNIT.inches,Meter:1/OpenLayers.METERS_PER_INCH,Foot:0.3048006096012192/OpenLayers.METERS_PER_INCH,IFoot:0.3048/OpenLayers.METERS_PER_INCH,ClarkeFoot:0.3047972651151/OpenLayers.METERS_PER_INCH,SearsFoot:0.30479947153867626/OpenLayers.METERS_PER_INCH,GoldCoastFoot:0.3047997101815088/OpenLayers.METERS_PER_INCH,IInch:0.0254/OpenLayers.METERS_PER_INCH,MicroInch:2.54E-5/OpenLayers.METERS_PER_INCH,Mil:2.54E-8/OpenLayers.METERS_PER_INCH,
Centimeter:0.01/OpenLayers.METERS_PER_INCH,Kilometer:1E3/OpenLayers.METERS_PER_INCH,Yard:0.9144018288036576/OpenLayers.METERS_PER_INCH,SearsYard:0.914398414616029/OpenLayers.METERS_PER_INCH,IndianYard:0.9143985307444408/OpenLayers.METERS_PER_INCH,IndianYd37:0.91439523/OpenLayers.METERS_PER_INCH,IndianYd62:0.9143988/OpenLayers.METERS_PER_INCH,IndianYd75:0.9143985/OpenLayers.METERS_PER_INCH,IndianFoot:0.30479951/OpenLayers.METERS_PER_INCH,IndianFt37:0.30479841/OpenLayers.METERS_PER_INCH,IndianFt62:0.3047996/
OpenLayers.METERS_PER_INCH,IndianFt75:0.3047995/OpenLayers.METERS_PER_INCH,Mile:1609.3472186944373/OpenLayers.METERS_PER_INCH,IYard:0.9144/OpenLayers.METERS_PER_INCH,IMile:1609.344/OpenLayers.METERS_PER_INCH,NautM:1852/OpenLayers.METERS_PER_INCH,"Lat-66":110943.31648893273/OpenLayers.METERS_PER_INCH,"Lat-83":110946.25736872235/OpenLayers.METERS_PER_INCH,Decimeter:0.1/OpenLayers.METERS_PER_INCH,Millimeter:0.001/OpenLayers.METERS_PER_INCH,Dekameter:10/OpenLayers.METERS_PER_INCH,Decameter:10/OpenLayers.METERS_PER_INCH,
Hectometer:100/OpenLayers.METERS_PER_INCH,GermanMeter:1.0000135965/OpenLayers.METERS_PER_INCH,CaGrid:0.999738/OpenLayers.METERS_PER_INCH,ClarkeChain:20.1166194976/OpenLayers.METERS_PER_INCH,GunterChain:20.11684023368047/OpenLayers.METERS_PER_INCH,BenoitChain:20.116782494375872/OpenLayers.METERS_PER_INCH,SearsChain:20.11676512155/OpenLayers.METERS_PER_INCH,ClarkeLink:0.201166194976/OpenLayers.METERS_PER_INCH,GunterLink:0.2011684023368047/OpenLayers.METERS_PER_INCH,BenoitLink:0.20116782494375873/OpenLayers.METERS_PER_INCH,
SearsLink:0.2011676512155/OpenLayers.METERS_PER_INCH,Rod:5.02921005842012/OpenLayers.METERS_PER_INCH,IntnlChain:20.1168/OpenLayers.METERS_PER_INCH,IntnlLink:0.201168/OpenLayers.METERS_PER_INCH,Perch:5.02921005842012/OpenLayers.METERS_PER_INCH,Pole:5.02921005842012/OpenLayers.METERS_PER_INCH,Furlong:201.1684023368046/OpenLayers.METERS_PER_INCH,Rood:3.778266898/OpenLayers.METERS_PER_INCH,CapeFoot:0.3047972615/OpenLayers.METERS_PER_INCH,Brealey:375/OpenLayers.METERS_PER_INCH,ModAmFt:0.304812252984506/
OpenLayers.METERS_PER_INCH,Fathom:1.8288/OpenLayers.METERS_PER_INCH,"NautM-UK":1853.184/OpenLayers.METERS_PER_INCH,"50kilometers":5E4/OpenLayers.METERS_PER_INCH,"150kilometers":15E4/OpenLayers.METERS_PER_INCH});
OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{mm:OpenLayers.INCHES_PER_UNIT.Meter/1E3,cm:OpenLayers.INCHES_PER_UNIT.Meter/100,dm:OpenLayers.INCHES_PER_UNIT.Meter*100,km:OpenLayers.INCHES_PER_UNIT.Meter*1E3,kmi:OpenLayers.INCHES_PER_UNIT.nmi,fath:OpenLayers.INCHES_PER_UNIT.Fathom,ch:OpenLayers.INCHES_PER_UNIT.IntnlChain,link:OpenLayers.INCHES_PER_UNIT.IntnlLink,"us-in":OpenLayers.INCHES_PER_UNIT.inches,"us-ft":OpenLayers.INCHES_PER_UNIT.Foot,"us-yd":OpenLayers.INCHES_PER_UNIT.Yard,"us-ch":OpenLayers.INCHES_PER_UNIT.GunterChain,
"us-mi":OpenLayers.INCHES_PER_UNIT.Mile,"ind-yd":OpenLayers.INCHES_PER_UNIT.IndianYd37,"ind-ft":OpenLayers.INCHES_PER_UNIT.IndianFt37,"ind-ch":20.11669506/OpenLayers.METERS_PER_INCH});OpenLayers.DOTS_PER_INCH=72;OpenLayers.Util.normalizeScale=function(a){return a>1?1/a:a};OpenLayers.Util.getResolutionFromScale=function(a,b){var c;if(a){if(b==null)b="degrees";c=1/(OpenLayers.Util.normalizeScale(a)*OpenLayers.INCHES_PER_UNIT[b]*OpenLayers.DOTS_PER_INCH)}return c};
OpenLayers.Util.getScaleFromResolution=function(a,b){if(b==null)b="degrees";return a*OpenLayers.INCHES_PER_UNIT[b]*OpenLayers.DOTS_PER_INCH};
OpenLayers.Util.pagePosition=function(a){var b=[0,0],c=OpenLayers.Util.getViewportElement();if(!a||a==window||a==c)return b;var f=OpenLayers.IS_GECKO&&document.getBoxObjectFor&&OpenLayers.Element.getStyle(a,"position")=="absolute"&&(a.style.top==""||a.style.left==""),d=null;if(a.getBoundingClientRect){a=a.getBoundingClientRect();d=c.scrollTop;b[0]=a.left+c.scrollLeft;b[1]=a.top+d}else if(document.getBoxObjectFor&&!f){a=document.getBoxObjectFor(a);c=document.getBoxObjectFor(c);b[0]=a.screenX-c.screenX;
b[1]=a.screenY-c.screenY}else{b[0]=a.offsetLeft;b[1]=a.offsetTop;d=a.offsetParent;if(d!=a)for(;d;){b[0]+=d.offsetLeft;b[1]+=d.offsetTop;d=d.offsetParent}c=OpenLayers.BROWSER_NAME;if(c=="opera"||c=="safari"&&OpenLayers.Element.getStyle(a,"position")=="absolute")b[1]-=document.body.offsetTop;for(d=a.offsetParent;d&&d!=document.body;){b[0]-=d.scrollLeft;if(c!="opera"||d.tagName!="TR")b[1]-=d.scrollTop;d=d.offsetParent}}return b};
OpenLayers.Util.getViewportElement=function(){var a=arguments.callee.viewportElement;if(a==undefined){a=OpenLayers.BROWSER_NAME=="msie"&&document.compatMode!="CSS1Compat"?document.body:document.documentElement;arguments.callee.viewportElement=a}return a};
OpenLayers.Util.isEquivalentUrl=function(a,b,c){c=c||{};OpenLayers.Util.applyDefaults(c,{ignoreCase:true,ignorePort80:true,ignoreHash:true});a=OpenLayers.Util.createUrlObject(a,c);b=OpenLayers.Util.createUrlObject(b,c);for(var f in a)if(f!=="args")if(a[f]!=b[f])return false;for(f in a.args){if(a.args[f]!=b.args[f])return false;delete b.args[f]}for(f in b.args)return false;return true};
OpenLayers.Util.createUrlObject=function(a,b){b=b||{};if(!/^\w+:\/\//.test(a)){var c=window.location,f=c.port?":"+c.port:"";f=c.protocol+"//"+c.host.split(":").shift()+f;if(a.indexOf("/")===0)a=f+a;else{c=c.pathname.split("/");c.pop();a=f+c.join("/")+"/"+a}}if(b.ignoreCase)a=a.toLowerCase();c=document.createElement("a");c.href=a;f={};f.host=c.host.split(":").shift();f.protocol=c.protocol;f.port=b.ignorePort80?c.port=="80"||c.port=="0"?"":c.port:c.port==""||c.port=="0"?"80":c.port;f.hash=b.ignoreHash||
c.hash==="#"?"":c.hash;b=c.search;if(!b){b=a.indexOf("?");b=b!=-1?a.substr(b):""}f.args=OpenLayers.Util.getParameters(b);f.pathname=c.pathname.charAt(0)=="/"?c.pathname:"/"+c.pathname;return f};OpenLayers.Util.removeTail=function(a){var b=null;b=a.indexOf("?");var c=a.indexOf("#");return b=b==-1?c!=-1?a.substr(0,c):a:c!=-1?a.substr(0,Math.min(b,c)):a.substr(0,b)};OpenLayers.IS_GECKO=function(){var a=navigator.userAgent.toLowerCase();return a.indexOf("webkit")==-1&&a.indexOf("gecko")!=-1}();
OpenLayers.CANVAS_SUPPORTED=function(){var a=document.createElement("canvas");return!!(a.getContext&&a.getContext("2d"))}();OpenLayers.BROWSER_NAME=function(){var a="",b=navigator.userAgent.toLowerCase();if(b.indexOf("opera")!=-1)a="opera";else if(b.indexOf("msie")!=-1)a="msie";else if(b.indexOf("safari")!=-1)a="safari";else if(b.indexOf("mozilla")!=-1)a=b.indexOf("firefox")!=-1?"firefox":"mozilla";return a}();OpenLayers.Util.getBrowserName=function(){return OpenLayers.BROWSER_NAME};
OpenLayers.Util.getRenderedDimensions=function(a,b,c){var f,d,e=document.createElement("div");e.style.visibility="hidden";for(var g=c&&c.containerElement?c.containerElement:document.body,h=false,i=null,j=g;j&&j.tagName.toLowerCase()!="body";){var l=OpenLayers.Element.getStyle(j,"position");if(l=="absolute"){h=true;break}else if(l&&l!="static")break;j=j.parentNode}if(h&&(g.clientHeight===0||g.clientWidth===0)){i=document.createElement("div");i.style.visibility="hidden";i.style.position="absolute";
i.style.overflow="visible";i.style.width=document.body.clientWidth+"px";i.style.height=document.body.clientHeight+"px";i.appendChild(e)}e.style.position="absolute";if(b)if(b.w){f=b.w;e.style.width=f+"px"}else if(b.h){d=b.h;e.style.height=d+"px"}if(c&&c.displayClass)e.className=c.displayClass;b=document.createElement("div");b.innerHTML=a;b.style.overflow="visible";if(b.childNodes){a=0;for(c=b.childNodes.length;a<c;a++)if(b.childNodes[a].style)b.childNodes[a].style.overflow="visible"}e.appendChild(b);
i?g.appendChild(i):g.appendChild(e);if(!f){f=parseInt(b.scrollWidth);e.style.width=f+"px"}d||(d=parseInt(b.scrollHeight));e.removeChild(b);if(i){i.removeChild(e);g.removeChild(i)}else g.removeChild(e);return new OpenLayers.Size(f,d)};
OpenLayers.Util.getScrollbarWidth=function(){var a=OpenLayers.Util._scrollbarWidth;if(a==null){var b=null,c=null;b=a=0;b=document.createElement("div");b.style.position="absolute";b.style.top="-1000px";b.style.left="-1000px";b.style.width="100px";b.style.height="50px";b.style.overflow="hidden";c=document.createElement("div");c.style.width="100%";c.style.height="200px";b.appendChild(c);document.body.appendChild(b);a=c.offsetWidth;b.style.overflow="scroll";b=c.offsetWidth;document.body.removeChild(document.body.lastChild);
OpenLayers.Util._scrollbarWidth=a-b;a=OpenLayers.Util._scrollbarWidth}return a};
OpenLayers.Util.getFormattedLonLat=function(a,b,c){c||(c="dms");a=(a+540)%360-180;var f=Math.abs(a),d=Math.floor(f),e=f=(f-d)/(1/60);f=Math.floor(f);e=(e-f)/(1/60);e=Math.round(e*10);e/=10;if(e>=60){e-=60;f+=1;if(f>=60){f-=60;d+=1}}if(d<10)d="0"+d;d=d+"\u00b0";if(c.indexOf("dm")>=0){if(f<10)f="0"+f;d+=f+"'";if(c.indexOf("dms")>=0){if(e<10)e="0"+e;d+=e+'"'}}d+=b=="lon"?a<0?OpenLayers.i18n("W"):OpenLayers.i18n("E"):a<0?OpenLayers.i18n("S"):OpenLayers.i18n("N");return d};
OpenLayers.Event={observers:false,KEY_SPACE:32,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,element:function(a){return a.target||a.srcElement},isSingleTouch:function(a){return a.touches&&a.touches.length==1},isMultiTouch:function(a){return a.touches&&a.touches.length>1},isLeftClick:function(a){return a.which&&a.which==1||a.button&&a.button==1},isRightClick:function(a){return a.which&&a.which==3||a.button&&a.button==2},stop:function(a,
b){if(!b)if(a.preventDefault)a.preventDefault();else a.returnValue=false;if(a.stopPropagation)a.stopPropagation();else a.cancelBubble=true},findElement:function(a,b){for(a=OpenLayers.Event.element(a);a.parentNode&&(!a.tagName||a.tagName.toUpperCase()!=b.toUpperCase());)a=a.parentNode;return a},observe:function(a,b,c,f){a=OpenLayers.Util.getElement(a);f=f||false;if(b=="keypress"&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||a.attachEvent))b="keydown";if(!this.observers)this.observers={};
if(!a._eventCacheID){var d="eventCacheID_";if(a.id)d=a.id+"_"+d;a._eventCacheID=OpenLayers.Util.createUniqueID(d)}d=a._eventCacheID;this.observers[d]||(this.observers[d]=[]);this.observers[d].push({element:a,name:b,observer:c,useCapture:f});if(a.addEventListener)a.addEventListener(b,c,f);else a.attachEvent&&a.attachEvent("on"+b,c)},stopObservingElement:function(a){a=OpenLayers.Util.getElement(a)._eventCacheID;this._removeElementObservers(OpenLayers.Event.observers[a])},_removeElementObservers:function(a){if(a)for(var b=
a.length-1;b>=0;b--){var c=a[b];OpenLayers.Event.stopObserving.apply(this,new Array(c.element,c.name,c.observer,c.useCapture))}},stopObserving:function(a,b,c,f){f=f||false;a=OpenLayers.Util.getElement(a);var d=a._eventCacheID;if(b=="keypress")if(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||a.detachEvent)b="keydown";var e=false,g=OpenLayers.Event.observers[d];if(g)for(var h=0;!e&&h<g.length;){var i=g[h];if(i.name==b&&i.observer==c&&i.useCapture==f){g.splice(h,1);g.length==0&&delete OpenLayers.Event.observers[d];
e=true;break}h++}if(e)if(a.removeEventListener)a.removeEventListener(b,c,f);else a&&a.detachEvent&&a.detachEvent("on"+b,c);return e},unloadCache:function(){if(OpenLayers.Event&&OpenLayers.Event.observers){for(var a in OpenLayers.Event.observers)OpenLayers.Event._removeElementObservers.apply(this,[OpenLayers.Event.observers[a]]);OpenLayers.Event.observers=false}},CLASS_NAME:"OpenLayers.Event"};OpenLayers.Event.observe(window,"unload",OpenLayers.Event.unloadCache,false);
OpenLayers.Events=OpenLayers.Class({BROWSER_EVENTS:["mouseover","mouseout","mousedown","mouseup","mousemove","click","dblclick","rightclick","dblrightclick","resize","focus","blur","touchstart","touchmove","touchend","keydown"],listeners:null,object:null,element:null,eventHandler:null,fallThrough:null,includeXY:false,extensions:null,extensionCount:null,clearMouseListener:null,initialize:function(a,b,c,f,d){OpenLayers.Util.extend(this,d);this.object=a;this.fallThrough=f;this.listeners={};this.extensions=
{};this.extensionCount={};b!=null&&this.attachToElement(b)},destroy:function(){for(var a in this.extensions)typeof this.extensions[a]!=="boolean"&&this.extensions[a].destroy();this.extensions=null;if(this.element){OpenLayers.Event.stopObservingElement(this.element);this.element.hasScrollEvent&&OpenLayers.Event.stopObserving(window,"scroll",this.clearMouseListener)}this.eventHandler=this.fallThrough=this.object=this.listeners=this.element=null},addEventType:function(){},attachToElement:function(a){if(this.element)OpenLayers.Event.stopObservingElement(this.element);
else{this.eventHandler=OpenLayers.Function.bindAsEventListener(this.handleBrowserEvent,this);this.clearMouseListener=OpenLayers.Function.bind(this.clearMouseCache,this)}this.element=a;for(var b=0,c=this.BROWSER_EVENTS.length;b<c;b++)OpenLayers.Event.observe(a,this.BROWSER_EVENTS[b],this.eventHandler);OpenLayers.Event.observe(a,"dragstart",OpenLayers.Event.stop)},on:function(a){for(var b in a)b!="scope"&&a.hasOwnProperty(b)&&this.register(b,a.scope,a[b])},register:function(a,b,c,f){if(a in OpenLayers.Events&&
!this.extensions[a])this.extensions[a]=new OpenLayers.Events[a](this);if(c!=null){if(b==null)b=this.object;var d=this.listeners[a];if(!d){d=[];this.listeners[a]=d;this.extensionCount[a]=0}b={obj:b,func:c};if(f){d.splice(this.extensionCount[a],0,b);typeof f==="object"&&f.extension&&this.extensionCount[a]++}else d.push(b)}},registerPriority:function(a,b,c){this.register(a,b,c,true)},un:function(a){for(var b in a)b!="scope"&&a.hasOwnProperty(b)&&this.unregister(b,a.scope,a[b])},unregister:function(a,
b,c){if(b==null)b=this.object;a=this.listeners[a];if(a!=null)for(var f=0,d=a.length;f<d;f++)if(a[f].obj==b&&a[f].func==c){a.splice(f,1);break}},remove:function(a){if(this.listeners[a]!=null)this.listeners[a]=[]},triggerEvent:function(a,b){var c=this.listeners[a];if(!(!c||c.length==0)){if(b==null)b={};b.object=this.object;b.element=this.element;if(!b.type)b.type=a;c=c.slice();var f;a=0;for(var d=c.length;a<d;a++){f=c[a];f=f.func.apply(f.obj,[b]);if(f!=undefined&&f==false)break}this.fallThrough||OpenLayers.Event.stop(b,
true);return f}},handleBrowserEvent:function(a){var b=a.type,c=this.listeners[b];if(!(!c||c.length==0)){if((c=a.touches)&&c[0]){for(var f=0,d=0,e=c.length,g,h=0;h<e;++h){g=c[h];f+=g.clientX;d+=g.clientY}a.clientX=f/e;a.clientY=d/e}if(this.includeXY)a.xy=this.getMousePosition(a);this.triggerEvent(b,a)}},clearMouseCache:function(){this.element.scrolls=null;this.element.lefttop=null;var a=document.body;if(a&&!((a.scrollTop!=0||a.scrollLeft!=0)&&navigator.userAgent.match(/iPhone/i)))this.element.offsets=
null},getMousePosition:function(a){if(this.includeXY){if(!this.element.hasScrollEvent){OpenLayers.Event.observe(window,"scroll",this.clearMouseListener);this.element.hasScrollEvent=true}}else this.clearMouseCache();if(!this.element.scrolls){var b=OpenLayers.Util.getViewportElement();this.element.scrolls=[b.scrollLeft,b.scrollTop]}if(!this.element.lefttop)this.element.lefttop=[document.documentElement.clientLeft||0,document.documentElement.clientTop||0];if(!this.element.offsets)this.element.offsets=
OpenLayers.Util.pagePosition(this.element);return new OpenLayers.Pixel(a.clientX+this.element.scrolls[0]-this.element.offsets[0]-this.element.lefttop[0],a.clientY+this.element.scrolls[1]-this.element.offsets[1]-this.element.lefttop[1])},CLASS_NAME:"OpenLayers.Events"});
OpenLayers.Projection=OpenLayers.Class({proj:null,projCode:null,titleRegEx:/\+title=[^\+]*/,initialize:function(a,b){OpenLayers.Util.extend(this,b);this.projCode=a;if(window.Proj4js)this.proj=new Proj4js.Proj(a)},getCode:function(){return this.proj?this.proj.srsCode:this.projCode},getUnits:function(){return this.proj?this.proj.units:null},toString:function(){return this.getCode()},equals:function(a){a=a;var b=false;if(a){a instanceof OpenLayers.Projection||(a=new OpenLayers.Projection(a));if(window.Proj4js&&
this.proj.defData&&a.proj.defData)b=this.proj.defData.replace(this.titleRegEx,"")==a.proj.defData.replace(this.titleRegEx,"");else if(a.getCode){b=this.getCode();a=a.getCode();b=b==a||!!OpenLayers.Projection.transforms[b]&&OpenLayers.Projection.transforms[b][a]===OpenLayers.Projection.nullTransform}}return b},destroy:function(){delete this.proj;delete this.projCode},CLASS_NAME:"OpenLayers.Projection"});OpenLayers.Projection.transforms={};
OpenLayers.Projection.defaults={"EPSG:4326":{units:"degrees",maxExtent:[-180,-90,180,90],yx:true},"CRS:84":{units:"degrees",maxExtent:[-180,-90,180,90]},"EPSG:900913":{units:"m",maxExtent:[-2.003750834E7,-2.003750834E7,2.003750834E7,2.003750834E7]}};
OpenLayers.Projection.addTransform=function(a,b,c){if(c===OpenLayers.Projection.nullTransform){var f=OpenLayers.Projection.defaults[a];if(f&&!OpenLayers.Projection.defaults[b])OpenLayers.Projection.defaults[b]=f}OpenLayers.Projection.transforms[a]||(OpenLayers.Projection.transforms[a]={});OpenLayers.Projection.transforms[a][b]=c};
OpenLayers.Projection.transform=function(a,b,c){if(b&&c){b instanceof OpenLayers.Projection||(b=new OpenLayers.Projection(b));c instanceof OpenLayers.Projection||(c=new OpenLayers.Projection(c));if(b.proj&&c.proj)a=Proj4js.transform(b.proj,c.proj,a);else{b=b.getCode();c=c.getCode();var f=OpenLayers.Projection.transforms;f[b]&&f[b][c]&&f[b][c](a)}}return a};OpenLayers.Projection.nullTransform=function(a){return a};
(function(){function a(h){h.x=180*h.x/f;h.y=180/Math.PI*(2*Math.atan(Math.exp(h.y/f*Math.PI))-Math.PI/2);return h}function b(h){h.x=h.x*f/180;h.y=Math.log(Math.tan((90+h.y)*Math.PI/360))/Math.PI*f;return h}function c(h,i){var j=OpenLayers.Projection.addTransform,l=OpenLayers.Projection.nullTransform,k,m,n,q,p;k=0;for(m=i.length;k<m;++k){n=i[k];j(h,n,b);j(n,h,a);for(p=k+1;p<m;++p){q=i[p];j(n,q,l);j(q,n,l)}}}var f=2.003750834E7,d=["EPSG:900913","EPSG:3857","EPSG:102113","EPSG:102100"],e=["CRS:84","urn:ogc:def:crs:EPSG:6.6:4326",
"EPSG:4326"],g;for(g=d.length-1;g>=0;--g)c(d[g],e);for(g=e.length-1;g>=0;--g)c(e[g],d)})();
OpenLayers.Map=OpenLayers.Class({Z_INDEX_BASE:{BaseLayer:100,Overlay:325,Feature:725,Popup:750,Control:1E3},id:null,fractionalZoom:false,events:null,allOverlays:false,div:null,dragging:false,size:null,viewPortDiv:null,layerContainerOrigin:null,layerContainerDiv:null,layers:null,controls:null,popups:null,baseLayer:null,center:null,resolution:null,zoom:0,panRatio:1.5,options:null,tileSize:null,projection:"EPSG:4326",units:null,resolutions:null,maxResolution:null,minResolution:null,maxScale:null,minScale:null,
maxExtent:null,minExtent:null,restrictedExtent:null,numZoomLevels:16,theme:null,displayProjection:null,fallThrough:true,panTween:null,eventListeners:null,panMethod:OpenLayers.Easing.Expo.easeOut,panDuration:50,paddingForPopups:null,minPx:null,maxPx:null,initialize:function(a,b){if(arguments.length===1&&typeof a==="object")a=(b=a)&&b.div;this.tileSize=new OpenLayers.Size(OpenLayers.Map.TILE_WIDTH,OpenLayers.Map.TILE_HEIGHT);this.paddingForPopups=new OpenLayers.Bounds(15,15,15,15);this.theme=OpenLayers._getScriptLocation()+
"theme/default/style.css";this.options=OpenLayers.Util.extend({},b);OpenLayers.Util.extend(this,b);OpenLayers.Util.applyDefaults(this,OpenLayers.Projection.defaults[this.projection instanceof OpenLayers.Projection?this.projection.projCode:this.projection]);if(this.maxExtent&&!(this.maxExtent instanceof OpenLayers.Bounds))this.maxExtent=new OpenLayers.Bounds(this.maxExtent);if(this.minExtent&&!(this.minExtent instanceof OpenLayers.Bounds))this.minExtent=new OpenLayers.Bounds(this.minExtent);if(this.restrictedExtent&&
!(this.restrictedExtent instanceof OpenLayers.Bounds))this.restrictedExtent=new OpenLayers.Bounds(this.restrictedExtent);if(this.center&&!(this.center instanceof OpenLayers.LonLat))this.center=new OpenLayers.LonLat(this.center);this.layers=[];this.id=OpenLayers.Util.createUniqueID("OpenLayers.Map_");this.div=OpenLayers.Util.getElement(a);if(!this.div){this.div=document.createElement("div");this.div.style.height="1px";this.div.style.width="1px"}OpenLayers.Element.addClass(this.div,"olMap");var c=this.id+
"_OpenLayers_ViewPort";this.viewPortDiv=OpenLayers.Util.createDiv(c,null,null,null,"relative",null,"hidden");this.viewPortDiv.style.width="100%";this.viewPortDiv.style.height="100%";this.viewPortDiv.className="olMapViewport";this.div.appendChild(this.viewPortDiv);this.events=new OpenLayers.Events(this,this.viewPortDiv,null,this.fallThrough,{includeXY:true});c=this.id+"_OpenLayers_Container";this.layerContainerDiv=OpenLayers.Util.createDiv(c);this.layerContainerDiv.style.width="100px";this.layerContainerDiv.style.height=
"100px";this.layerContainerDiv.style.zIndex=this.Z_INDEX_BASE.Popup-1;this.viewPortDiv.appendChild(this.layerContainerDiv);this.updateSize();this.eventListeners instanceof Object&&this.events.on(this.eventListeners);if(parseFloat(navigator.appVersion.split("MSIE")[1])<9)this.events.register("resize",this,this.updateSize);else{this.updateSizeDestroy=OpenLayers.Function.bind(this.updateSize,this);OpenLayers.Event.observe(window,"resize",this.updateSizeDestroy)}if(this.theme){c=true;for(var f=document.getElementsByTagName("link"),
d=0,e=f.length;d<e;++d)if(OpenLayers.Util.isEquivalentUrl(f.item(d).href,this.theme)){c=false;break}if(c){c=document.createElement("link");c.setAttribute("rel","stylesheet");c.setAttribute("type","text/css");c.setAttribute("href",this.theme);document.getElementsByTagName("head")[0].appendChild(c)}}if(this.controls==null){this.controls=[];if(OpenLayers.Control!=null){if(OpenLayers.Control.Navigation)this.controls.push(new OpenLayers.Control.Navigation);else OpenLayers.Control.TouchNavigation&&this.controls.push(new OpenLayers.Control.TouchNavigation);
if(OpenLayers.Control.Zoom)this.controls.push(new OpenLayers.Control.Zoom);else OpenLayers.Control.PanZoom&&this.controls.push(new OpenLayers.Control.PanZoom);OpenLayers.Control.ArgParser&&this.controls.push(new OpenLayers.Control.ArgParser);OpenLayers.Control.Attribution&&this.controls.push(new OpenLayers.Control.Attribution)}}d=0;for(e=this.controls.length;d<e;d++)this.addControlToMap(this.controls[d]);this.popups=[];this.unloadDestroy=OpenLayers.Function.bind(this.destroy,this);OpenLayers.Event.observe(window,
"unload",this.unloadDestroy);if(b&&b.layers){delete this.center;this.addLayers(b.layers);b.center&&!this.getCenter()&&this.setCenter(b.center,b.zoom)}},getViewport:function(){return this.viewPortDiv},render:function(a){this.div=OpenLayers.Util.getElement(a);OpenLayers.Element.addClass(this.div,"olMap");this.viewPortDiv.parentNode.removeChild(this.viewPortDiv);this.div.appendChild(this.viewPortDiv);this.updateSize()},unloadDestroy:null,updateSizeDestroy:null,destroy:function(){if(!this.unloadDestroy)return false;
if(this.panTween){this.panTween.stop();this.panTween=null}OpenLayers.Event.stopObserving(window,"unload",this.unloadDestroy);this.unloadDestroy=null;this.updateSizeDestroy?OpenLayers.Event.stopObserving(window,"resize",this.updateSizeDestroy):this.events.unregister("resize",this,this.updateSize);this.paddingForPopups=null;if(this.controls!=null){for(var a=this.controls.length-1;a>=0;--a)this.controls[a].destroy();this.controls=null}if(this.layers!=null){for(a=this.layers.length-1;a>=0;--a)this.layers[a].destroy(false);
this.layers=null}this.viewPortDiv&&this.div.removeChild(this.viewPortDiv);this.viewPortDiv=null;if(this.eventListeners){this.events.un(this.eventListeners);this.eventListeners=null}this.events.destroy();this.options=this.events=null},setOptions:function(a){var b=this.minPx&&a.restrictedExtent!=this.restrictedExtent;OpenLayers.Util.extend(this,a);b&&this.moveTo(this.getCachedCenter(),this.zoom,{forceZoomChange:true})},getTileSize:function(){return this.tileSize},getBy:function(a,b,c){var f=typeof c.test==
"function";return OpenLayers.Array.filter(this[a],function(d){return d[b]==c||f&&c.test(d[b])})},getLayersBy:function(a,b){return this.getBy("layers",a,b)},getLayersByName:function(a){return this.getLayersBy("name",a)},getLayersByClass:function(a){return this.getLayersBy("CLASS_NAME",a)},getControlsBy:function(a,b){return this.getBy("controls",a,b)},getControlsByClass:function(a){return this.getControlsBy("CLASS_NAME",a)},getLayer:function(a){for(var b=null,c=0,f=this.layers.length;c<f;c++){var d=
this.layers[c];if(d.id==a){b=d;break}}return b},setLayerZIndex:function(a,b){a.setZIndex(this.Z_INDEX_BASE[a.isBaseLayer?"BaseLayer":"Overlay"]+b*5)},resetLayersZIndex:function(){for(var a=0,b=this.layers.length;a<b;a++)this.setLayerZIndex(this.layers[a],a)},addLayer:function(a){for(var b=0,c=this.layers.length;b<c;b++)if(this.layers[b]==a)return false;if(this.events.triggerEvent("preaddlayer",{layer:a})===false)return false;if(this.allOverlays)a.isBaseLayer=false;a.div.className="olLayerDiv";a.div.style.overflow=
"";this.setLayerZIndex(a,this.layers.length);a.isFixed?this.viewPortDiv.appendChild(a.div):this.layerContainerDiv.appendChild(a.div);this.layers.push(a);a.setMap(this);if(a.isBaseLayer||this.allOverlays&&!this.baseLayer)this.baseLayer==null?this.setBaseLayer(a):a.setVisibility(false);else a.redraw();this.events.triggerEvent("addlayer",{layer:a});a.events.triggerEvent("added",{map:this,layer:a});a.afterAdd();return true},addLayers:function(a){for(var b=0,c=a.length;b<c;b++)this.addLayer(a[b])},removeLayer:function(a,
b){if(this.events.triggerEvent("preremovelayer",{layer:a})!==false){if(b==null)b=true;a.isFixed?this.viewPortDiv.removeChild(a.div):this.layerContainerDiv.removeChild(a.div);OpenLayers.Util.removeItem(this.layers,a);a.removeMap(this);a.map=null;if(this.baseLayer==a){this.baseLayer=null;if(b){b=0;for(var c=this.layers.length;b<c;b++){var f=this.layers[b];if(f.isBaseLayer||this.allOverlays){this.setBaseLayer(f);break}}}}this.resetLayersZIndex();this.events.triggerEvent("removelayer",{layer:a});a.events.triggerEvent("removed",
{map:this,layer:a})}},getNumLayers:function(){return this.layers.length},getLayerIndex:function(a){return OpenLayers.Util.indexOf(this.layers,a)},setLayerIndex:function(a,b){var c=this.getLayerIndex(a);if(b<0)b=0;else if(b>this.layers.length)b=this.layers.length;if(c!=b){this.layers.splice(c,1);this.layers.splice(b,0,a);c=0;for(var f=this.layers.length;c<f;c++)this.setLayerZIndex(this.layers[c],c);this.events.triggerEvent("changelayer",{layer:a,property:"order"});if(this.allOverlays)if(b===0)this.setBaseLayer(a);
else this.baseLayer!==this.layers[0]&&this.setBaseLayer(this.layers[0])}},raiseLayer:function(a,b){b=this.getLayerIndex(a)+b;this.setLayerIndex(a,b)},setBaseLayer:function(a){if(a!=this.baseLayer)if(OpenLayers.Util.indexOf(this.layers,a)!=-1){var b=this.getCachedCenter(),c=OpenLayers.Util.getResolutionFromScale(this.getScale(),a.units);this.baseLayer!=null&&!this.allOverlays&&this.baseLayer.setVisibility(false);this.baseLayer=a;if(!this.allOverlays||this.baseLayer.visibility){this.baseLayer.setVisibility(true);
this.baseLayer.inRange===false&&this.baseLayer.redraw()}if(b!=null){a=this.getZoomForResolution(c||this.resolution,true);this.setCenter(b,a,false,true)}this.events.triggerEvent("changebaselayer",{layer:this.baseLayer})}},addControl:function(a,b){this.controls.push(a);this.addControlToMap(a,b)},addControls:function(a,b){for(var c=arguments.length===1?[]:b,f=0,d=a.length;f<d;f++)this.addControl(a[f],c[f]?c[f]:null)},addControlToMap:function(a,b){a.outsideViewport=a.div!=null;if(this.displayProjection&&
!a.displayProjection)a.displayProjection=this.displayProjection;a.setMap(this);if(b=a.draw(b))if(!a.outsideViewport){b.style.zIndex=this.Z_INDEX_BASE.Control+this.controls.length;this.viewPortDiv.appendChild(b)}a.autoActivate&&a.activate()},getControl:function(a){for(var b=null,c=0,f=this.controls.length;c<f;c++){var d=this.controls[c];if(d.id==a){b=d;break}}return b},removeControl:function(a){if(a&&a==this.getControl(a.id)){a.div&&a.div.parentNode==this.viewPortDiv&&this.viewPortDiv.removeChild(a.div);
OpenLayers.Util.removeItem(this.controls,a)}},addPopup:function(a,b){if(b)for(b=this.popups.length-1;b>=0;--b)this.removePopup(this.popups[b]);a.map=this;this.popups.push(a);if(a=a.draw()){a.style.zIndex=this.Z_INDEX_BASE.Popup+this.popups.length;this.layerContainerDiv.appendChild(a)}},removePopup:function(a){OpenLayers.Util.removeItem(this.popups,a);if(a.div)try{this.layerContainerDiv.removeChild(a.div)}catch(b){}a.map=null},getSize:function(){var a=null;if(this.size!=null)a=this.size.clone();return a},
updateSize:function(){var a=this.getCurrentSize();if(a&&!isNaN(a.h)&&!isNaN(a.w)){this.events.clearMouseCache();var b=this.getSize();if(b==null)this.size=b=a;if(!a.equals(b)){this.size=a;a=0;for(b=this.layers.length;a<b;a++)this.layers[a].onMapResize();a=this.getCachedCenter();if(this.baseLayer!=null&&a!=null){b=this.getZoom();this.zoom=null;this.setCenter(a,b)}}}},getCurrentSize:function(){var a=new OpenLayers.Size(this.div.clientWidth,this.div.clientHeight);if(a.w==0&&a.h==0||isNaN(a.w)&&isNaN(a.h)){a.w=
this.div.offsetWidth;a.h=this.div.offsetHeight}if(a.w==0&&a.h==0||isNaN(a.w)&&isNaN(a.h)){a.w=parseInt(this.div.style.width);a.h=parseInt(this.div.style.height)}return a},calculateBounds:function(a,b){var c=null;if(a==null)a=this.getCachedCenter();if(b==null)b=this.getResolution();if(a!=null&&b!=null){c=this.size.w*b/2;b=this.size.h*b/2;c=new OpenLayers.Bounds(a.lon-c,a.lat-b,a.lon+c,a.lat+b)}return c},getCenter:function(){var a=null,b=this.getCachedCenter();if(b)a=b.clone();return a},getCachedCenter:function(){if(!this.center&&
this.size)this.center=this.getLonLatFromViewPortPx({x:this.size.w/2,y:this.size.h/2});return this.center},getZoom:function(){return this.zoom},pan:function(a,b,c){c=OpenLayers.Util.applyDefaults(c,{animate:true,dragging:false});if(c.dragging){if(a!=0||b!=0)this.moveByPx(a,b)}else{var f=this.getViewPortPxFromLonLat(this.getCachedCenter());a=f.add(a,b);if(this.dragging||!a.equals(f)){f=this.getLonLatFromViewPortPx(a);if(c.animate)this.panTo(f);else{this.moveTo(f);if(this.dragging){this.dragging=false;
this.events.triggerEvent("moveend")}}}}},panTo:function(a){if(this.panMethod&&this.getExtent().scale(this.panRatio).containsLonLat(a)){if(!this.panTween)this.panTween=new OpenLayers.Tween(this.panMethod);var b=this.getCachedCenter();if(!a.equals(b)){b=this.getPixelFromLonLat(b);var c=this.getPixelFromLonLat(a),f={x:0,y:0};this.panTween.start({x:0,y:0},{x:c.x-b.x,y:c.y-b.y},this.panDuration,{callbacks:{eachStep:OpenLayers.Function.bind(function(d){this.moveByPx(d.x-f.x,d.y-f.y);f.x=Math.round(d.x);
f.y=Math.round(d.y)},this),done:OpenLayers.Function.bind(function(){this.moveTo(a);this.dragging=false;this.events.triggerEvent("moveend")},this)}})}}else this.setCenter(a)},setCenter:function(a,b,c,f){this.panTween&&this.panTween.stop();this.moveTo(a,b,{dragging:c,forceZoomChange:f})},moveByPx:function(a,b){var c=this.size.w/2,f=this.size.h/2,d=c+a,e=f+b,g=this.baseLayer.wrapDateLine,h=0,i=0;if(this.restrictedExtent){h=c;i=f;g=false}a=g||d<=this.maxPx.x-h&&d>=this.minPx.x+h?Math.round(a):0;b=e<=
this.maxPx.y-i&&e>=this.minPx.y+i?Math.round(b):0;if(a||b){if(!this.dragging){this.dragging=true;this.events.triggerEvent("movestart")}this.center=null;if(a){this.layerContainerDiv.style.left=parseInt(this.layerContainerDiv.style.left)-a+"px";this.minPx.x-=a;this.maxPx.x-=a}if(b){this.layerContainerDiv.style.top=parseInt(this.layerContainerDiv.style.top)-b+"px";this.minPx.y-=b;this.maxPx.y-=b}f=0;for(d=this.layers.length;f<d;++f){c=this.layers[f];if(c.visibility&&(c===this.baseLayer||c.inRange)){c.moveByPx(a,
b);c.events.triggerEvent("move")}}this.events.triggerEvent("move")}},adjustZoom:function(a){var b=this.baseLayer.resolutions,c=this.getMaxExtent().getWidth()/this.size.w;if(this.getResolutionForZoom(a)>c)for(var f=a|0,d=b.length;f<d;++f)if(b[f]<=c){a=f;break}return a},moveTo:function(a,b,c){if(a!=null&&!(a instanceof OpenLayers.LonLat))a=new OpenLayers.LonLat(a);c||(c={});if(b!=null){b=parseFloat(b);this.fractionalZoom||(b=Math.round(b))}if(this.baseLayer.wrapDateLine){var f=b;b=this.adjustZoom(b);
if(b!==f)a=this.getCenter()}f=c.dragging||this.dragging;var d=c.forceZoomChange;if(!this.getCachedCenter()&&!this.isValidLonLat(a)){a=this.maxExtent.getCenterLonLat();this.center=a.clone()}if(this.restrictedExtent!=null){if(a==null)a=this.center;if(b==null)b=this.getZoom();var e=this.getResolutionForZoom(b);e=this.calculateBounds(a,e);if(!this.restrictedExtent.containsBounds(e)){var g=this.restrictedExtent.getCenterLonLat();if(e.getWidth()>this.restrictedExtent.getWidth())a=new OpenLayers.LonLat(g.lon,
a.lat);else if(e.left<this.restrictedExtent.left)a=a.add(this.restrictedExtent.left-e.left,0);else if(e.right>this.restrictedExtent.right)a=a.add(this.restrictedExtent.right-e.right,0);if(e.getHeight()>this.restrictedExtent.getHeight())a=new OpenLayers.LonLat(a.lon,g.lat);else if(e.bottom<this.restrictedExtent.bottom)a=a.add(0,this.restrictedExtent.bottom-e.bottom);else if(e.top>this.restrictedExtent.top)a=a.add(0,this.restrictedExtent.top-e.top)}}d=d||this.isValidZoomLevel(b)&&b!=this.getZoom();
e=this.isValidLonLat(a)&&!a.equals(this.center);if(d||e||f){f||this.events.triggerEvent("movestart");if(e){!d&&this.center&&this.centerLayerContainer(a);this.center=a.clone()}a=d?this.getResolutionForZoom(b):this.getResolution();if(d||this.layerContainerOrigin==null){this.layerContainerOrigin=this.getCachedCenter();this.layerContainerDiv.style.left="0px";this.layerContainerDiv.style.top="0px";e=this.getMaxExtent({restricted:true});var h=e.getCenterLonLat();g=this.center.lon-h.lon;h=h.lat-this.center.lat;
var i=Math.round(e.getWidth()/a),j=Math.round(e.getHeight()/a);this.minPx={x:(this.size.w-i)/2-g/a,y:(this.size.h-j)/2-h/a};this.maxPx={x:this.minPx.x+Math.round(e.getWidth()/a),y:this.minPx.y+Math.round(e.getHeight()/a)}}if(d){this.zoom=b;this.resolution=a}a=this.getExtent();if(this.baseLayer.visibility){this.baseLayer.moveTo(a,d,c.dragging);c.dragging||this.baseLayer.events.triggerEvent("moveend",{zoomChanged:d})}a=this.baseLayer.getExtent();for(b=this.layers.length-1;b>=0;--b){e=this.layers[b];
if(e!==this.baseLayer&&!e.isBaseLayer){g=e.calculateInRange();if(e.inRange!=g){(e.inRange=g)||e.display(false);this.events.triggerEvent("changelayer",{layer:e,property:"visibility"})}if(g&&e.visibility){e.moveTo(a,d,c.dragging);c.dragging||e.events.triggerEvent("moveend",{zoomChanged:d})}}}this.events.triggerEvent("move");f||this.events.triggerEvent("moveend");if(d){b=0;for(c=this.popups.length;b<c;b++)this.popups[b].updatePosition();this.events.triggerEvent("zoomend")}}},centerLayerContainer:function(a){var b=
this.getViewPortPxFromLonLat(this.layerContainerOrigin),c=this.getViewPortPxFromLonLat(a);if(b!=null&&c!=null){var f=parseInt(this.layerContainerDiv.style.left);a=parseInt(this.layerContainerDiv.style.top);var d=Math.round(b.x-c.x);b=Math.round(b.y-c.y);this.layerContainerDiv.style.left=d+"px";this.layerContainerDiv.style.top=b+"px";f=f-d;a=a-b;this.minPx.x-=f;this.maxPx.x-=f;this.minPx.y-=a;this.maxPx.y-=a}},isValidZoomLevel:function(a){return a!=null&&a>=0&&a<this.getNumZoomLevels()},isValidLonLat:function(a){var b=
false;if(a!=null){b=this.getMaxExtent();b=b.containsLonLat(a,{worldBounds:this.baseLayer.wrapDateLine&&b})}return b},getProjection:function(){var a=this.getProjectionObject();return a?a.getCode():null},getProjectionObject:function(){var a=null;if(this.baseLayer!=null)a=this.baseLayer.projection;return a},getMaxResolution:function(){var a=null;if(this.baseLayer!=null)a=this.baseLayer.maxResolution;return a},getMaxExtent:function(a){var b=null;if(a&&a.restricted&&this.restrictedExtent)b=this.restrictedExtent;
else if(this.baseLayer!=null)b=this.baseLayer.maxExtent;return b},getNumZoomLevels:function(){var a=null;if(this.baseLayer!=null)a=this.baseLayer.numZoomLevels;return a},getExtent:function(){var a=null;if(this.baseLayer!=null)a=this.baseLayer.getExtent();return a},getResolution:function(){var a=null;if(this.baseLayer!=null)a=this.baseLayer.getResolution();else if(this.allOverlays===true&&this.layers.length>0)a=this.layers[0].getResolution();return a},getUnits:function(){var a=null;if(this.baseLayer!=
null)a=this.baseLayer.units;return a},getScale:function(){var a=null;if(this.baseLayer!=null){a=this.getResolution();a=OpenLayers.Util.getScaleFromResolution(a,this.baseLayer.units)}return a},getZoomForExtent:function(a,b){var c=null;if(this.baseLayer!=null)c=this.baseLayer.getZoomForExtent(a,b);return c},getResolutionForZoom:function(a){var b=null;if(this.baseLayer)b=this.baseLayer.getResolutionForZoom(a);return b},getZoomForResolution:function(a,b){var c=null;if(this.baseLayer!=null)c=this.baseLayer.getZoomForResolution(a,
b);return c},zoomTo:function(a){this.isValidZoomLevel(a)&&this.setCenter(null,a)},zoomIn:function(){this.zoomTo(this.getZoom()+1)},zoomOut:function(){this.zoomTo(this.getZoom()-1)},zoomToExtent:function(a,b){a instanceof OpenLayers.Bounds||(a=new OpenLayers.Bounds(a));var c=a.getCenterLonLat();if(this.baseLayer.wrapDateLine){c=this.getMaxExtent();for(a=a.clone();a.right<a.left;)a.right+=c.getWidth();c=a.getCenterLonLat().wrapDateLine(c)}this.setCenter(c,this.getZoomForExtent(a,b))},zoomToMaxExtent:function(a){this.zoomToExtent(this.getMaxExtent({restricted:a?
a.restricted:true}))},zoomToScale:function(a,b){var c=OpenLayers.Util.getResolutionFromScale(a,this.baseLayer.units);a=this.size.w*c/2;c=this.size.h*c/2;var f=this.getCachedCenter();this.zoomToExtent(new OpenLayers.Bounds(f.lon-a,f.lat-c,f.lon+a,f.lat+c),b)},getLonLatFromViewPortPx:function(a){var b=null;if(this.baseLayer!=null)b=this.baseLayer.getLonLatFromViewPortPx(a);return b},getViewPortPxFromLonLat:function(a){var b=null;if(this.baseLayer!=null)b=this.baseLayer.getViewPortPxFromLonLat(a);return b},
getLonLatFromPixel:function(a){return this.getLonLatFromViewPortPx(a)},getPixelFromLonLat:function(a){a=this.getViewPortPxFromLonLat(a);a.x=Math.round(a.x);a.y=Math.round(a.y);return a},getGeodesicPixelSize:function(a){var b=a?this.getLonLatFromPixel(a):this.getCachedCenter()||new OpenLayers.LonLat(0,0),c=this.getResolution();a=b.add(-c/2,0);var f=b.add(c/2,0),d=b.add(0,-c/2);b=b.add(0,c/2);c=new OpenLayers.Projection("EPSG:4326");var e=this.getProjectionObject()||c;if(!e.equals(c)){a.transform(e,
c);f.transform(e,c);d.transform(e,c);b.transform(e,c)}return new OpenLayers.Size(OpenLayers.Util.distVincenty(a,f),OpenLayers.Util.distVincenty(d,b))},getViewPortPxFromLayerPx:function(a){var b=null;if(a!=null){b=parseInt(this.layerContainerDiv.style.left);var c=parseInt(this.layerContainerDiv.style.top);b=a.add(b,c)}return b},getLayerPxFromViewPortPx:function(a){var b=null;if(a!=null){b=-parseInt(this.layerContainerDiv.style.left);var c=-parseInt(this.layerContainerDiv.style.top);b=a.add(b,c);if(isNaN(b.x)||
isNaN(b.y))b=null}return b},getLonLatFromLayerPx:function(a){a=this.getViewPortPxFromLayerPx(a);return this.getLonLatFromViewPortPx(a)},getLayerPxFromLonLat:function(a){return this.getLayerPxFromViewPortPx(this.getPixelFromLonLat(a))},CLASS_NAME:"OpenLayers.Map"});OpenLayers.Map.TILE_WIDTH=256;OpenLayers.Map.TILE_HEIGHT=256;
OpenLayers.Layer=OpenLayers.Class({id:null,name:null,div:null,opacity:1,alwaysInRange:null,RESOLUTION_PROPERTIES:["scales","resolutions","maxScale","minScale","maxResolution","minResolution","numZoomLevels","maxZoomLevel"],events:null,map:null,isBaseLayer:false,alpha:false,displayInLayerSwitcher:true,visibility:true,attribution:null,inRange:false,imageSize:null,options:null,eventListeners:null,gutter:0,projection:null,units:null,scales:null,resolutions:null,maxExtent:null,minExtent:null,maxResolution:null,
minResolution:null,numZoomLevels:null,minScale:null,maxScale:null,displayOutsideMaxExtent:false,wrapDateLine:false,metadata:null,initialize:function(a,b){this.metadata={};this.addOptions(b);this.name=a;if(this.id==null){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_");this.div=OpenLayers.Util.createDiv(this.id);this.div.style.width="100%";this.div.style.height="100%";this.div.dir="ltr";this.events=new OpenLayers.Events(this,this.div);this.eventListeners instanceof Object&&this.events.on(this.eventListeners)}},
destroy:function(a){if(a==null)a=true;this.map!=null&&this.map.removeLayer(this,a);this.options=this.div=this.name=this.map=this.projection=null;if(this.events){this.eventListeners&&this.events.un(this.eventListeners);this.events.destroy()}this.events=this.eventListeners=null},clone:function(a){if(a==null)a=new OpenLayers.Layer(this.name,this.getOptions());OpenLayers.Util.applyDefaults(a,this);a.map=null;return a},getOptions:function(){var a={};for(var b in this.options)a[b]=this[b];return a},setName:function(a){if(a!=
this.name){this.name=a;this.map!=null&&this.map.events.triggerEvent("changelayer",{layer:this,property:"name"})}},addOptions:function(a,b){if(this.options==null)this.options={};if(a){if(typeof a.projection=="string")a.projection=new OpenLayers.Projection(a.projection);a.projection&&OpenLayers.Util.applyDefaults(a,OpenLayers.Projection.defaults[a.projection.getCode()]);if(a.maxExtent&&!(a.maxExtent instanceof OpenLayers.Bounds))a.maxExtent=new OpenLayers.Bounds(a.maxExtent);if(a.minExtent&&!(a.minExtent instanceof
OpenLayers.Bounds))a.minExtent=new OpenLayers.Bounds(a.minExtent)}OpenLayers.Util.extend(this.options,a);OpenLayers.Util.extend(this,a);if(this.projection&&this.projection.getUnits())this.units=this.projection.getUnits();if(this.map){var c=this.map.getResolution(),f=this.RESOLUTION_PROPERTIES.concat(["projection","units","minExtent","maxExtent"]);for(var d in a)if(a.hasOwnProperty(d)&&OpenLayers.Util.indexOf(f,d)>=0){this.initResolutions();if(b&&this.map.baseLayer===this){this.map.setCenter(this.map.getCenter(),
this.map.getZoomForResolution(c),false,true);this.map.events.triggerEvent("changebaselayer",{layer:this})}break}}},onMapResize:function(){},redraw:function(){var a=false;if(this.map){this.inRange=this.calculateInRange();var b=this.getExtent();if(b&&this.inRange&&this.visibility){this.moveTo(b,true,false);this.events.triggerEvent("moveend",{zoomChanged:true});a=true}}return a},moveTo:function(){var a=this.visibility;this.isBaseLayer||(a=a&&this.inRange);this.display(a)},moveByPx:function(){},setMap:function(a){if(this.map==
null){this.map=a;this.maxExtent=this.maxExtent||this.map.maxExtent;this.minExtent=this.minExtent||this.map.minExtent;this.projection=this.projection||this.map.projection;if(typeof this.projection=="string")this.projection=new OpenLayers.Projection(this.projection);this.units=this.projection.getUnits()||this.units||this.map.units;this.initResolutions();if(!this.isBaseLayer){this.inRange=this.calculateInRange();this.div.style.display=this.visibility&&this.inRange?"":"none"}this.setTileSize()}},afterAdd:function(){},
removeMap:function(){},getImageSize:function(){return this.imageSize||this.tileSize},setTileSize:function(a){this.tileSize=a=a?a:this.tileSize?this.tileSize:this.map.getTileSize();if(this.gutter)this.imageSize=new OpenLayers.Size(a.w+2*this.gutter,a.h+2*this.gutter)},getVisibility:function(){return this.visibility},setVisibility:function(a){if(a!=this.visibility){this.visibility=a;this.display(a);this.redraw();this.map!=null&&this.map.events.triggerEvent("changelayer",{layer:this,property:"visibility"});
this.events.triggerEvent("visibilitychanged")}},display:function(a){if(a!=(this.div.style.display!="none"))this.div.style.display=a&&this.calculateInRange()?"block":"none"},calculateInRange:function(){var a=false;if(this.alwaysInRange)a=true;else if(this.map){a=this.map.getResolution();a=a>=this.minResolution&&a<=this.maxResolution}return a},setIsBaseLayer:function(a){if(a!=this.isBaseLayer){this.isBaseLayer=a;this.map!=null&&this.map.events.triggerEvent("changebaselayer",{layer:this})}},initResolutions:function(){var a,
b,c,f={},d=true;a=0;for(b=this.RESOLUTION_PROPERTIES.length;a<b;a++){c=this.RESOLUTION_PROPERTIES[a];f[c]=this.options[c];if(d&&this.options[c])d=false}if(this.alwaysInRange==null)this.alwaysInRange=d;if(f.resolutions==null)f.resolutions=this.resolutionsFromScales(f.scales);if(f.resolutions==null)f.resolutions=this.calculateResolutions(f);if(f.resolutions==null){a=0;for(b=this.RESOLUTION_PROPERTIES.length;a<b;a++){c=this.RESOLUTION_PROPERTIES[a];f[c]=this.options[c]!=null?this.options[c]:this.map[c]}if(f.resolutions==
null)f.resolutions=this.resolutionsFromScales(f.scales);if(f.resolutions==null)f.resolutions=this.calculateResolutions(f)}var e;if(this.options.maxResolution&&this.options.maxResolution!=="auto")e=this.options.maxResolution;if(this.options.minScale)e=OpenLayers.Util.getResolutionFromScale(this.options.minScale,this.units);var g;if(this.options.minResolution&&this.options.minResolution!=="auto")g=this.options.minResolution;if(this.options.maxScale)g=OpenLayers.Util.getResolutionFromScale(this.options.maxScale,
this.units);if(f.resolutions){f.resolutions.sort(function(h,i){return i-h});e||(e=f.resolutions[0]);g||(g=f.resolutions[f.resolutions.length-1])}if(this.resolutions=f.resolutions){b=this.resolutions.length;this.scales=new Array(b);for(a=0;a<b;a++)this.scales[a]=OpenLayers.Util.getScaleFromResolution(this.resolutions[a],this.units);this.numZoomLevels=b}if(this.minResolution=g)this.maxScale=OpenLayers.Util.getScaleFromResolution(g,this.units);if(this.maxResolution=e)this.minScale=OpenLayers.Util.getScaleFromResolution(e,
this.units)},resolutionsFromScales:function(a){if(a!=null){var b,c,f;f=a.length;b=new Array(f);for(c=0;c<f;c++)b[c]=OpenLayers.Util.getResolutionFromScale(a[c],this.units);return b}},calculateResolutions:function(a){var b,c,f=a.maxResolution;if(a.minScale!=null)f=OpenLayers.Util.getResolutionFromScale(a.minScale,this.units);else if(f=="auto"&&this.maxExtent!=null){b=this.map.getSize();c=this.maxExtent.getWidth()/b.w;b=this.maxExtent.getHeight()/b.h;f=Math.max(c,b)}c=a.minResolution;if(a.maxScale!=
null)c=OpenLayers.Util.getResolutionFromScale(a.maxScale,this.units);else if(a.minResolution=="auto"&&this.minExtent!=null){b=this.map.getSize();c=this.minExtent.getWidth()/b.w;b=this.minExtent.getHeight()/b.h;c=Math.max(c,b)}if(typeof f!=="number"&&typeof c!=="number"&&this.maxExtent!=null){f=this.map.getTileSize();f=Math.max(this.maxExtent.getWidth()/f.w,this.maxExtent.getHeight()/f.h)}b=a.maxZoomLevel;a=a.numZoomLevels;if(typeof c==="number"&&typeof f==="number"&&a===undefined)a=Math.floor(Math.log(f/
c)/Math.log(2))+1;else if(a===undefined&&b!=null)a=b+1;if(!(typeof a!=="number"||a<=0||typeof f!=="number"&&typeof c!=="number")){b=new Array(a);var d=2;if(typeof c=="number"&&typeof f=="number")d=Math.pow(f/c,1/(a-1));var e;if(typeof f==="number")for(e=0;e<a;e++)b[e]=f/Math.pow(d,e);else for(e=0;e<a;e++)b[a-1-e]=c*Math.pow(d,e);return b}},getResolution:function(){return this.getResolutionForZoom(this.map.getZoom())},getExtent:function(){return this.map.calculateBounds()},getZoomForExtent:function(a,
b){var c=this.map.getSize();return this.getZoomForResolution(Math.max(a.getWidth()/c.w,a.getHeight()/c.h),b)},getDataExtent:function(){},getResolutionForZoom:function(a){a=Math.max(0,Math.min(a,this.resolutions.length-1));if(this.map.fractionalZoom){var b=Math.floor(a),c=Math.ceil(a);a=this.resolutions[b]-(a-b)*(this.resolutions[b]-this.resolutions[c])}else a=this.resolutions[Math.round(a)];return a},getZoomForResolution:function(a,b){var c,f;if(this.map.fractionalZoom){b=0;var d=this.resolutions[b],
e=this.resolutions[this.resolutions.length-1],g;c=0;for(f=this.resolutions.length;c<f;++c){g=this.resolutions[c];if(g>=a){d=g;b=c}if(g<=a){e=g;break}}c=d-e;a=c>0?b+(d-a)/c:b}else{e=Number.POSITIVE_INFINITY;c=0;for(f=this.resolutions.length;c<f;c++)if(b){d=Math.abs(this.resolutions[c]-a);if(d>e)break;e=d}else if(this.resolutions[c]<a)break;a=Math.max(0,c-1)}return a},getLonLatFromViewPortPx:function(a){var b=null,c=this.map;if(a!=null&&c.minPx){b=c.getResolution();var f=c.getMaxExtent({restricted:true});
b=new OpenLayers.LonLat((a.x-c.minPx.x)*b+f.left,(c.minPx.y-a.y)*b+f.top);if(this.wrapDateLine)b=b.wrapDateLine(this.maxExtent)}return b},getViewPortPxFromLonLat:function(a,b){var c=null;if(a!=null){b=b||this.map.getResolution();c=this.map.calculateBounds(null,b);c=new OpenLayers.Pixel(1/b*(a.lon-c.left),1/b*(c.top-a.lat))}return c},setOpacity:function(a){if(a!=this.opacity){this.opacity=a;for(var b=this.div.childNodes,c=0,f=b.length;c<f;++c){var d=b[c].firstChild||b[c],e=b[c].lastChild;if(e&&e.nodeName.toLowerCase()===
"iframe")d=e.parentNode;OpenLayers.Util.modifyDOMElement(d,null,null,null,null,null,null,a)}this.map!=null&&this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"})}},getZIndex:function(){return this.div.style.zIndex},setZIndex:function(a){this.div.style.zIndex=a},adjustBounds:function(a){if(this.gutter){var b=this.gutter*this.map.getResolution();a=new OpenLayers.Bounds(a.left-b,a.bottom-b,a.right+b,a.top+b)}if(this.wrapDateLine){b={rightTolerance:this.getResolution(),leftTolerance:this.getResolution()};
a=a.wrapDateLine(this.maxExtent,b)}return a},CLASS_NAME:"OpenLayers.Layer"});
OpenLayers.Layer.HTTPRequest=OpenLayers.Class(OpenLayers.Layer,{URL_HASH_FACTOR:(Math.sqrt(5)-1)/2,url:null,params:null,reproject:false,initialize:function(a,b,c,f){OpenLayers.Layer.prototype.initialize.apply(this,[a,f]);this.url=b;if(!this.params)this.params=OpenLayers.Util.extend({},c)},destroy:function(){this.params=this.url=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(a){if(a==null)a=new OpenLayers.Layer.HTTPRequest(this.name,this.url,this.params,this.getOptions());
return a=OpenLayers.Layer.prototype.clone.apply(this,[a])},setUrl:function(a){this.url=a},mergeNewParams:function(a){this.params=OpenLayers.Util.extend(this.params,a);a=this.redraw();this.map!=null&&this.map.events.triggerEvent("changelayer",{layer:this,property:"params"});return a},redraw:function(a){return a?this.mergeNewParams({_olSalt:Math.random()}):OpenLayers.Layer.prototype.redraw.apply(this,[])},selectUrl:function(a,b){for(var c=1,f=0,d=a.length;f<d;f++){c*=a.charCodeAt(f)*this.URL_HASH_FACTOR;
c-=Math.floor(c)}return b[Math.floor(c*b.length)]},getFullRequestString:function(a,b){b=b||this.url;var c=OpenLayers.Util.extend({},this.params);c=OpenLayers.Util.extend(c,a);a=OpenLayers.Util.getParameterString(c);if(OpenLayers.Util.isArray(b))b=this.selectUrl(a,b);a=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(b));for(var f in c)f.toUpperCase()in a&&delete c[f];a=OpenLayers.Util.getParameterString(c);return OpenLayers.Util.urlAppend(b,a)},CLASS_NAME:"OpenLayers.Layer.HTTPRequest"});
OpenLayers.Tile=OpenLayers.Class({events:null,eventListeners:null,id:null,layer:null,url:null,bounds:null,size:null,position:null,isLoading:false,initialize:function(a,b,c,f,d,e){this.layer=a;this.position=b.clone();this.setBounds(c);this.url=f;if(d)this.size=d.clone();this.id=OpenLayers.Util.createUniqueID("Tile_");OpenLayers.Util.extend(this,e);this.events=new OpenLayers.Events(this);this.eventListeners instanceof Object&&this.events.on(this.eventListeners)},unload:function(){if(this.isLoading){this.isLoading=
false;this.events.triggerEvent("unload")}},destroy:function(){this.position=this.size=this.bounds=this.layer=null;this.eventListeners&&this.events.un(this.eventListeners);this.events.destroy();this.events=this.eventListeners=null},draw:function(a){a||this.clear();var b=this.shouldDraw();if(b&&!a)b=this.events.triggerEvent("beforedraw")!==false;return b},shouldDraw:function(){var a=false,b=this.layer.maxExtent;if(b){var c=this.layer.map;c=c.baseLayer.wrapDateLine&&c.getMaxExtent();if(this.bounds.intersectsBounds(b,
{inclusive:false,worldBounds:c}))a=true}return a||this.layer.displayOutsideMaxExtent},setBounds:function(a){a=a.clone();if(this.layer.map.baseLayer.wrapDateLine){var b=this.layer.map.getMaxExtent(),c=this.layer.map.getResolution();a=a.wrapDateLine(b,{leftTolerance:c,rightTolerance:c})}this.bounds=a},moveTo:function(a,b,c){if(c==null)c=true;this.setBounds(a);this.position=b.clone();c&&this.draw()},clear:function(){},CLASS_NAME:"OpenLayers.Tile"});
OpenLayers.Tile.Image=OpenLayers.Class(OpenLayers.Tile,{url:null,imgDiv:null,frame:null,imageReloadAttempts:null,layerAlphaHack:null,asyncRequestId:null,blankImageUrl:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAQAIBRAA7",maxGetUrlLength:null,canvasContext:null,crossOriginKeyword:null,initialize:function(a,b,c,f){OpenLayers.Tile.prototype.initialize.apply(this,arguments);this.url=f;this.layerAlphaHack=this.layer.alpha&&OpenLayers.Util.alphaHack();if(this.maxGetUrlLength!=
null||this.layer.gutter||this.layerAlphaHack){this.frame=document.createElement("div");this.frame.style.position="absolute";this.frame.style.overflow="hidden"}this.maxGetUrlLength!=null&&OpenLayers.Util.extend(this,OpenLayers.Tile.Image.IFrame)},destroy:function(){if(this.imgDiv){this.clear();this.frame=this.imgDiv=null}this.asyncRequestId=null;OpenLayers.Tile.prototype.destroy.apply(this,arguments)},draw:function(){var a=OpenLayers.Tile.prototype.draw.apply(this,arguments);if(a){if(this.layer!=this.layer.map.baseLayer&&
this.layer.reproject)this.bounds=this.getBoundsFromBaseLayer(this.position);if(this.isLoading)this._loadEvent="reload";else{this.isLoading=true;this._loadEvent="loadstart"}this.positionTile();this.renderTile()}else this.unload();return a},renderTile:function(){this.layer.div.appendChild(this.getTile());if(this.layer.async){var a=this.asyncRequestId=(this.asyncRequestId||0)+1;this.layer.getURLasync(this.bounds,function(b){if(a==this.asyncRequestId){this.url=b;this.initImage()}},this)}else{this.url=
this.layer.getURL(this.bounds);this.initImage()}},positionTile:function(){var a=this.getTile().style,b=this.frame?this.size:this.layer.getImageSize(this.bounds);a.left=this.position.x+"%";a.top=this.position.y+"%";a.width=b.w+"%";a.height=b.h+"%"},clear:function(){OpenLayers.Tile.prototype.clear.apply(this,arguments);var a=this.imgDiv;if(a){OpenLayers.Event.stopObservingElement(a);var b=this.getTile();b.parentNode===this.layer.div&&this.layer.div.removeChild(b);this.setImgSrc();if(this.layerAlphaHack===
true)a.style.filter="";OpenLayers.Element.removeClass(a,"olImageLoadError")}this.canvasContext=null},getImage:function(){if(!this.imgDiv){this.imgDiv=document.createElement("img");this.imgDiv.className="olTileImage";this.imgDiv.galleryImg="no";var a=this.imgDiv.style;if(this.frame){var b=0,c=0;if(this.layer.gutter){b=this.layer.gutter/this.layer.tileSize.w*100;c=this.layer.gutter/this.layer.tileSize.h*100}a.left=-b+"%";a.top=-c+"%";a.width=2*b+100+"%";a.height=2*c+100+"%"}a.visibility="hidden";a.opacity=
0;if(this.layer.opacity<1)a.filter="alpha(opacity="+this.layer.opacity*100+")";a.position="absolute";if(this.layerAlphaHack){a.paddingTop=a.height;a.height="0";a.width="100%"}this.frame&&this.frame.appendChild(this.imgDiv)}return this.imgDiv},initImage:function(){this.events.triggerEvent(this._loadEvent);var a=this.getImage();if(this.url&&a.getAttribute("src")==this.url)this.onImageLoad();else{var b=OpenLayers.Function.bind(function(){OpenLayers.Event.stopObservingElement(a);OpenLayers.Event.observe(a,
"load",OpenLayers.Function.bind(this.onImageLoad,this));OpenLayers.Event.observe(a,"error",OpenLayers.Function.bind(this.onImageError,this));this.imageReloadAttempts=0;this.setImgSrc(this.url)},this);if(a.getAttribute("src")==this.blankImageUrl)b();else{OpenLayers.Event.observe(a,"load",b);OpenLayers.Event.observe(a,"error",b);this.crossOriginKeyword&&a.removeAttribute("crossorigin");a.src=this.blankImageUrl}}},setImgSrc:function(a){var b=this.imgDiv;b.style.visibility="hidden";b.style.opacity=0;
if(a){if(this.crossOriginKeyword)a.substr(0,5)!=="data:"?b.setAttribute("crossorigin",this.crossOriginKeyword):b.removeAttribute("crossorigin");b.src=a}},getTile:function(){return this.frame?this.frame:this.getImage()},createBackBuffer:function(){if(!(!this.imgDiv||this.isLoading)){var a;if(this.frame){a=this.frame.cloneNode(false);a.appendChild(this.imgDiv)}else a=this.imgDiv;this.imgDiv=null;return a}},onImageLoad:function(){var a=this.imgDiv;OpenLayers.Event.stopObservingElement(a);a.style.visibility=
"inherit";a.style.opacity=this.layer.opacity;this.isLoading=false;this.canvasContext=null;this.events.triggerEvent("loadend");if(parseFloat(navigator.appVersion.split("MSIE")[1])<7&&this.layer&&this.layer.div){var b=document.createElement("span");b.style.display="none";var c=this.layer.div;c.appendChild(b);window.setTimeout(function(){b.parentNode===c&&b.parentNode.removeChild(b)},0)}if(this.layerAlphaHack===true)a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+a.src+"', sizingMethod='scale')"},
onImageError:function(){var a=this.imgDiv;if(a.src!=null){this.imageReloadAttempts++;if(this.imageReloadAttempts<=OpenLayers.IMAGE_RELOAD_ATTEMPTS)this.setImgSrc(this.layer.getURL(this.bounds));else{OpenLayers.Element.addClass(a,"olImageLoadError");this.events.triggerEvent("loaderror");this.onImageLoad()}}},getCanvasContext:function(){if(OpenLayers.CANVAS_SUPPORTED&&this.imgDiv&&!this.isLoading){if(!this.canvasContext){var a=document.createElement("canvas");a.width=this.size.w;a.height=this.size.h;
this.canvasContext=a.getContext("2d");this.canvasContext.drawImage(this.imgDiv,0,0)}return this.canvasContext}},CLASS_NAME:"OpenLayers.Tile.Image"});
OpenLayers.Layer.Grid=OpenLayers.Class(OpenLayers.Layer.HTTPRequest,{tileSize:null,tileOriginCorner:"bl",tileOrigin:null,tileOptions:null,tileClass:OpenLayers.Tile.Image,grid:null,singleTile:false,ratio:1.5,buffer:0,transitionEffect:null,numLoadingTiles:0,tileLoadingDelay:85,serverResolutions:null,moveTimerId:null,deferMoveGriddedTiles:null,tileQueueId:null,tileQueue:null,loading:false,backBuffer:null,gridResolution:null,backBufferResolution:null,backBufferLonLat:null,backBufferTimerId:null,removeBackBufferDelay:null,
className:null,initialize:function(){OpenLayers.Layer.HTTPRequest.prototype.initialize.apply(this,arguments);this.grid=[];this.tileQueue=[];if(this.removeBackBufferDelay===null)this.removeBackBufferDelay=this.singleTile?0:2500;if(this.className===null)this.className=this.singleTile?"olLayerGridSingleTile":"olLayerGrid";if(!OpenLayers.Animation.isNative)this.deferMoveGriddedTiles=OpenLayers.Function.bind(function(){this.moveGriddedTiles(true);this.moveTimerId=null},this)},setMap:function(a){OpenLayers.Layer.HTTPRequest.prototype.setMap.call(this,
a);OpenLayers.Element.addClass(this.div,this.className)},removeMap:function(){if(this.moveTimerId!==null){window.clearTimeout(this.moveTimerId);this.moveTimerId=null}this.clearTileQueue();if(this.backBufferTimerId!==null){window.clearTimeout(this.backBufferTimerId);this.backBufferTimerId=null}},destroy:function(){this.removeBackBuffer();this.clearGrid();this.tileSize=this.grid=null;OpenLayers.Layer.HTTPRequest.prototype.destroy.apply(this,arguments)},clearGrid:function(){this.clearTileQueue();if(this.grid){for(var a=
0,b=this.grid.length;a<b;a++)for(var c=this.grid[a],f=0,d=c.length;f<d;f++)this.destroyTile(c[f]);this.grid=[];this.gridResolution=null}},clone:function(a){if(a==null)a=new OpenLayers.Layer.Grid(this.name,this.url,this.params,this.getOptions());a=OpenLayers.Layer.HTTPRequest.prototype.clone.apply(this,[a]);if(this.tileSize!=null)a.tileSize=this.tileSize.clone();a.grid=[];a.gridResolution=null;a.backBuffer=null;a.backBufferTimerId=null;a.tileQueue=[];a.tileQueueId=null;a.loading=false;a.moveTimerId=
null;return a},moveTo:function(a,b,c){OpenLayers.Layer.HTTPRequest.prototype.moveTo.apply(this,arguments);a=a||this.map.getExtent();if(a!=null){var f=!this.grid.length||b,d=this.getTilesBounds(),e=this.map.getResolution(),g=this.getServerResolution(e);if(this.singleTile){if(f||!c&&!d.containsBounds(a)){b&&this.transitionEffect!=="resize"&&this.removeBackBuffer();if(!b||this.transitionEffect==="resize")this.applyBackBuffer(g);this.initSingleTile(a)}}else{f=f||!d.intersectsBounds(a,{worldBounds:this.map.baseLayer.wrapDateLine&&
this.map.getMaxExtent()});if(e!==g){a=this.map.calculateBounds(null,g);f&&this.transformDiv(g/e)}else{this.div.style.width="100%";this.div.style.height="100%";this.div.style.left="0%";this.div.style.top="0%"}if(f){b&&this.transitionEffect==="resize"&&this.applyBackBuffer(g);this.initGriddedTiles(a)}else this.moveGriddedTiles()}}},getTileData:function(a){var b=null,c=a.lon,f=a.lat,d=this.grid.length;if(this.map&&d){var e=this.map.getResolution();a=this.tileSize.w;var g=this.tileSize.h,h=this.grid[0][0].bounds,
i=h.left;h=h.top;if(c<i)if(this.map.baseLayer.wrapDateLine){var j=this.map.getMaxExtent().getWidth(),l=Math.ceil((i-c)/j);c+=j*l}c=(c-i)/(e*a);f=(h-f)/(e*g);e=Math.floor(c);i=Math.floor(f);if(i>=0&&i<d)if(d=this.grid[i][e])b={tile:d,i:Math.floor((c-e)*a),j:Math.floor((f-i)*g)}}return b},queueTileDraw:function(a){a=a.object;~OpenLayers.Util.indexOf(this.tileQueue,a)||this.tileQueue.push(a);if(!this.tileQueueId)this.tileQueueId=OpenLayers.Animation.start(OpenLayers.Function.bind(this.drawTileFromQueue,
this),null,this.div);return false},drawTileFromQueue:function(){this.tileQueue.length===0?this.clearTileQueue():this.tileQueue.shift().draw(true)},clearTileQueue:function(){OpenLayers.Animation.stop(this.tileQueueId);this.tileQueueId=null;this.tileQueue=[]},destroyTile:function(a){this.removeTileMonitoringHooks(a);a.destroy()},getServerResolution:function(a){a=a||this.map.getResolution();if(this.serverResolutions&&OpenLayers.Util.indexOf(this.serverResolutions,a)===-1){var b,c;for(b=this.serverResolutions.length-
1;b>=0;b--){c=this.serverResolutions[b];if(c>a){a=c;break}}if(b===-1)throw"no appropriate resolution in serverResolutions";}return a},getServerZoom:function(){var a=this.getServerResolution();return this.serverResolutions?OpenLayers.Util.indexOf(this.serverResolutions,a):this.map.getZoomForResolution(a)+(this.zoomOffset||0)},transformDiv:function(a){this.div.style.width=100*a+"%";this.div.style.height=100*a+"%";var b=this.map.getSize(),c=parseInt(this.map.layerContainerDiv.style.left,10),f=(parseInt(this.map.layerContainerDiv.style.top,
10)-b.h/2)*(a-1);this.div.style.left=(c-b.w/2)*(a-1)+"%";this.div.style.top=f+"%"},getResolutionScale:function(){return parseInt(this.div.style.width,10)/100},applyBackBuffer:function(a){this.backBufferTimerId!==null&&this.removeBackBuffer();var b=this.backBuffer;if(!b){b=this.createBackBuffer();if(!b)return;this.div.insertBefore(b,this.div.firstChild);this.backBuffer=b;var c=this.grid[0][0].bounds;this.backBufferLonLat={lon:c.left,lat:c.top};this.backBufferResolution=this.gridResolution}c=b.style;
var f=this.backBufferResolution/a;c.width=100*f+"%";c.height=100*f+"%";a=this.getViewPortPxFromLonLat(this.backBufferLonLat,a);c=parseInt(this.map.layerContainerDiv.style.left,10);f=parseInt(this.map.layerContainerDiv.style.top,10);b.style.left=Math.round(a.x-c)+"%";b.style.top=Math.round(a.y-f)+"%"},createBackBuffer:function(){var a;if(this.grid.length>0){a=document.createElement("div");a.id=this.div.id+"_bb";a.className="olBackBuffer";a.style.position="absolute";a.style.width="100%";a.style.height=
"100%";for(var b=0,c=this.grid.length;b<c;b++)for(var f=0,d=this.grid[b].length;f<d;f++){var e=this.grid[b][f].createBackBuffer();if(e){e.style.top=b*this.tileSize.h+"%";e.style.left=f*this.tileSize.w+"%";a.appendChild(e)}}}return a},removeBackBuffer:function(){if(this.backBuffer){this.div.removeChild(this.backBuffer);this.backBufferResolution=this.backBuffer=null;if(this.backBufferTimerId!==null){window.clearTimeout(this.backBufferTimerId);this.backBufferTimerId=null}}},moveByPx:function(){this.singleTile||
this.moveGriddedTiles()},setTileSize:function(a){if(this.singleTile){a=this.map.getSize();a.h=parseInt(a.h*this.ratio);a.w=parseInt(a.w*this.ratio)}OpenLayers.Layer.HTTPRequest.prototype.setTileSize.apply(this,[a])},getTilesBounds:function(){var a=null,b=this.grid.length;if(b){a=this.grid[b-1][0].bounds;b=this.grid[0].length*a.getWidth();var c=this.grid.length*a.getHeight();a=new OpenLayers.Bounds(a.left,a.bottom,a.left+b,a.bottom+c)}return a},initSingleTile:function(a){this.clearTileQueue();var b=
a.getCenterLonLat(),c=a.getWidth()*this.ratio;a=a.getHeight()*this.ratio;b=new OpenLayers.Bounds(b.lon-c/2,b.lat-a/2,b.lon+c/2,b.lat+a/2);c=this.map.getLayerPxFromLonLat({lon:b.left,lat:b.top});this.grid.length||(this.grid[0]=[]);if(a=this.grid[0][0])a.moveTo(b,c);else{a=this.addTile(b,c);this.addTileMonitoringHooks(a);a.draw();this.grid[0][0]=a}this.removeExcessTiles(1,1);this.gridResolution=this.getServerResolution()},calculateGridLayout:function(a,b,c){var f=c*this.tileSize.w;c=c*this.tileSize.h;
var d=a.left-b.lon,e=Math.floor(d/f)-this.buffer;d=-(d/f-e)*this.tileSize.w;e=b.lon+e*f;a=a.top-(b.lat+c);var g=Math.ceil(a/c)+this.buffer;return{tilelon:f,tilelat:c,tileoffsetlon:e,tileoffsetlat:b.lat+g*c,tileoffsetx:d,tileoffsety:-(g-a/c)*this.tileSize.h}},getTileOrigin:function(){var a=this.tileOrigin;if(!a){a=this.getMaxExtent();var b={tl:["left","top"],tr:["right","top"],bl:["left","bottom"],br:["right","bottom"]}[this.tileOriginCorner];a=new OpenLayers.LonLat(a[b[0]],a[b[1]])}return a},initGriddedTiles:function(a){this.clearTileQueue();
var b=this.map.getSize(),c=Math.ceil(b.h/this.tileSize.h)+Math.max(1,2*this.buffer);b=Math.ceil(b.w/this.tileSize.w)+Math.max(1,2*this.buffer);var f=this.getTileOrigin(),d=this.getServerResolution();f=this.calculateGridLayout(a,f,d);d=Math.round(f.tileoffsetx);var e=Math.round(f.tileoffsety),g=f.tileoffsetlon,h=f.tileoffsetlat,i=f.tilelon,j=f.tilelat,l=d,k=g,m=0,n=parseInt(this.map.layerContainerDiv.style.left),q=parseInt(this.map.layerContainerDiv.style.top);f=[];var p=this.map.getCenter();do{var o=
this.grid[m++];if(!o){o=[];this.grid.push(o)}g=k;d=l;var t=0;do{var u=new OpenLayers.Bounds(g,h,g+i,h+j),s=d;s-=n;var v=e;v-=q;v=new OpenLayers.Pixel(s,v);if(s=o[t++])s.moveTo(u,v,false);else{s=this.addTile(u,v);this.addTileMonitoringHooks(s);o.push(s)}u=u.getCenterLonLat();f.push({tile:s,distance:Math.pow(u.lon-p.lon,2)+Math.pow(u.lat-p.lat,2)});g+=i;d+=this.tileSize.w}while(g<=a.right+i*this.buffer||t<b);h-=j;e+=this.tileSize.h}while(h>=a.bottom-j*this.buffer||m<c);this.removeExcessTiles(m,t);this.gridResolution=
this.getServerResolution();f.sort(function(r,w){return r.distance-w.distance});a=0;for(c=f.length;a<c;++a)f[a].tile.draw()},getMaxExtent:function(){return this.maxExtent},addTile:function(a,b){a=new this.tileClass(this,b,a,null,this.tileSize,this.tileOptions);a.events.register("beforedraw",this,this.queueTileDraw);return a},addTileMonitoringHooks:function(a){a.onLoadStart=function(){if(this.loading===false){this.loading=true;this.events.triggerEvent("loadstart")}this.events.triggerEvent("tileloadstart",
{tile:a});this.numLoadingTiles++};a.onLoadEnd=function(){this.numLoadingTiles--;this.events.triggerEvent("tileloaded",{tile:a});if(this.tileQueue.length===0&&this.numLoadingTiles===0){this.loading=false;this.events.triggerEvent("loadend");if(this.backBuffer)this.backBufferTimerId=window.setTimeout(OpenLayers.Function.bind(this.removeBackBuffer,this),this.removeBackBufferDelay)}};a.onLoadError=function(){this.events.triggerEvent("tileerror",{tile:a})};a.events.on({loadstart:a.onLoadStart,loadend:a.onLoadEnd,
unload:a.onLoadEnd,loaderror:a.onLoadError,scope:this})},removeTileMonitoringHooks:function(a){a.unload();a.events.un({loadstart:a.onLoadStart,loadend:a.onLoadEnd,unload:a.onLoadEnd,loaderror:a.onLoadError,scope:this})},moveGriddedTiles:function(a){if(!a&&!OpenLayers.Animation.isNative){this.moveTimerId!=null&&window.clearTimeout(this.moveTimerId);this.moveTimerId=window.setTimeout(this.deferMoveGriddedTiles,this.tileLoadingDelay)}else{a=this.buffer||1;for(var b=this.getResolutionScale();;){var c=
{x:this.grid[0][0].position.x*b+parseInt(this.div.style.left,10)+parseInt(this.map.layerContainerDiv.style.left),y:this.grid[0][0].position.y*b+parseInt(this.div.style.top,10)+parseInt(this.map.layerContainerDiv.style.top)},f={w:this.tileSize.w*b,h:this.tileSize.h*b};if(c.x>-f.w*(a-1))this.shiftColumn(true);else if(c.x<-f.w*a)this.shiftColumn(false);else if(c.y>-f.h*(a-1))this.shiftRow(true);else if(c.y<-f.h*a)this.shiftRow(false);else break}}},shiftRow:function(a){var b=this.grid,c=b[a?0:this.grid.length-
1],f=this.getServerResolution(),d=a?-this.tileSize.h:this.tileSize.h;f=f*-d;for(var e=a?b.pop():b.shift(),g=0,h=c.length;g<h;g++){var i=c[g],j=i.bounds.clone();i=i.position.clone();j.bottom+=f;j.top+=f;i.y+=d;e[g].moveTo(j,i)}a?b.unshift(e):b.push(e)},shiftColumn:function(a){for(var b=a?-this.tileSize.w:this.tileSize.w,c=this.getServerResolution()*b,f=0,d=this.grid.length;f<d;f++){var e=this.grid[f],g=e[a?0:e.length-1],h=g.bounds.clone();g=g.position.clone();h.left+=c;h.right+=c;g.x+=b;var i=a?this.grid[f].pop():
this.grid[f].shift();i.moveTo(h,g);a?e.unshift(i):e.push(i)}},removeExcessTiles:function(a,b){for(var c,f;this.grid.length>a;){var d=this.grid.pop();c=0;for(f=d.length;c<f;c++){var e=d[c];this.destroyTile(e)}}c=0;for(f=this.grid.length;c<f;c++)for(;this.grid[c].length>b;){d=this.grid[c];e=d.pop();this.destroyTile(e)}},onMapResize:function(){if(this.singleTile){this.clearGrid();this.setTileSize()}},getTileBounds:function(a){var b=this.maxExtent,c=this.getResolution(),f=c*this.tileSize.w;c=c*this.tileSize.h;
var d=this.getLonLatFromViewPortPx(a);a=b.left+f*Math.floor((d.lon-b.left)/f);b=b.bottom+c*Math.floor((d.lat-b.bottom)/c);return new OpenLayers.Bounds(a,b,a+f,b+c)},CLASS_NAME:"OpenLayers.Layer.Grid"});
OpenLayers.Handler=OpenLayers.Class({id:null,control:null,map:null,keyMask:null,active:false,evt:null,initialize:function(a,b,c){OpenLayers.Util.extend(this,c);this.control=a;this.callbacks=b;(a=this.map||a.map)&&this.setMap(a);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},setMap:function(a){this.map=a},checkModifiers:function(a){if(this.keyMask==null)return true;return((a.shiftKey?OpenLayers.Handler.MOD_SHIFT:0)|(a.ctrlKey?OpenLayers.Handler.MOD_CTRL:0)|(a.altKey?OpenLayers.Handler.MOD_ALT:
0))==this.keyMask},activate:function(){if(this.active)return false;for(var a=OpenLayers.Events.prototype.BROWSER_EVENTS,b=0,c=a.length;b<c;b++)this[a[b]]&&this.register(a[b],this[a[b]]);return this.active=true},deactivate:function(){if(!this.active)return false;for(var a=OpenLayers.Events.prototype.BROWSER_EVENTS,b=0,c=a.length;b<c;b++)this[a[b]]&&this.unregister(a[b],this[a[b]]);this.active=false;return true},callback:function(a,b){a&&this.callbacks[a]&&this.callbacks[a].apply(this.control,b)},register:function(a,
b){this.map.events.registerPriority(a,this,b);this.map.events.registerPriority(a,this,this.setEvent)},unregister:function(a,b){this.map.events.unregister(a,this,b);this.map.events.unregister(a,this,this.setEvent)},setEvent:function(a){this.evt=a;return true},destroy:function(){this.deactivate();this.control=this.map=null},CLASS_NAME:"OpenLayers.Handler"});OpenLayers.Handler.MOD_NONE=0;OpenLayers.Handler.MOD_SHIFT=1;OpenLayers.Handler.MOD_CTRL=2;OpenLayers.Handler.MOD_ALT=4;
OpenLayers.Handler.Click=OpenLayers.Class(OpenLayers.Handler,{delay:300,single:true,"double":false,pixelTolerance:0,dblclickTolerance:13,stopSingle:false,stopDouble:false,timerId:null,touch:false,down:null,last:null,first:null,rightclickTimerId:null,touchstart:function(a){if(!this.touch){this.unregisterMouseListeners();this.touch=true}this.down=this.getEventInfo(a);this.last=this.getEventInfo(a);return true},touchmove:function(a){this.last=this.getEventInfo(a);return true},touchend:function(a){if(this.down){a.xy=
this.last.xy;a.lastTouches=this.last.touches;this.handleSingle(a);this.down=null}return true},unregisterMouseListeners:function(){this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,click:this.click,dblclick:this.dblclick,scope:this})},mousedown:function(a){this.down=this.getEventInfo(a);this.last=this.getEventInfo(a);return true},mouseup:function(a){var b=true;if(this.checkModifiers(a)&&this.control.handleRightClicks&&OpenLayers.Event.isRightClick(a))b=this.rightclick(a);return b},
rightclick:function(a){if(this.passesTolerance(a))if(this.rightclickTimerId!=null){this.clearTimer();this.callback("dblrightclick",[a]);return!this.stopDouble}else{a=this["double"]?OpenLayers.Util.extend({},a):this.callback("rightclick",[a]);a=OpenLayers.Function.bind(this.delayedRightCall,this,a);this.rightclickTimerId=window.setTimeout(a,this.delay)}return!this.stopSingle},delayedRightCall:function(a){this.rightclickTimerId=null;a&&this.callback("rightclick",[a])},click:function(a){if(!this.last)this.last=
this.getEventInfo(a);this.handleSingle(a);return!this.stopSingle},dblclick:function(a){this.handleDouble(a);return!this.stopDouble},handleDouble:function(a){if(this.passesDblclickTolerance(a)){this["double"]&&this.callback("dblclick",[a]);this.clearTimer()}},handleSingle:function(a){if(this.passesTolerance(a))if(this.timerId!=null){if(this.last.touches&&this.last.touches.length===1){this["double"]&&OpenLayers.Event.stop(a);this.handleDouble(a)}if(!this.last.touches||this.last.touches.length!==2)this.clearTimer()}else{this.first=
this.getEventInfo(a);this.queuePotentialClick(this.single?OpenLayers.Util.extend({},a):null)}},queuePotentialClick:function(a){this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,a),this.delay)},passesTolerance:function(a){var b=true;if(this.pixelTolerance!=null&&this.down&&this.down.xy)if((b=this.pixelTolerance>=this.down.xy.distanceTo(a.xy))&&this.touch&&this.down.touches.length===this.last.touches.length){a=0;for(var c=this.down.touches.length;a<c;++a)if(this.getTouchDistance(this.down.touches[a],
this.last.touches[a])>this.pixelTolerance){b=false;break}}return b},getTouchDistance:function(a,b){return Math.sqrt(Math.pow(a.clientX-b.clientX,2)+Math.pow(a.clientY-b.clientY,2))},passesDblclickTolerance:function(){var a=true;if(this.down&&this.first)a=this.down.xy.distanceTo(this.first.xy)<=this.dblclickTolerance;return a},clearTimer:function(){if(this.timerId!=null){window.clearTimeout(this.timerId);this.timerId=null}if(this.rightclickTimerId!=null){window.clearTimeout(this.rightclickTimerId);
this.rightclickTimerId=null}},delayedCall:function(a){this.timerId=null;a&&this.callback("click",[a])},getEventInfo:function(a){var b;if(a.touches){var c=a.touches.length;b=new Array(c);for(var f,d=0;d<c;d++){f=a.touches[d];b[d]={clientX:f.clientX,clientY:f.clientY}}}return{xy:a.xy,touches:b}},deactivate:function(){var a=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.clearTimer();this.last=this.first=this.down=null;this.touch=false;a=true}return a},CLASS_NAME:"OpenLayers.Handler.Click"});
OpenLayers.Kinetic=OpenLayers.Class({threshold:0,deceleration:0.0035,nbPoints:100,delay:200,points:undefined,timerId:undefined,initialize:function(a){OpenLayers.Util.extend(this,a)},begin:function(){OpenLayers.Animation.stop(this.timerId);this.timerId=undefined;this.points=[]},update:function(a){this.points.unshift({xy:a,tick:(new Date).getTime()});this.points.length>this.nbPoints&&this.points.pop()},end:function(a){for(var b,c=(new Date).getTime(),f=0,d=this.points.length,e;f<d;f++){e=this.points[f];
if(c-e.tick>this.delay)break;b=e}if(b){f=(new Date).getTime()-b.tick;c=Math.sqrt(Math.pow(a.x-b.xy.x,2)+Math.pow(a.y-b.xy.y,2));f=c/f;if(!(f==0||f<this.threshold)){c=Math.asin((a.y-b.xy.y)/c);if(b.xy.x<=a.x)c=Math.PI-c;return{speed:f,theta:c}}}},move:function(a,b){var c=a.speed,f=Math.cos(a.theta),d=-Math.sin(a.theta),e=(new Date).getTime(),g=0,h=0;this.timerId=OpenLayers.Animation.start(OpenLayers.Function.bind(function(){if(this.timerId!=null){var i=(new Date).getTime()-e,j=-this.deceleration*Math.pow(i,
2)/2+c*i,l=j*f;j=j*d;var k={};k.end=false;if(-this.deceleration*i+c<=0){OpenLayers.Animation.stop(this.timerId);this.timerId=null;k.end=true}k.x=l-g;k.y=j-h;g=l;h=j;b(k.x,k.y,k.end)}},this))},CLASS_NAME:"OpenLayers.Kinetic"});
OpenLayers.Control=OpenLayers.Class({id:null,map:null,div:null,type:null,allowSelection:false,displayClass:"",title:"",autoActivate:false,active:null,handler:null,eventListeners:null,events:null,initialize:function(a){this.displayClass=this.CLASS_NAME.replace("OpenLayers.","ol").replace(/\./g,"");OpenLayers.Util.extend(this,a);this.events=new OpenLayers.Events(this);this.eventListeners instanceof Object&&this.events.on(this.eventListeners);if(this.id==null)this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+
"_")},destroy:function(){if(this.events){this.eventListeners&&this.events.un(this.eventListeners);this.events.destroy();this.events=null}this.eventListeners=null;if(this.handler){this.handler.destroy();this.handler=null}if(this.handlers){for(var a in this.handlers)this.handlers.hasOwnProperty(a)&&typeof this.handlers[a].destroy=="function"&&this.handlers[a].destroy();this.handlers=null}if(this.map){this.map.removeControl(this);this.map=null}this.div=null},setMap:function(a){this.map=a;this.handler&&
this.handler.setMap(a)},draw:function(a){if(this.div==null){this.div=OpenLayers.Util.createDiv(this.id);this.div.className=this.displayClass;if(!this.allowSelection){this.div.className+=" olControlNoSelect";this.div.setAttribute("unselectable","on",0);this.div.onselectstart=OpenLayers.Function.False}if(this.title!="")this.div.title=this.title}if(a!=null)this.position=a.clone();this.moveTo(this.position);return this.div},moveTo:function(a){if(a!=null&&this.div!=null){this.div.style.left=a.x+"px";this.div.style.top=
a.y+"px"}},activate:function(){if(this.active)return false;this.handler&&this.handler.activate();this.active=true;this.map&&OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active");this.events.triggerEvent("activate");return true},deactivate:function(){if(this.active){this.handler&&this.handler.deactivate();this.active=false;this.map&&OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active");this.events.triggerEvent("deactivate");
return true}return false},CLASS_NAME:"OpenLayers.Control"});OpenLayers.Control.TYPE_BUTTON=1;OpenLayers.Control.TYPE_TOGGLE=2;OpenLayers.Control.TYPE_TOOL=3;
OpenLayers.Handler.Drag=OpenLayers.Class(OpenLayers.Handler,{started:false,stopDown:true,dragging:false,touch:false,last:null,start:null,lastMoveEvt:null,oldOnselectstart:null,interval:0,timeoutId:null,documentDrag:false,documentEvents:null,initialize:function(){OpenLayers.Handler.prototype.initialize.apply(this,arguments);if(this.documentDrag===true){var a=this;this._docMove=function(b){a.mousemove({xy:{x:b.clientX,y:b.clientY},element:document})};this._docUp=function(b){a.mouseup({xy:{x:b.clientX,
y:b.clientY}})}}},dragstart:function(a){var b=true;this.dragging=false;if(this.checkModifiers(a)&&(OpenLayers.Event.isLeftClick(a)||OpenLayers.Event.isSingleTouch(a))){this.started=true;this.last=this.start=a.xy;OpenLayers.Element.addClass(this.map.viewPortDiv,"olDragDown");this.down(a);this.callback("down",[a.xy]);OpenLayers.Event.stop(a);if(!this.oldOnselectstart)this.oldOnselectstart=document.onselectstart?document.onselectstart:OpenLayers.Function.True;document.onselectstart=OpenLayers.Function.False;
b=!this.stopDown}else{this.started=false;this.last=this.start=null}return b},dragmove:function(a){this.lastMoveEvt=a;if(this.started&&!this.timeoutId&&(a.xy.x!=this.last.x||a.xy.y!=this.last.y)){if(this.documentDrag===true&&this.documentEvents)if(a.element===document){this.adjustXY(a);this.setEvent(a)}else this.removeDocumentEvents();if(this.interval>0)this.timeoutId=setTimeout(OpenLayers.Function.bind(this.removeTimeout,this),this.interval);this.dragging=true;this.move(a);this.callback("move",[a.xy]);
if(!this.oldOnselectstart){this.oldOnselectstart=document.onselectstart;document.onselectstart=OpenLayers.Function.False}this.last=a.xy}return true},dragend:function(a){if(this.started){if(this.documentDrag===true&&this.documentEvents){this.adjustXY(a);this.removeDocumentEvents()}var b=this.start!=this.last;this.dragging=this.started=false;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown");this.up(a);this.callback("up",[a.xy]);b&&this.callback("done",[a.xy]);document.onselectstart=
this.oldOnselectstart}return true},down:function(){},move:function(){},up:function(){},out:function(){},mousedown:function(a){return this.dragstart(a)},touchstart:function(a){if(!this.touch){this.touch=true;this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,mousemove:this.mousemove,click:this.click,scope:this})}return this.dragstart(a)},mousemove:function(a){return this.dragmove(a)},touchmove:function(a){return this.dragmove(a)},removeTimeout:function(){this.timeoutId=null;this.dragging&&
this.mousemove(this.lastMoveEvt)},mouseup:function(a){return this.dragend(a)},touchend:function(a){a.xy=this.last;return this.dragend(a)},mouseout:function(a){if(this.started&&OpenLayers.Util.mouseLeft(a,this.map.viewPortDiv))if(this.documentDrag===true)this.addDocumentEvents();else{var b=this.start!=this.last;this.dragging=this.started=false;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown");this.out(a);this.callback("out",[]);b&&this.callback("done",[a.xy]);if(document.onselectstart)document.onselectstart=
this.oldOnselectstart}return true},click:function(){return this.start==this.last},activate:function(){var a=false;if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.dragging=false;a=true}return a},deactivate:function(){var a=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.dragging=this.started=this.touch=false;this.last=this.start=null;a=true;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown")}return a},adjustXY:function(a){var b=OpenLayers.Util.pagePosition(this.map.viewPortDiv);
a.xy.x-=b[0];a.xy.y-=b[1]},addDocumentEvents:function(){OpenLayers.Element.addClass(document.body,"olDragDown");this.documentEvents=true;OpenLayers.Event.observe(document,"mousemove",this._docMove);OpenLayers.Event.observe(document,"mouseup",this._docUp)},removeDocumentEvents:function(){OpenLayers.Element.removeClass(document.body,"olDragDown");this.documentEvents=false;OpenLayers.Event.stopObserving(document,"mousemove",this._docMove);OpenLayers.Event.stopObserving(document,"mouseup",this._docUp)},
CLASS_NAME:"OpenLayers.Handler.Drag"});
OpenLayers.Handler.Box=OpenLayers.Class(OpenLayers.Handler,{dragHandler:null,boxDivClassName:"olHandlerBoxZoomBox",boxOffsets:null,initialize:function(){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.dragHandler=new OpenLayers.Handler.Drag(this,{down:this.startBox,move:this.moveBox,out:this.removeBox,up:this.endBox},{keyMask:this.keyMask})},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments);if(this.dragHandler){this.dragHandler.destroy();this.dragHandler=
null}},setMap:function(a){OpenLayers.Handler.prototype.setMap.apply(this,arguments);this.dragHandler&&this.dragHandler.setMap(a)},startBox:function(){this.callback("start",[]);this.zoomBox=OpenLayers.Util.createDiv("zoomBox",{x:-9999,y:-9999});this.zoomBox.className=this.boxDivClassName;this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1;this.map.viewPortDiv.appendChild(this.zoomBox);OpenLayers.Element.addClass(this.map.viewPortDiv,"olDrawBox")},moveBox:function(a){var b=this.dragHandler.start.x,
c=this.dragHandler.start.y,f=Math.abs(b-a.x),d=Math.abs(c-a.y),e=this.getBoxOffsets();this.zoomBox.style.width=f+e.width+1+"px";this.zoomBox.style.height=d+e.height+1+"px";this.zoomBox.style.left=(a.x<b?b-f-e.left:b-e.left)+"px";this.zoomBox.style.top=(a.y<c?c-d-e.top:c-e.top)+"px"},endBox:function(a){var b;if(Math.abs(this.dragHandler.start.x-a.x)>5||Math.abs(this.dragHandler.start.y-a.y)>5){var c=this.dragHandler.start;b=Math.min(c.y,a.y);var f=Math.max(c.y,a.y),d=Math.min(c.x,a.x);a=Math.max(c.x,
a.x);b=new OpenLayers.Bounds(d,f,a,b)}else b=this.dragHandler.start.clone();this.removeBox();this.callback("done",[b])},removeBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox);this.boxOffsets=this.zoomBox=null;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDrawBox")},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.dragHandler.activate();return true}else return false},deactivate:function(){if(OpenLayers.Handler.prototype.deactivate.apply(this,
arguments)){this.dragHandler.deactivate()&&this.zoomBox&&this.removeBox();return true}else return false},getBoxOffsets:function(){if(!this.boxOffsets){var a=document.createElement("div");a.style.position="absolute";a.style.border="1px solid black";a.style.width="3px";document.body.appendChild(a);var b=a.clientWidth==3;document.body.removeChild(a);a=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-left-width"));var c=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-right-width")),
f=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-top-width")),d=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-bottom-width"));this.boxOffsets={left:a,right:c,top:f,bottom:d,width:b===false?a+c:0,height:b===false?f+d:0}}return this.boxOffsets},CLASS_NAME:"OpenLayers.Handler.Box"});
OpenLayers.Control.ZoomBox=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,out:false,keyMask:null,alwaysZoom:false,draw:function(){this.handler=new OpenLayers.Handler.Box(this,{done:this.zoomBox},{keyMask:this.keyMask})},zoomBox:function(a){if(a instanceof OpenLayers.Bounds){var b;if(this.out){b=Math.abs(a.right-a.left);var c=Math.abs(a.top-a.bottom);b=Math.min(this.map.size.h/c,this.map.size.w/b);c=this.map.getExtent();var f=this.map.getLonLatFromPixel(a.getCenterPixel());
a=f.lon-c.getWidth()/2*b;var d=f.lon+c.getWidth()/2*b,e=f.lat-c.getHeight()/2*b;b=f.lat+c.getHeight()/2*b;b=new OpenLayers.Bounds(a,e,d,b)}else{b=this.map.getLonLatFromPixel({x:a.left,y:a.bottom});c=this.map.getLonLatFromPixel({x:a.right,y:a.top});b=new OpenLayers.Bounds(b.lon,b.lat,c.lon,c.lat)}c=this.map.getZoom();this.map.zoomToExtent(b);if(c==this.map.getZoom()&&this.alwaysZoom==true)this.map.zoomTo(c+(this.out?-1:1))}else this.out?this.map.setCenter(this.map.getLonLatFromPixel(a),this.map.getZoom()-
1):this.map.setCenter(this.map.getLonLatFromPixel(a),this.map.getZoom()+1)},CLASS_NAME:"OpenLayers.Control.ZoomBox"});
OpenLayers.Control.DragPan=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,panned:false,interval:1,documentDrag:false,kinetic:null,enableKinetic:false,kineticInterval:10,draw:function(){if(this.enableKinetic){var a={interval:this.kineticInterval};if(typeof this.enableKinetic==="object")a=OpenLayers.Util.extend(a,this.enableKinetic);this.kinetic=new OpenLayers.Kinetic(a)}this.handler=new OpenLayers.Handler.Drag(this,{move:this.panMap,done:this.panMapDone,down:this.panMapStart},
{interval:this.interval,documentDrag:this.documentDrag})},panMapStart:function(){this.kinetic&&this.kinetic.begin()},panMap:function(a){this.kinetic&&this.kinetic.update(a);this.panned=true;this.map.pan(this.handler.last.x-a.x,this.handler.last.y-a.y,{dragging:true,animate:false})},panMapDone:function(a){if(this.panned){var b=null;if(this.kinetic)b=this.kinetic.end(a);this.map.pan(this.handler.last.x-a.x,this.handler.last.y-a.y,{dragging:!!b,animate:false});if(b){var c=this;this.kinetic.move(b,function(f,
d,e){c.map.pan(f,d,{dragging:!e,animate:false})})}this.panned=false}},CLASS_NAME:"OpenLayers.Control.DragPan"});
OpenLayers.Handler.MouseWheel=OpenLayers.Class(OpenLayers.Handler,{wheelListener:null,mousePosition:null,interval:0,delta:0,cumulative:true,initialize:function(){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.wheelListener=OpenLayers.Function.bindAsEventListener(this.onWheelEvent,this)},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments);this.wheelListener=null},onWheelEvent:function(a){if(this.map&&this.checkModifiers(a)){for(var b=false,c=false,f=false,
d=OpenLayers.Event.element(a);d!=null&&!f&&!b;){if(!b)try{var e=d.currentStyle?d.currentStyle.overflow:document.defaultView.getComputedStyle(d,null).getPropertyValue("overflow");b=e&&e=="auto"||e=="scroll"}catch(g){}if(!c){f=0;for(var h=this.map.layers.length;f<h;f++)if(d==this.map.layers[f].div||d==this.map.layers[f].pane){c=true;break}}f=d==this.map.div;d=d.parentNode}if(!b&&f){if(c){b=0;if(!a)a=window.event;if(a.wheelDelta){b=a.wheelDelta/120;if(window.opera&&window.opera.version()<9.2)b=-b}else if(a.detail)b=
-a.detail/3;this.delta+=b;if(this.interval){window.clearTimeout(this._timeoutId);this._timeoutId=window.setTimeout(OpenLayers.Function.bind(function(){this.wheelZoom(a)},this),this.interval)}else this.wheelZoom(a)}OpenLayers.Event.stop(a)}}},wheelZoom:function(a){var b=this.delta;this.delta=0;if(b){if(this.mousePosition)a.xy=this.mousePosition;if(!a.xy)a.xy=this.map.getPixelFromLonLat(this.map.getCenter());b<0?this.callback("down",[a,this.cumulative?b:-1]):this.callback("up",[a,this.cumulative?b:
1])}},mousemove:function(a){this.mousePosition=a.xy},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){var a=this.wheelListener;OpenLayers.Event.observe(window,"DOMMouseScroll",a);OpenLayers.Event.observe(window,"mousewheel",a);OpenLayers.Event.observe(document,"mousewheel",a);return true}else return false},deactivate:function(){if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){var a=this.wheelListener;OpenLayers.Event.stopObserving(window,"DOMMouseScroll",
a);OpenLayers.Event.stopObserving(window,"mousewheel",a);OpenLayers.Event.stopObserving(document,"mousewheel",a);return true}else return false},CLASS_NAME:"OpenLayers.Handler.MouseWheel"});
OpenLayers.Control.Navigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,documentDrag:false,zoomBox:null,zoomBoxEnabled:true,zoomWheelEnabled:true,mouseWheelOptions:null,handleRightClicks:false,zoomBoxKeyMask:OpenLayers.Handler.MOD_SHIFT,autoActivate:true,initialize:function(){this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate();this.dragPan&&this.dragPan.destroy();this.dragPan=
null;this.zoomBox&&this.zoomBox.destroy();this.zoomBox=null;this.pinchZoom&&this.pinchZoom.destroy();this.pinchZoom=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){this.dragPan.activate();this.zoomWheelEnabled&&this.handlers.wheel.activate();this.handlers.click.activate();this.zoomBoxEnabled&&this.zoomBox.activate();this.pinchZoom&&this.pinchZoom.activate();return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.pinchZoom&&
this.pinchZoom.deactivate();this.zoomBox.deactivate();this.dragPan.deactivate();this.handlers.click.deactivate();this.handlers.wheel.deactivate();return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},draw:function(){if(this.handleRightClicks)this.map.viewPortDiv.oncontextmenu=OpenLayers.Function.False;this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.defaultClick,dblclick:this.defaultDblClick,dblrightclick:this.defaultDblRightClick},{"double":true,stopDouble:true});
this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map,documentDrag:this.documentDrag},this.dragPanOptions));this.zoomBox=new OpenLayers.Control.ZoomBox({map:this.map,keyMask:this.zoomBoxKeyMask});this.dragPan.draw();this.zoomBox.draw();this.handlers.wheel=new OpenLayers.Handler.MouseWheel(this,{up:this.wheelUp,down:this.wheelDown},this.mouseWheelOptions);if(OpenLayers.Control.PinchZoom)this.pinchZoom=new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map:this.map},
this.pinchZoomOptions))},defaultClick:function(a){a.lastTouches&&a.lastTouches.length==2&&this.map.zoomOut()},defaultDblClick:function(a){this.map.setCenter(this.map.getLonLatFromViewPortPx(a.xy),this.map.zoom+1)},defaultDblRightClick:function(a){this.map.setCenter(this.map.getLonLatFromViewPortPx(a.xy),this.map.zoom-1)},wheelChange:function(a,b){var c=this.map.getZoom();b=this.map.getZoom()+Math.round(b);b=Math.max(b,0);b=Math.min(b,this.map.getNumZoomLevels());if(b!==c){var f=this.map.getSize();
c=f.w/2-a.xy.x;f=a.xy.y-f.h/2;var d=this.map.baseLayer.getResolutionForZoom(b);a=this.map.getLonLatFromPixel(a.xy);this.map.setCenter(new OpenLayers.LonLat(a.lon+c*d,a.lat+f*d),b)}},wheelUp:function(a,b){this.wheelChange(a,b||1)},wheelDown:function(a,b){this.wheelChange(a,b||-1)},disableZoomBox:function(){this.zoomBoxEnabled=false;this.zoomBox.deactivate()},enableZoomBox:function(){this.zoomBoxEnabled=true;this.active&&this.zoomBox.activate()},disableZoomWheel:function(){this.zoomWheelEnabled=false;
this.handlers.wheel.deactivate()},enableZoomWheel:function(){this.zoomWheelEnabled=true;this.active&&this.handlers.wheel.activate()},CLASS_NAME:"OpenLayers.Control.Navigation"});
OpenLayers.Layer.Image=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:true,url:null,extent:null,size:null,tile:null,aspectRatio:null,initialize:function(a,b,c,f,d){this.url=b;this.maxExtent=this.extent=c;this.size=f;OpenLayers.Layer.prototype.initialize.apply(this,[a,d]);this.aspectRatio=this.extent.getHeight()/this.size.h/(this.extent.getWidth()/this.size.w)},destroy:function(){if(this.tile){this.removeTileMonitoringHooks(this.tile);this.tile.destroy();this.tile=null}OpenLayers.Layer.prototype.destroy.apply(this,
arguments)},clone:function(a){if(a==null)a=new OpenLayers.Layer.Image(this.name,this.url,this.extent,this.size,this.getOptions());return a=OpenLayers.Layer.prototype.clone.apply(this,[a])},setMap:function(){if(this.options.maxResolution==null)this.options.maxResolution=this.aspectRatio*this.extent.getWidth()/this.size.w;OpenLayers.Layer.prototype.setMap.apply(this,arguments)},moveTo:function(a,b){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var c=this.tile==null;if(b||c){this.setTileSize();
var f=this.map.getLayerPxFromLonLat({lon:this.extent.left,lat:this.extent.top});if(c){this.tile=new OpenLayers.Tile.Image(this,f,this.extent,null,this.tileSize);this.addTileMonitoringHooks(this.tile)}else{this.tile.size=this.tileSize.clone();this.tile.position=f.clone()}this.tile.draw()}},setTileSize:function(){var a=this.extent.getWidth()/this.map.getResolution(),b=this.extent.getHeight()/this.map.getResolution();this.tileSize=new OpenLayers.Size(a,b)},addTileMonitoringHooks:function(a){a.onLoadStart=
function(){this.events.triggerEvent("loadstart")};a.events.register("loadstart",this,a.onLoadStart);a.onLoadEnd=function(){this.events.triggerEvent("loadend")};a.events.register("loadend",this,a.onLoadEnd);a.events.register("unload",this,a.onLoadEnd)},removeTileMonitoringHooks:function(a){a.unload();a.events.un({loadstart:a.onLoadStart,loadend:a.onLoadEnd,unload:a.onLoadEnd,scope:this})},setUrl:function(a){this.url=a;this.tile.draw()},getURL:function(){return this.url},CLASS_NAME:"OpenLayers.Layer.Image"});
OpenLayers.Handler.Pinch=OpenLayers.Class(OpenLayers.Handler,{started:false,stopDown:false,pinching:false,last:null,start:null,touchstart:function(a){var b=true;this.pinching=false;if(OpenLayers.Event.isMultiTouch(a)){this.started=true;this.last=this.start={distance:this.getDistance(a.touches),delta:0,scale:1};this.callback("start",[a,this.start]);b=!this.stopDown}else{this.started=false;this.last=this.start=null}OpenLayers.Event.stop(a);return b},touchmove:function(a){if(this.started&&OpenLayers.Event.isMultiTouch(a)){this.pinching=
true;var b=this.getPinchData(a);this.callback("move",[a,b]);this.last=b;OpenLayers.Event.stop(a)}return true},touchend:function(a){if(this.started){this.pinching=this.started=false;this.callback("done",[a,this.start,this.last]);this.last=this.start=null}return true},activate:function(){var a=false;if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.pinching=false;a=true}return a},deactivate:function(){var a=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.pinching=
this.started=false;this.last=this.start=null;a=true}return a},getDistance:function(a){var b=a[0];a=a[1];return Math.sqrt(Math.pow(b.clientX-a.clientX,2)+Math.pow(b.clientY-a.clientY,2))},getPinchData:function(a){a=this.getDistance(a.touches);return{distance:a,delta:this.last.distance-a,scale:a/this.start.distance}},CLASS_NAME:"OpenLayers.Handler.Pinch"});
OpenLayers.Events.buttonclick=OpenLayers.Class({target:null,events:["mousedown","mouseup","click","dblclick","touchstart","touchmove","touchend","keydown"],startRegEx:/^mousedown|touchstart$/,cancelRegEx:/^touchmove$/,completeRegEx:/^mouseup|touchend$/,initialize:function(a){this.target=a;for(a=this.events.length-1;a>=0;--a)this.target.register(this.events[a],this,this.buttonClick,{extension:true})},destroy:function(){for(var a=this.events.length-1;a>=0;--a)this.target.unregister(this.events[a],this,
this.buttonClick);delete this.target},getPressedButton:function(a){var b=3,c;do{if(OpenLayers.Element.hasClass(a,"olButton")){c=a;break}a=a.parentNode}while(--b>0&&a);return c},buttonClick:function(a){var b=true,c=OpenLayers.Event.element(a);if(c&&(OpenLayers.Event.isLeftClick(a)||!~a.type.indexOf("mouse")))if(c=this.getPressedButton(c)){if(a.type==="keydown")switch(a.keyCode){case OpenLayers.Event.KEY_RETURN:case OpenLayers.Event.KEY_SPACE:this.target.triggerEvent("buttonclick",{buttonElement:c});
OpenLayers.Event.stop(a);b=false;break}else if(this.startEvt){if(this.completeRegEx.test(a.type)){b=OpenLayers.Util.pagePosition(c);this.target.triggerEvent("buttonclick",{buttonElement:c,buttonXY:{x:this.startEvt.clientX-b[0],y:this.startEvt.clientY-b[1]}})}this.cancelRegEx.test(a.type)&&delete this.startEvt;OpenLayers.Event.stop(a);b=false}if(this.startRegEx.test(a.type)){this.startEvt=a;OpenLayers.Event.stop(a);b=false}}else delete this.startEvt;return b}});
OpenLayers.Control.PinchZoom=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,containerCenter:null,pinchOrigin:null,currentCenter:null,autoActivate:true,initialize:function(){OpenLayers.Control.prototype.initialize.apply(this,arguments);this.handler=new OpenLayers.Handler.Pinch(this,{start:this.pinchStart,move:this.pinchMove,done:this.pinchDone},this.handlerOptions)},activate:function(){var a=OpenLayers.Control.prototype.activate.apply(this,arguments);if(a){this.map.events.on({moveend:this.updateContainerCenter,
scope:this});this.updateContainerCenter()}return a},deactivate:function(){var a=OpenLayers.Control.prototype.deactivate.apply(this,arguments);this.map&&this.map.events&&this.map.events.un({moveend:this.updateContainerCenter,scope:this});return a},updateContainerCenter:function(){var a=this.map.layerContainerDiv;this.containerCenter={x:parseInt(a.style.left,10)+50,y:parseInt(a.style.top,10)+50}},pinchStart:function(a){this.currentCenter=this.pinchOrigin=a.xy},pinchMove:function(a,b){b=b.scale;var c=
this.containerCenter,f=this.pinchOrigin;a=a.xy;var d=Math.round(a.x-f.x+(b-1)*(c.x-f.x));c=Math.round(a.y-f.y+(b-1)*(c.y-f.y));this.applyTransform("translate("+d+"px, "+c+"px) scale("+b+")");this.currentCenter=a},applyTransform:function(a){var b=this.map.layerContainerDiv.style;b["-webkit-transform"]=a;b["-moz-transform"]=a},pinchDone:function(a,b,c){this.applyTransform("");a=this.map.getZoomForResolution(this.map.getResolution()/c.scale,true);if(a!==this.map.getZoom()||!this.currentCenter.equals(this.pinchOrigin)){b=
this.map.getResolutionForZoom(a);c=this.map.getLonLatFromPixel(this.pinchOrigin);var f=this.currentCenter,d=this.map.getSize();c.lon+=b*(d.w/2-f.x);c.lat-=b*(d.h/2-f.y);this.map.div.clientWidth=this.map.div.clientWidth;this.map.setCenter(c,a)}},CLASS_NAME:"OpenLayers.Control.PinchZoom"});
OpenLayers.Control.TouchNavigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,clickHandlerOptions:null,documentDrag:false,autoActivate:true,initialize:function(){this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate();this.dragPan&&this.dragPan.destroy();this.dragPan=null;if(this.pinchZoom){this.pinchZoom.destroy();delete this.pinchZoom}OpenLayers.Control.prototype.destroy.apply(this,
arguments)},activate:function(){if(OpenLayers.Control.prototype.activate.apply(this,arguments)){this.dragPan.activate();this.handlers.click.activate();this.pinchZoom.activate();return true}return false},deactivate:function(){if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){this.dragPan.deactivate();this.handlers.click.deactivate();this.pinchZoom.deactivate();return true}return false},draw:function(){var a={click:this.defaultClick,dblclick:this.defaultDblClick},b=OpenLayers.Util.extend({"double":true,
stopDouble:true,pixelTolerance:2},this.clickHandlerOptions);this.handlers.click=new OpenLayers.Handler.Click(this,a,b);this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map,documentDrag:this.documentDrag},this.dragPanOptions));this.dragPan.draw();this.pinchZoom=new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map:this.map},this.pinchZoomOptions))},defaultClick:function(a){a.lastTouches&&a.lastTouches.length==2&&this.map.zoomOut()},defaultDblClick:function(a){this.map.setCenter(this.map.getLonLatFromViewPortPx(a.xy),
this.map.zoom+1)},CLASS_NAME:"OpenLayers.Control.TouchNavigation"});
OpenLayers.Control.OverviewMap=OpenLayers.Class(OpenLayers.Control,{element:null,ovmap:null,size:{w:180,h:90},layers:null,minRectSize:15,minRectDisplayClass:"RectReplacement",minRatio:8,maxRatio:32,mapOptions:null,autoPan:false,handlers:null,resolutionFactor:1,maximized:false,initialize:function(a){this.layers=[];this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,[a])},destroy:function(){if(this.mapDiv){this.handlers.click&&this.handlers.click.destroy();this.handlers.drag&&this.handlers.drag.destroy();
this.ovmap&&this.ovmap.viewPortDiv.removeChild(this.extentRectangle);this.extentRectangle=null;if(this.rectEvents){this.rectEvents.destroy();this.rectEvents=null}if(this.ovmap){this.ovmap.destroy();this.ovmap=null}this.element.removeChild(this.mapDiv);this.mapDiv=null;this.div.removeChild(this.element);this.element=null;if(this.maximizeDiv){this.div.removeChild(this.maximizeDiv);this.maximizeDiv=null}if(this.minimizeDiv){this.div.removeChild(this.minimizeDiv);this.minimizeDiv=null}this.map.events.un({buttonclick:this.onButtonClick,
moveend:this.update,changebaselayer:this.baseLayerDraw,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments)}},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(this.layers.length===0)if(this.map.baseLayer)this.layers=[this.map.baseLayer.clone()];else{this.map.events.register("changebaselayer",this,this.baseLayerDraw);return this.div}this.element=document.createElement("div");this.element.className=this.displayClass+"Element";this.element.style.display="none";
this.mapDiv=document.createElement("div");this.mapDiv.style.width=this.size.w+"px";this.mapDiv.style.height=this.size.h+"px";this.mapDiv.style.position="relative";this.mapDiv.style.overflow="hidden";this.mapDiv.id=OpenLayers.Util.createUniqueID("overviewMap");this.extentRectangle=document.createElement("div");this.extentRectangle.style.position="absolute";this.extentRectangle.style.zIndex=1E3;this.extentRectangle.className=this.displayClass+"ExtentRectangle";this.element.appendChild(this.mapDiv);
this.div.appendChild(this.element);if(this.outsideViewport)this.element.style.display="";else{this.div.className+=" "+this.displayClass+"Container";var a=OpenLayers.Util.getImageLocation("layer-switcher-maximize.png");this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv(this.displayClass+"MaximizeButton",null,null,a,"absolute");this.maximizeDiv.style.display="none";this.maximizeDiv.className=this.displayClass+"MaximizeButton olButton";this.div.appendChild(this.maximizeDiv);a=OpenLayers.Util.getImageLocation("layer-switcher-minimize.png");
this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_minimizeDiv",null,null,a,"absolute");this.minimizeDiv.style.display="none";this.minimizeDiv.className=this.displayClass+"MinimizeButton olButton";this.div.appendChild(this.minimizeDiv);this.minimizeControl()}this.map.getExtent()&&this.update();this.map.events.on({buttonclick:this.onButtonClick,moveend:this.update,scope:this});this.maximized&&this.maximizeControl();return this.div},baseLayerDraw:function(){this.draw();this.map.events.unregister("changebaselayer",
this,this.baseLayerDraw)},rectDrag:function(a){var b=this.handlers.drag.last.x-a.x,c=this.handlers.drag.last.y-a.y;if(b!=0||c!=0){var f=this.rectPxBounds.top,d=this.rectPxBounds.left;a=Math.abs(this.rectPxBounds.getHeight());var e=this.rectPxBounds.getWidth();c=Math.max(0,f-c);c=Math.min(c,this.ovmap.size.h-this.hComp-a);b=Math.max(0,d-b);b=Math.min(b,this.ovmap.size.w-this.wComp-e);this.setRectPxBounds(new OpenLayers.Bounds(b,c+a,b+e,c))}},mapDivClick:function(a){var b=this.rectPxBounds.getCenterPixel(),
c=a.xy.x-b.x,f=a.xy.y-b.y,d=this.rectPxBounds.top,e=this.rectPxBounds.left;a=Math.abs(this.rectPxBounds.getHeight());b=this.rectPxBounds.getWidth();f=Math.max(0,d+f);f=Math.min(f,this.ovmap.size.h-a);c=Math.max(0,e+c);c=Math.min(c,this.ovmap.size.w-b);this.setRectPxBounds(new OpenLayers.Bounds(c,f+a,c+b,f));this.updateMapToRect()},onButtonClick:function(a){if(a.buttonElement===this.minimizeDiv)this.minimizeControl();else a.buttonElement===this.maximizeDiv&&this.maximizeControl()},maximizeControl:function(a){this.element.style.display=
"";this.showToggle(false);a!=null&&OpenLayers.Event.stop(a)},minimizeControl:function(a){this.element.style.display="none";this.showToggle(true);a!=null&&OpenLayers.Event.stop(a)},showToggle:function(a){this.maximizeDiv.style.display=a?"":"none";this.minimizeDiv.style.display=a?"none":""},update:function(){this.ovmap==null&&this.createMap();if(this.autoPan||!this.isSuitableOverview())this.updateOverview();this.updateRectToMap()},isSuitableOverview:function(){var a=this.map.getExtent(),b=this.map.maxExtent;
a=new OpenLayers.Bounds(Math.max(a.left,b.left),Math.max(a.bottom,b.bottom),Math.min(a.right,b.right),Math.min(a.top,b.top));if(this.ovmap.getProjection()!=this.map.getProjection())a=a.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject());b=this.ovmap.getResolution()/this.map.getResolution();return b>this.minRatio&&b<=this.maxRatio&&this.ovmap.getExtent().containsBounds(a)},updateOverview:function(){var a=this.map.getResolution(),b=this.ovmap.getResolution(),c=b/a;if(c>this.maxRatio)b=
this.minRatio*a;else if(c<=this.minRatio)b=this.maxRatio*a;if(this.ovmap.getProjection()!=this.map.getProjection()){a=this.map.center.clone();a.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject())}else a=this.map.center;this.ovmap.setCenter(a,this.ovmap.getZoomForResolution(b*this.resolutionFactor));this.updateRectToMap()},createMap:function(){var a=OpenLayers.Util.extend({controls:[],maxResolution:"auto",fallThrough:false},this.mapOptions);this.ovmap=new OpenLayers.Map(this.mapDiv,
a);this.ovmap.viewPortDiv.appendChild(this.extentRectangle);OpenLayers.Event.stopObserving(window,"unload",this.ovmap.unloadDestroy);this.ovmap.addLayers(this.layers);this.ovmap.zoomToMaxExtent();this.wComp=(this.wComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-left-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-right-width")))?this.wComp:2;this.hComp=(this.hComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-top-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,
"border-bottom-width")))?this.hComp:2;this.handlers.drag=new OpenLayers.Handler.Drag(this,{move:this.rectDrag,done:this.updateMapToRect},{map:this.ovmap});this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.mapDivClick},{single:true,"double":false,stopSingle:true,stopDouble:true,pixelTolerance:1,map:this.ovmap});this.handlers.click.activate();this.rectEvents=new OpenLayers.Events(this,this.extentRectangle,null,true);this.rectEvents.register("mouseover",this,function(){!this.handlers.drag.active&&
!this.map.dragging&&this.handlers.drag.activate()});this.rectEvents.register("mouseout",this,function(){this.handlers.drag.dragging||this.handlers.drag.deactivate()});if(this.ovmap.getProjection()!=this.map.getProjection()){a=this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units;var b=this.ovmap.getProjectionObject().getUnits()||this.ovmap.units||this.ovmap.baseLayer.units;this.resolutionFactor=a&&b?OpenLayers.INCHES_PER_UNIT[a]/OpenLayers.INCHES_PER_UNIT[b]:1}},updateRectToMap:function(){var a=
this.getRectBoundsFromMapBounds(this.ovmap.getProjection()!=this.map.getProjection()?this.map.getExtent().transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject()):this.map.getExtent());a&&this.setRectPxBounds(a)},updateMapToRect:function(){var a=this.getMapBoundsFromRectBounds(this.rectPxBounds);if(this.ovmap.getProjection()!=this.map.getProjection())a=a.transform(this.ovmap.getProjectionObject(),this.map.getProjectionObject());this.map.panTo(a.getCenterLonLat())},setRectPxBounds:function(a){var b=
Math.max(a.top,0),c=Math.max(a.left,0),f=Math.min(a.top+Math.abs(a.getHeight()),this.ovmap.size.h-this.hComp);a=Math.min(a.left+a.getWidth(),this.ovmap.size.w-this.wComp);var d=Math.max(a-c,0),e=Math.max(f-b,0);if(d<this.minRectSize||e<this.minRectSize){this.extentRectangle.className=this.displayClass+this.minRectDisplayClass;d=c+d/2-this.minRectSize/2;this.extentRectangle.style.top=Math.round(b+e/2-this.minRectSize/2)+"px";this.extentRectangle.style.left=Math.round(d)+"px";this.extentRectangle.style.height=
this.minRectSize+"px";this.extentRectangle.style.width=this.minRectSize+"px"}else{this.extentRectangle.className=this.displayClass+"ExtentRectangle";this.extentRectangle.style.top=Math.round(b)+"px";this.extentRectangle.style.left=Math.round(c)+"px";this.extentRectangle.style.height=Math.round(e)+"px";this.extentRectangle.style.width=Math.round(d)+"px"}this.rectPxBounds=new OpenLayers.Bounds(Math.round(c),Math.round(f),Math.round(a),Math.round(b))},getRectBoundsFromMapBounds:function(a){var b=this.getOverviewPxFromLonLat({lon:a.left,
lat:a.bottom});a=this.getOverviewPxFromLonLat({lon:a.right,lat:a.top});var c=null;if(b&&a)c=new OpenLayers.Bounds(b.x,b.y,a.x,a.y);return c},getMapBoundsFromRectBounds:function(a){var b=this.getLonLatFromOverviewPx({x:a.left,y:a.bottom});a=this.getLonLatFromOverviewPx({x:a.right,y:a.top});return new OpenLayers.Bounds(b.lon,b.lat,a.lon,a.lat)},getLonLatFromOverviewPx:function(a){var b=this.ovmap.size,c=this.ovmap.getResolution(),f=this.ovmap.getExtent().getCenterLonLat();return{lon:f.lon+(a.x-b.w/
2)*c,lat:f.lat-(a.y-b.h/2)*c}},getOverviewPxFromLonLat:function(a){var b=this.ovmap.getResolution(),c=this.ovmap.getExtent();if(c)return{x:Math.round(1/b*(a.lon-c.left)),y:Math.round(1/b*(c.top-a.lat))}},CLASS_NAME:"OpenLayers.Control.OverviewMap"});
OpenLayers.Control.Zoom=OpenLayers.Class(OpenLayers.Control,{zoomInText:"+",zoomInId:"olZoomInLink",zoomOutText:"-",zoomOutId:"olZoomOutLink",draw:function(){var a=OpenLayers.Control.prototype.draw.apply(this),b=this.getOrCreateLinks(a),c=b.zoomIn;b=b.zoomOut;var f=this.map.events;if(b.parentNode!==a){f=this.events;f.attachToElement(b.parentNode)}f.register("buttonclick",this,this.onZoomClick);this.zoomInLink=c;this.zoomOutLink=b;return a},getOrCreateLinks:function(a){var b=document.getElementById(this.zoomInId),
c=document.getElementById(this.zoomOutId);if(!b){b=document.createElement("a");b.href="#zoomIn";b.appendChild(document.createTextNode(this.zoomInText));b.className="olControlZoomIn";a.appendChild(b)}OpenLayers.Element.addClass(b,"olButton");if(!c){c=document.createElement("a");c.href="#zoomOut";c.appendChild(document.createTextNode(this.zoomOutText));c.className="olControlZoomOut";a.appendChild(c)}OpenLayers.Element.addClass(c,"olButton");return{zoomIn:b,zoomOut:c}},onZoomClick:function(a){a=a.buttonElement;
if(a===this.zoomInLink)this.map.zoomIn();else a===this.zoomOutLink&&this.map.zoomOut()},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onZoomClick);delete this.zoomInLink;delete this.zoomOutLink;OpenLayers.Control.prototype.destroy.apply(this)},CLASS_NAME:"OpenLayers.Control.Zoom"});OpenLayers.ProxyHost="";
OpenLayers.Request={DEFAULT_CONFIG:{method:"GET",url:window.location.href,async:true,user:undefined,password:undefined,params:null,proxy:OpenLayers.ProxyHost,headers:{},data:null,callback:function(){},success:null,failure:null,scope:null},URL_SPLIT_REGEX:/([^:]*:)\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/,events:new OpenLayers.Events(this),makeSameOrigin:function(a,b){var c=a.indexOf("http")!==0,f=!c&&a.match(this.URL_SPLIT_REGEX);if(f){var d=window.location;c=f[1]==d.protocol&&f[3]==d.hostname;
f=f[4];d=d.port;if(f!=80&&f!=""||d!="80"&&d!="")c=c&&f==d}if(!c)if(b)a=typeof b=="function"?b(a):b+encodeURIComponent(a);else OpenLayers.Console.warn(OpenLayers.i18n("proxyNeeded"),{url:a});return a},issue:function(a){var b=OpenLayers.Util.extend(this.DEFAULT_CONFIG,{proxy:OpenLayers.ProxyHost});a=OpenLayers.Util.applyDefaults(a,b);b=false;var c;for(c in a.headers)if(a.headers.hasOwnProperty(c))if(c.toLowerCase()==="x-requested-with")b=true;if(b===false)a.headers["X-Requested-With"]="XMLHttpRequest";
var f=new OpenLayers.Request.XMLHttpRequest,d=OpenLayers.Util.urlAppend(a.url,OpenLayers.Util.getParameterString(a.params||{}));d=OpenLayers.Request.makeSameOrigin(d,a.proxy);f.open(a.method,d,a.async,a.user,a.password);for(var e in a.headers)f.setRequestHeader(e,a.headers[e]);var g=this.events,h=this;f.onreadystatechange=function(){f.readyState==OpenLayers.Request.XMLHttpRequest.DONE&&g.triggerEvent("complete",{request:f,config:a,requestUrl:d})!==false&&h.runCallbacks({request:f,config:a,requestUrl:d})};
a.async===false?f.send(a.data):window.setTimeout(function(){f.readyState!==0&&f.send(a.data)},0);return f},runCallbacks:function(a){var b=a.request,c=a.config,f=c.scope?OpenLayers.Function.bind(c.callback,c.scope):c.callback,d;if(c.success)d=c.scope?OpenLayers.Function.bind(c.success,c.scope):c.success;var e;if(c.failure)e=c.scope?OpenLayers.Function.bind(c.failure,c.scope):c.failure;if(OpenLayers.Util.createUrlObject(c.url).protocol=="file:"&&b.responseText)b.status=200;f(b);if(!b.status||b.status>=
200&&b.status<300){this.events.triggerEvent("success",a);d&&d(b)}if(b.status&&(b.status<200||b.status>=300)){this.events.triggerEvent("failure",a);e&&e(b)}},GET:function(a){a=OpenLayers.Util.extend(a,{method:"GET"});return OpenLayers.Request.issue(a)},POST:function(a){a=OpenLayers.Util.extend(a,{method:"POST"});a.headers=a.headers?a.headers:{};"CONTENT-TYPE"in OpenLayers.Util.upperCaseObject(a.headers)||(a.headers["Content-Type"]="application/xml");return OpenLayers.Request.issue(a)},PUT:function(a){a=
OpenLayers.Util.extend(a,{method:"PUT"});a.headers=a.headers?a.headers:{};"CONTENT-TYPE"in OpenLayers.Util.upperCaseObject(a.headers)||(a.headers["Content-Type"]="application/xml");return OpenLayers.Request.issue(a)},DELETE:function(a){a=OpenLayers.Util.extend(a,{method:"DELETE"});return OpenLayers.Request.issue(a)},HEAD:function(a){a=OpenLayers.Util.extend(a,{method:"HEAD"});return OpenLayers.Request.issue(a)},OPTIONS:function(a){a=OpenLayers.Util.extend(a,{method:"OPTIONS"});return OpenLayers.Request.issue(a)}};
(function(){function a(){this._object=h&&!l?new h:new window.ActiveXObject("Microsoft.XMLHTTP");this._listeners=[]}function b(){return new a}function c(k){k._object.send(k._data);if(i&&!k._async){k.readyState=b.OPENED;for(e(k);k.readyState<b.DONE;){k.readyState++;f(k);if(k._aborted)return}}}function f(k){b.onreadystatechange&&b.onreadystatechange.apply(k);k.dispatchEvent({type:"readystatechange",bubbles:false,cancelable:false,timeStamp:new Date+0})}function d(k){var m=k.responseXML,n=k.responseText;
if(j&&n&&m&&!m.documentElement&&k.getResponseHeader("Content-Type").match(/[^\/]+\/[^\+]+\+xml/)){m=new window.ActiveXObject("Microsoft.XMLDOM");m.async=false;m.validateOnParse=false;m.loadXML(n)}if(m)if(j&&m.parseError!=0||!m.documentElement||m.documentElement&&m.documentElement.tagName=="parsererror")return null;return m}function e(k){try{k.responseText=k._object.responseText}catch(m){}try{k.responseXML=d(k._object)}catch(n){}try{k.status=k._object.status}catch(q){}try{k.statusText=k._object.statusText}catch(p){}}
function g(k){k._object.onreadystatechange=new window.Function}var h=window.XMLHttpRequest,i=!!window.controllers,j=window.document.all&&!window.opera,l=j&&window.navigator.userAgent.match(/MSIE 7.0/);b.prototype=a.prototype;if(i&&h.wrapped)b.wrapped=h.wrapped;b.UNSENT=0;b.OPENED=1;b.HEADERS_RECEIVED=2;b.LOADING=3;b.DONE=4;b.prototype.readyState=b.UNSENT;b.prototype.responseText="";b.prototype.responseXML=null;b.prototype.status=0;b.prototype.statusText="";b.prototype.priority="NORMAL";b.prototype.onreadystatechange=
null;b.onreadystatechange=null;b.onopen=null;b.onsend=null;b.onabort=null;b.prototype.open=function(k,m,n,q,p){delete this._headers;if(arguments.length<3)n=true;this._async=n;var o=this,t=this.readyState,u;if(j&&n){u=function(){if(t!=b.DONE){g(o);o.abort()}};window.attachEvent("onunload",u)}b.onopen&&b.onopen.apply(this,arguments);if(arguments.length>4)this._object.open(k,m,n,q,p);else arguments.length>3?this._object.open(k,m,n,q):this._object.open(k,m,n);this.readyState=b.OPENED;f(this);this._object.onreadystatechange=
function(){if(!(i&&!n)){o.readyState=o._object.readyState;e(o);if(o._aborted)o.readyState=b.UNSENT;else{if(o.readyState==b.DONE){delete o._data;g(o);j&&n&&window.detachEvent("onunload",u)}t!=o.readyState&&f(o);t=o.readyState}}}};b.prototype.send=function(k){b.onsend&&b.onsend.apply(this,arguments);arguments.length||(k=null);if(k&&k.nodeType){k=window.XMLSerializer?(new window.XMLSerializer).serializeToString(k):k.xml;this._headers["Content-Type"]||this._object.setRequestHeader("Content-Type","application/xml")}this._data=
k;c(this)};b.prototype.abort=function(){b.onabort&&b.onabort.apply(this,arguments);if(this.readyState>b.UNSENT)this._aborted=true;this._object.abort();g(this);this.readyState=b.UNSENT;delete this._data};b.prototype.getAllResponseHeaders=function(){return this._object.getAllResponseHeaders()};b.prototype.getResponseHeader=function(k){return this._object.getResponseHeader(k)};b.prototype.setRequestHeader=function(k,m){if(!this._headers)this._headers={};this._headers[k]=m;return this._object.setRequestHeader(k,
m)};b.prototype.addEventListener=function(k,m,n){for(var q=0,p;p=this._listeners[q];q++)if(p[0]==k&&p[1]==m&&p[2]==n)return;this._listeners.push([k,m,n])};b.prototype.removeEventListener=function(k,m,n){for(var q=0,p;p=this._listeners[q];q++)if(p[0]==k&&p[1]==m&&p[2]==n)break;p&&this._listeners.splice(q,1)};b.prototype.dispatchEvent=function(k){k={type:k.type,target:this,currentTarget:this,eventPhase:2,bubbles:k.bubbles,cancelable:k.cancelable,timeStamp:k.timeStamp,stopPropagation:function(){},preventDefault:function(){},
initEvent:function(){}};if(k.type=="readystatechange"&&this.onreadystatechange)(this.onreadystatechange.handleEvent||this.onreadystatechange).apply(this,[k]);for(var m=0,n;n=this._listeners[m];m++)if(n[0]==k.type&&!n[2])(n[1].handleEvent||n[1]).apply(this,[k])};b.prototype.toString=function(){return"[object XMLHttpRequest]"};b.toString=function(){return"[XMLHttpRequest]"};if(!window.Function.prototype.apply)window.Function.prototype.apply=function(k,m){m||(m=[]);k.__func=this;k.__func(m[0],m[1],m[2],
m[3],m[4]);delete k.__func};OpenLayers.Request.XMLHttpRequest=b})();
OpenLayers.Handler.Keyboard=OpenLayers.Class(OpenLayers.Handler,{KEY_EVENTS:["keydown","keyup"],eventListener:null,observeElement:null,initialize:function(){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.eventListener=OpenLayers.Function.bindAsEventListener(this.handleKeyEvent,this)},destroy:function(){this.deactivate();this.eventListener=null;OpenLayers.Handler.prototype.destroy.apply(this,arguments)},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.observeElement=
this.observeElement||document;for(var a=0,b=this.KEY_EVENTS.length;a<b;a++)OpenLayers.Event.observe(this.observeElement,this.KEY_EVENTS[a],this.eventListener);return true}else return false},deactivate:function(){var a=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){a=0;for(var b=this.KEY_EVENTS.length;a<b;a++)OpenLayers.Event.stopObserving(this.observeElement,this.KEY_EVENTS[a],this.eventListener);a=true}return a},handleKeyEvent:function(a){this.checkModifiers(a)&&this.callback(a.type,
[a])},CLASS_NAME:"OpenLayers.Handler.Keyboard"});
OpenLayers.Control.KeyboardDefaults=OpenLayers.Class(OpenLayers.Control,{autoActivate:true,slideFactor:75,observeElement:null,draw:function(){this.handler=new OpenLayers.Handler.Keyboard(this,{keydown:this.defaultKeyPress},{observeElement:this.observeElement||document})},defaultKeyPress:function(a){var b,c=true;switch(a.keyCode){case OpenLayers.Event.KEY_LEFT:this.map.pan(-this.slideFactor,0);break;case OpenLayers.Event.KEY_RIGHT:this.map.pan(this.slideFactor,0);break;case OpenLayers.Event.KEY_UP:this.map.pan(0,
-this.slideFactor);break;case OpenLayers.Event.KEY_DOWN:this.map.pan(0,this.slideFactor);break;case 33:b=this.map.getSize();this.map.pan(0,-0.75*b.h);break;case 34:b=this.map.getSize();this.map.pan(0,0.75*b.h);break;case 35:b=this.map.getSize();this.map.pan(0.75*b.w,0);break;case 36:b=this.map.getSize();this.map.pan(-0.75*b.w,0);break;case 43:case 61:case 187:case 107:this.map.zoomIn();break;case 45:case 109:case 189:case 95:this.map.zoomOut();break;default:c=false}c&&OpenLayers.Event.stop(a)},CLASS_NAME:"OpenLayers.Control.KeyboardDefaults"});
OpenLayers.Layer.Zoomify=OpenLayers.Class(OpenLayers.Layer.Grid,{size:null,isBaseLayer:true,standardTileSize:256,tileOriginCorner:"tl",numberOfTiers:0,tileCountUpToTier:null,tierSizeInTiles:null,tierImageSize:null,initialize:function(a,b,c,f){this.initializeZoomify(c);OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a,b,c,{},f])},initializeZoomify:function(a){a=a.clone();var b=new OpenLayers.Size(Math.ceil(a.w/this.standardTileSize),Math.ceil(a.h/this.standardTileSize));this.tierSizeInTiles=
[b];for(this.tierImageSize=[a];a.w>this.standardTileSize||a.h>this.standardTileSize;){a=new OpenLayers.Size(Math.floor(a.w/2),Math.floor(a.h/2));b=new OpenLayers.Size(Math.ceil(a.w/this.standardTileSize),Math.ceil(a.h/this.standardTileSize));this.tierSizeInTiles.push(b);this.tierImageSize.push(a)}this.tierSizeInTiles.reverse();this.tierImageSize.reverse();this.numberOfTiers=this.tierSizeInTiles.length;this.tileCountUpToTier=[0];for(a=1;a<this.numberOfTiers;a++)this.tileCountUpToTier.push(this.tierSizeInTiles[a-
1].w*this.tierSizeInTiles[a-1].h+this.tileCountUpToTier[a-1])},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments);this.tileCountUpToTier.length=0;this.tierSizeInTiles.length=0;this.tierImageSize.length=0},clone:function(a){if(a==null)a=new OpenLayers.Layer.Zoomify(this.name,this.url,this.size,this.options);return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},getURL:function(a){a=this.adjustBounds(a);var b=this.map.getResolution(),c=Math.round((a.left-this.tileOrigin.lon)/
(b*this.tileSize.w));a=Math.round((this.tileOrigin.lat-a.top)/(b*this.tileSize.h));b=this.map.getZoom();c="TileGroup"+Math.floor((c+a*this.tierSizeInTiles[b].w+this.tileCountUpToTier[b])/256)+"/"+b+"-"+c+"-"+a+".jpg";a=this.url;if(OpenLayers.Util.isArray(a))a=this.selectUrl(c,a);return a+c},getImageSize:function(){if(arguments.length>0){var a=this.adjustBounds(arguments[0]),b=this.map.getResolution(),c=Math.round((a.left-this.tileOrigin.lon)/(b*this.tileSize.w));a=Math.round((this.tileOrigin.lat-
a.top)/(b*this.tileSize.h));b=this.map.getZoom();var f=this.standardTileSize,d=this.standardTileSize;if(c==this.tierSizeInTiles[b].w-1){f=this.tierImageSize[b].w%this.standardTileSize;if(f==0)f=this.standardTileSize}if(a==this.tierSizeInTiles[b].h-1){d=this.tierImageSize[b].h%this.standardTileSize;if(d==0)d=this.standardTileSize}if(c==this.tierSizeInTiles[b].w)f=Math.ceil(this.size.w/Math.pow(2,this.numberOfTiers-1-b)-this.tierImageSize[b].w);if(a==this.tierSizeInTiles[b].h)d=Math.ceil(this.size.h/
Math.pow(2,this.numberOfTiers-1-b)-this.tierImageSize[b].h);return new OpenLayers.Size(f,d)}else return this.tileSize},setMap:function(){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments);this.tileOrigin=new OpenLayers.LonLat(this.map.maxExtent.left,this.map.maxExtent.top)},calculateGridLayout:function(a,b,c){var f=c*this.tileSize.w;c=c*this.tileSize.h;var d=a.left-b.lon,e=Math.floor(d/f)-this.buffer;d=-(d/f-e)*this.tileSize.w;e=b.lon+e*f;a=b.lat-a.top+c;var g=Math.floor(a/c)-this.buffer;
return{tilelon:f,tilelat:c,tileoffsetlon:e,tileoffsetlat:b.lat-c*g,tileoffsetx:d,tileoffsety:(g-a/c)*this.tileSize.h}},CLASS_NAME:"OpenLayers.Layer.Zoomify"});(function(){var a=this.SpriteLoader={};a.preload=function(b,c){if(typeof b==="string")b=[b];var f={callback:c,numLoaded:0,numImages:b.length,images:[]};for(c=0;c<b.length;c+=1)a.load(b[c],f)};a.load=function(b,c){var f=new Image;c.images.push(f);f.onload=function(){c.numLoaded+=1;c.numLoaded===c.numImages&&c.callback(c.images)};f.src=b}})();
(function(a,b){var c=b.SpriteSpin={},f=c.api={};c.modules={};c.behaviors={};c.disableSelection=function(d){d.attr("unselectable","on").css({"-moz-user-select":"none","-khtml-user-select":"none","-webkit-user-select":"none","user-select":"none"}).on("selectstart",false);return d};c.updateInput=function(d,e){if(d.touches===undefined&&d.originalEvent!==undefined)d.touches=d.originalEvent.touches;e.oldX=e.currentX;e.oldY=e.currentY;if(d.touches!==undefined&&d.touches.length>0){e.currentX=d.touches[0].clientX;
e.currentY=d.touches[0].clientY}else{e.currentX=d.clientX;e.currentY=d.clientY}if(e.startX===undefined||e.startY===undefined){e.startX=e.currentX;e.startY=e.currentY;e.clickframe=e.frame}if(e.oldX===undefined||e.oldY===undefined){e.oldX=e.currentX;e.oldY=e.currentY}e.dX=e.currentX-e.startX;e.dY=e.currentY-e.startY;e.dW=e.dX*e.dragDirX+e.dY*e.dragDirY;e.ddX=e.currentX-e.oldX;e.ddY=e.currentY-e.oldY;e.ddW=e.ddX*e.dragDirX+e.ddY*e.dragDirY;return false};c.resetInput=function(d){d.startX=undefined;d.startY=
undefined;d.currentX=undefined;d.currentY=undefined;d.oldX=undefined;d.oldY=undefined;d.dX=0;d.dY=0;d.dW=0;d.ddX=0;d.ddY=0;d.ddW=0;typeof d.module.resetInput==="function"&&d.module.resetInput(d)};c.clamp=function(d,e,g){return d>g?g:d<e?e:d};c.wrap=function(d,e,g,h){for(;d>g;)d-=h;for(;d<e;)d+=h;return d};c.reload=function(d,e){e&&d.module.initialize&&d.module.initialize(d);c.prepareBackground(d);c.preloadImages(d,function(){c.rebindEvents(d);d.module.reload(d);d.target.trigger("onLoad",d)})};c.preloadImages=
function(d,e){d.preload.fadeIn(250,function(){SpriteLoader.preload(d.source,function(g){d.preload.fadeOut(250,function(){d.preload.hide()});d.stage.show();d.canvas&&d.canvas.show();d.images=g;e.apply(d.target,[d])})})};c.prepareBackground=function(d){var e=[d.width,"px"].join(""),g=[d.height,"px"].join("");d.target.css({width:e,height:g,position:"relative"});var h={width:e,height:g,top:"0px",left:"0px",position:"absolute"};a.extend(h,d.preloadCSS||{});d.preload.css(h).html(d.preloadHtml||"").hide();
d.stage.css({width:e,height:g,top:"0px",left:"0px",position:"absolute"}).hide();if(d.canvas){d.canvas[0].width=d.width;d.canvas[0].height=d.height;d.canvas.css({width:e,height:g,top:"0px",left:"0px",position:"absolute"}).hide()}};c.draw=function(d){d.module.draw(d)};c.rebindEvents=function(d){var e=d.target;e.unbind(".spritespin");var g=d.behavior;if(typeof d.behavior==="string")g=c.behaviors[d.behavior];g=g||{};var h=function(i){i.cancelable&&i.preventDefault();return false};e.bind("mousedown.spritespin",
g.mousedown||a.noop);e.bind("mousemove.spritespin",g.mousemove||a.noop);e.bind("mouseup.spritespin",g.mouseup||a.noop);e.bind("mouseenter.spritespin",g.mouseenter||a.noop);e.bind("mouseover.spritespin",g.mouseover||a.noop);e.bind("mouseleave.spritespin",g.mouseleave||a.noop);e.bind("dblclick.spritespin",g.dblclick||a.noop);e.bind("onFrame.spritespin",g.onFrame||a.noop);if(d.touchable){e.bind("touchstart.spritespin",g.mousedown||a.noop);e.bind("touchmove.spritespin",g.mousemove||a.noop);e.bind("touchend.spritespin",
g.mouseup||a.noop);e.bind("touchcancel.spritespin",g.mouseleave||a.noop);e.bind("click.spritespin",h);e.bind("gesturestart.spritespin",h);e.bind("gesturechange.spritespin",h);e.bind("gestureend.spritespin",h)}e.bind("mousedown.spritespin selectstart.spritespin",h);e.bind("onFrame.spritespin",function(i,j){c.draw(j)});e.bind("onLoad.spritespin",function(i,j){j.target.spritespin("animate",j.animate,j.loop)});typeof d.onFrame==="function"&&e.bind("onFrame.spritespin",d.onFrame);typeof d.onLoad==="function"&&
e.bind("onLoad.spritespin",d.onLoad)};a.fn.spritespin=function(d){if(f[d])return f[d].apply(this,Array.prototype.slice.call(arguments,1));if(typeof d==="object"||!d)return f.init.apply(this,arguments);a.error("Method "+d+" does not exist on jQuery.spritespin")};f.init=function(d){var e={width:undefined,height:undefined,frames:36,frame:0,module:"360",behavior:"drag",animate:true,loop:false,loopFrame:0,frameStep:1,frameTime:36,frameWrap:true,reverse:false,sense:1,orientation:"horizontal",source:undefined,
preloadHtml:undefined,preloadCSS:undefined,onFrame:undefined,onLoad:undefined,touchable:undefined};d=d||{};a.extend(e,d);return this.each(function(){var g=a(this),h=g.data("spritespin");if(h){a.extend(h,d);d.source?SpriteSpin.reload(h):g.spritespin("animate",h.animate,h.loop)}else{h=g.find("img");var i=0;if(h.length>0){e.source=[];for(i=0;i<h.length;i+=1)e.source.push(a(h[i]).attr("src"))}if(typeof e.source==="string")e.source=[e.source];c.disableSelection(g).css({overflow:"hidden",position:"relative"});
g.empty();g.append(a("<div class='spritespin-stage'/>"));g.append(a("<div class='spritespin-preload'/>"));g.addClass("spritespin-instance");if(e.enableCanvas){h=a("<canvas class='spritespin-canvas'/>")[0];if(h.getContext&&h.getContext("2d")){e.canvas=a(h);e.context=h.getContext("2d");g.append(e.canvas)}}if(typeof e.module==="string")e.module=SpriteSpin.modules[e.module];e.target=g;e.stage=g.find(".spritespin-stage");e.preload=g.find(".spritespin-preload");e.animation=null;e.touchable=e.touchable||
/iphone|ipod|ipad|android/i.test(b.navigator.userAgent);g.data("spritespin",e);SpriteSpin.reload(e,true)}})};f.destroy=function(){return this.each(function(){var d=a(this);d.unbind(".spritespin");var e=d.data("spritespin");if(e&&e.animation){b.clearInterval(e.animation);e.animation=null}d.removeData("spritespin")})};f.update=function(d){return this.each(function(){var e=a(this).data("spritespin");if(d===undefined)e.frame+=e.animation&&e.reverse?-e.frameStep:e.frameStep;else e.frame=d;e.frame=e.animation||
!e.animation&&e.frameWrap?c.wrap(e.frame,0,e.frames-1,e.frames):c.clamp(e.frame,0,e.frames-1);!e.loop&&e.animation&&e.frame===e.loopFrame&&f.animate.apply(e.target,[false]);e.target.trigger("onFrame",e)})};f.animate=function(d,e){if(d===undefined)return a(this).data("spritespin").animation!==null;return this.each(function(){var g=a(this),h=g.data("spritespin");if(typeof e==="boolean")h.loop=e;if(d==="toggle")h.animate=!h.animate;if(typeof d==="boolean")h.animate=d;if(h.animation){b.clearInterval(h.animation);
h.animation=null}if(h.animate)h.animation=b.setInterval(function(){try{g.spritespin("update")}catch(i){}},h.frameTime)})};f.frame=function(d){if(d===undefined)return a(this).data("spritespin").frame;return this.each(function(){a(this).spritespin("update",d)})};f.loop=function(d){if(d===undefined)return a(this).data("spritespin").loop;return this.each(function(){var e=a(this);e.spritespin("animate",e.data("spritespin").animate,d)})};f.next=function(){return this.each(function(){var d=a(this);d.spritespin("frame",
d.spritespin("frame")+1)})};f.prev=function(){return this.each(function(){var d=a(this);d.spritespin("frame",d.spritespin("frame")-1)})};f.animateTo=function(d){return this.each(function(){a(this).spritespin({animate:true,loop:false,loopFrame:d})})};c.behaviors.none={name:"none",mousedown:a.noop,mousemove:a.noop,mouseup:a.noop,mouseenter:a.noop,mouseover:a.noop,mouseleave:a.noop,dblclick:a.noop,onFrame:a.noop}})(jQuery,window);
(function(a,b,c){c.behaviors.click={name:"click",mouseup:function(f){var d=a(this),e=d.data("spritespin");c.updateInput(f,e);d.spritespin("animate",false);var g;g=e.target.offset();if(e.orientation=="horizontal"){f=e.width/2;g=e.currentX-g.left}else{f=e.height/2;g=e.currentY-g.top}if(g>f){d.spritespin("frame",e.frame+1);e.reverse=false}else{d.spritespin("frame",e.frame-1);e.reverse=true}}}})(jQuery,window,window.SpriteSpin);
(function(a,b,c){c.behaviors.drag={name:"drag",mousedown:function(f){var d=a(this).data("spritespin");c.updateInput(f,d);d.onDrag=true},mousemove:function(f){var d=a(this),e=d.data("spritespin");if(e.onDrag){c.updateInput(f,e);f=Math.round(e.clickframe+(e.orientation=="horizontal"?e.dX/e.width:e.dY/e.height)*e.frames*e.sense);d.spritespin("update",f);d.spritespin("animate",false)}},mouseup:function(){var f=a(this).data("spritespin");c.resetInput(f);f.onDrag=false},mouseleave:function(){var f=a(this).data("spritespin");
c.resetInput(f);f.onDrag=false}}})(jQuery,window,window.SpriteSpin);
(function(a,b,c){c.behaviors.hold={name:"hold",mousedown:function(f){var d=a(this),e=d.data("spritespin");c.updateInput(f,e);e.onDrag=true;d.spritespin("animate",true)},mousemove:function(f){var d=a(this).data("spritespin");if(d.onDrag){c.updateInput(f,d);var e=d.target.offset();if(d.orientation=="horizontal"){f=d.width/2;f=(d.currentX-e.left-f)/f}else{f=d.height/2;f=(d.currentY-e.top-f)/f}d.reverse=f<0;f=f<0?-f:f;d.frameTime=80*(1-f)+20}},mouseup:function(){var f=a(this),d=f.data("spritespin");c.resetInput(d);
d.onDrag=false;f.spritespin("animate",false)},mouseleave:function(){var f=a(this),d=f.data("spritespin");c.resetInput(d);d.onDrag=false;f.spritespin("animate",false)},onFrame:function(){a(this).spritespin("animate",true)}}})(jQuery,window,window.SpriteSpin);
(function(a,b,c){c.behaviors.swipe={name:"swipe",mousedown:function(f){var d=a(this).data("spritespin");c.updateInput(f,d);d.onDrag=true},mousemove:function(f){var d=a(this),e=d.data("spritespin");if(e.onDrag){c.updateInput(f,e);f=e.frame;var g=e.snap||0.25,h;if(e.orientation=="horizontal"){h=e.dX;g=e.width*g}else{h=e.dY;g=e.height*g}if(h>g){f=e.frame-1;e.onDrag=false}else if(h<-g){f=e.frame+1;e.onDrag=false}d.spritespin("update",f);d.spritespin("animate",false)}},mouseup:function(){var f=a(this).data("spritespin");
f.onDrag=false;c.resetInput(f)},mouseleave:function(){var f=a(this).data("spritespin");f.onDrag=false;c.resetInput(f)}}})(jQuery,window,window.SpriteSpin);
(function(a,b){var c=b.SpriteSpin.modules["360"]={};c.reload=function(f){var d=a(f.images);f.stage.empty();f.modopts={is_sprite:f.images.length==1,resX:f.resolutionX||f.images[0].width,resY:f.resolutionY||f.images[0].height,offX:f.offsetX||0,offY:f.offsetY||0,stepX:f.stepX||f.width,stepY:f.stepY||f.height,numFramesX:f.framesX||f.frames,oldFrame:f.frame,images:d};!f.modopts.is_sprite&&!f.canvas&&f.stage.append(d);d.css({width:f.modopts.resX,height:f.modopts.resY});c.draw(f)};c.draw=function(f){f.modopts.is_sprite?
c.drawSpritesheet(f):c.drawImages(f)};c.drawSpritesheet=function(f){var d=f.modopts,e=f.source[0],g=d.offX+f.frame%d.numFramesX*d.stepX,h=d.offY+(f.frame/d.numFramesX|0)*d.stepY;if(f.canvas){f.context.clearRect(0,0,f.width,f.height);f.context.drawImage(f.images[0],g,h,f.width,f.height,0,0,f.width,f.height)}else f.stage.css({width:[f.width,"px"].join(""),height:[f.height,"px"].join(""),"background-image":["url('",e,"')"].join(""),"background-repeat":"no-repeat","background-position":[-g,"px ",-h,"px"].join(""),
"-webkit-background-size":[d.resX,"px ",d.resY,"px"].join(""),"-moz-background-size":[d.resX,"px ",d.resY,"px"].join(""),"background-size":[d.resX,"px ",d.resY,"px"].join("")})};c.drawImages=function(f){var d=f.images[f.frame];if(f.canvas){f.context.clearRect(0,0,f.width,f.height);f.context.drawImage(d,0,0)}else{f=f.stage.css({width:[f.width,"px"].join(""),height:[f.height,"px"].join("")}).children().hide()[f.frame];SpriteSpin.disableSelection(a(f)).show()}}})(window.jQuery,window);
(function(a,b){b=b.SpriteSpin.modules.gallery={};b.reload=function(c){c.images=[];c.offsets=[];c.stage.empty();c.speed=500;c.opacity=0.25;var f=c.oldFrame=0,d=0;for(d=0;d<c.source.length;d+=1){var e=a("<img src='"+c.source[d]+"'/>");c.stage.append(e);c.images.push(e);c.offsets.push(-f+(c.width-e[0].width)/2);f+=e[0].width;e.css({opacity:0.25})}c.stage.css({width:f});c.images[c.oldFrame].animate({opacity:1},c.speed)};b.draw=function(c){if(c.oldFrame!=c.frame&&c.offsets){c.stage.stop(true,false);c.stage.animate({left:c.offsets[c.frame]},
c.speed);c.images[c.oldFrame].animate({opacity:c.opacity},c.speed);c.oldFrame=c.frame;c.images[c.oldFrame].animate({opacity:1},c.speed)}else c.stage.css({left:c.offsets[c.frame]+c.dX})};b.resetInput=function(c){c.onDrag||c.stage.animate({left:c.offsets[c.frame]})}})(jQuery,window);
(function(a,b){var c=b.SpriteSpin.modules.panorama={};c.reload=function(f){f.stage.empty();var d=f.modopts={};d.resX=f.resolutionX||f.images[0].width;d.resY=f.resolutionY||f.images[0].height;d.frames=f.orientation=="horizontal"?f.frames||d.resX:f.frames||d.resY;c.drawFirst(f)};c.draw=function(f){var d=f.modopts,e;if(f.orientation=="horizontal"){e=f.frame%d.frames;d=0}else{e=0;d=f.frame%d.frames}f.stage.css({"background-position":[-e,"px ",-d,"px"].join("")})};c.drawFirst=function(f){var d=f.modopts,
e,g;if(f.orientation=="horizontal"){e=f.frame%d.frames;g=0}else{e=0;g=f.frame%d.frames}f.stage.css({width:[f.width,"px"].join(""),height:[f.height,"px"].join(""),"background-image":["url('",f.source[0],"')"].join(""),"background-repeat":"repeat-both","background-position":[-e,"px ",-g,"px"].join(""),"-webkit-background-size":[d.resX,"px ",d.resY,"px"].join("")})}})(window.jQuery,window);
(function(){function a(g,h){h=h||[];var i,j,l=null;if(typeof g==="function"){g=g.apply(null,h);if(typeof g!=="object")return false}h=g.constructor;l=g.superclass||f;g.superclass=new l;h.prototype=new l;for(i in g)h.prototype[i]=g[i];h.prototype.constructor=g.constructor;for(j in l)if(!l.prototype[j]&&j!=="prototype")h[j]=l[j];return h}var b,c,f,d,e;f=function(){};b=a({constructor:function(){this.is_queueing=false;this.message_queue=[];this.messages_attached=[]},pause:function(){this.is_queueing=true},
play:function(){var g,h,i;g=0;for(h=this.message_queue.length;g<h;g++){i=this.message_queue[g];jQuery(i.element).trigger(i.event,[i.data])}this.is_queueing=false},send:function(g,h,i){this.is_queueing?this.message_queue.push({event:"message-"+h,element:g,data:i||{}}):jQuery(g).trigger("message-"+h,[i])},listen:function(g,h,i,j){j?jQuery(document).delegate(g,"message-"+h,i):jQuery(g).bind("message-"+h,i)},remove:function(g,h,i){i?jQuery(g).unbind("message-"+h,i):jQuery(g).unbind("message-"+h)}});c=
a({constructor:function(){this._loaded=false;this._widgets=[];this._message_bus=e;this.debug=window._NGBSDEBUG;this.objectify=a},legacy:function(g){this.widget(false,g,true)},page:function(g,h){this.widget(false,g,h)},widget:function(g,h,i){if(typeof h!=="function")h=this.objectify(h);g=this._widgets.push({callback:h,loaded:false,name:g});if(this._loaded||i)this.initialize(g-1,h)},initialize:function(g){var h;g=this._widgets[g];if(g.name)h=jQuery("."+g.name);if(g.callback.prototype instanceof f)new g.callback(this._message_bus,
h);else g.callback(this._message_bus,h)},load:function(){var g,h;this._message_bus.pause();g=0;for(h=this._widgets.length;g<h;g++)if(this._widgets[g].loaded===false){this.initialize(g);this._widgets[g].loaded=true}this._message_bus.play();this._loaded=true},_reinitialize:function(g){var h,i,j,l;h=0;for(i=this._widgets.length;h<i;h++)if(this._widgets[h].name===g){l=this._widgets[h];j=jQuery("."+l.name);if(l.callback.prototype instanceof f)new l.callback(this._message_bus,j);else l.callback(this._message_bus,
j)}}});d=window.ngbs&&window.ngbs._classes||{};e=new b;window.ngbs=new c;window.ngbs.u={};window.ngbs._classes=window.ngbs._classes||d;window.ngbs._classes.Widgets=c;window.ngbs._classes.MessageBus=b;window.ngbs._classes.BaseObject=f;jQuery(document).ready(function(){window.ngbs.metrics&&window.ngbs.metrics._load();window.ngbs.load()})})();
(function(a,b){if(a.u)a.u.region=function(){var c={fpi:"/services/geo/PostalCodes.json?postalCode="},f=function(d,e){this.val="";this.baseURL=__params.baseURL||"";this.make=__params.make||"";this.zipCode=a.u.cookie.zip();this.oldMetrics=e===true?true:false;this.callback=d&&typeof d==="function"?d:false;this.init()};f.prototype={init:function(){var d;if(this.zipCode===false||typeof this.zipCode==="undefined"){this.setDefaultCookie();this.callback!==false&&this.callback();this.oldMetrics&&b(document.body).trigger("region-set");
return false}d=a.u.cookie.get("regions");d===false?this.setCookieRegion():this.isRegionZipTodate(d)},setDefaultCookie:function(){a.u.cookie.set("regions","zip=00000&FDAF=none&LMDA=none&DMA=none&Marketing=none&PACode=none",{domain:document.domain,expires:"1",path:"/"})},setCookieRegion:function(){var d,e,g;g=this;this.getRegionData(function(){d=g.val;e={domain:document.domain,expires:"1",path:"/"};a.u.cookie.set("regions",d,e);g.callback!==false&&g.callback();g.oldMetrics&&b(document.body).trigger("region-set")})},
getRegionData:function(d){var e=this;b.ajax({url:this.baseURL+c.fpi+this.zipCode,dataType:"json",error:function(){}}).done(function(g){if(g)e.val+=e.handelData(g.Response)},function(){e.getLocateDealerData(d)}).fail(function(){e.setDefaultCookie();e.callback!==false&&e.callback();e.oldMetrics&&b(document.body).trigger("region-set")})},getLocateDealerData:function(d){var e;e=this;b.ajax({url:this.baseURL+"/core-services/dealers/byzipcode.json?zipCode="+this.zipCode+"&distance=50&pageSize=1&pageIndex=1",
dataType:"json",error:function(){}}).done(function(g){if(g)e.val+="&PACode="+g.Response.Dealer.PACode},function(){d&&typeof d==="function"&&d()}).fail(function(){e.setDefaultCookie();e.callback!==false&&e.callback();e.oldMetrics&&b(document.body).trigger("region-set")})},handelData:function(d){var e="",g=[],h=d.PostalCode.Regions.Region;e+="zip="+d.PostalCode.Name.content;if(h){b.each(h,function(i,j){g.push(j.type+"="+j.Code)});e+="&"+g.join("&")}return e},isRegionZipTodate:function(d){d=d.split("&",
1).join();d=d.split("=");if(d[0]==="zip"){d=d[1];if(this.zipCode!==d)this.setCookieRegion();else{this.callback!==false&&this.callback();this.oldMetrics&&b(document.body).trigger("region-set")}}else this.setCookieRegion()}};f.factory=function(d,e){return new f(d,e)};return f.factory}()})(ngbs,jQuery,window);
(function(a){a.u.cookie=function(){var b=function(c){var f=[];if(typeof c.expires==="number"){var d=new Date;d.setDate(d.getDate()+c.expires);f.push("expires="+d.toUTCString())}typeof c.path==="string"&&f.push("path="+c.path);typeof c.domain==="string"&&f.push("domain="+c.domain);typeof c.secure!=="undefined"&&f.push("secure");return f.length?"; "+f.join("; "):""};return{get:function(c){var f,d,e,g,h;if(document.cookie.indexOf(c)!==-1){f=document.cookie.split(";");d=0;for(h=f.length;d<h;d++){e=f[d].split("=");
g=e.shift().replace(/^\s*/,"").replace(/\s*$/,"");if(e.length&&g===c)return unescape(e.join("="))}}return false},getSub:function(c,f,d){var e,g;d=d||"&";if(c=this.get(c)){d=c.split(d);e=0;for(g=d.length;e<g;e++){c=d[e].split("=");if(c.length===2&&c[0]===f)return unescape(c[1])}}return false},set:function(c,f,d){d=d||{};d=b(d);f=encodeURI(f).replace(/;/g,"%3B");document.cookie=c+"="+f+d},setSub:function(c,f,d,e){e=e||{};var g=e.sep||e.separator||"&",h=this.get(c),i=this.getSub(c,f,g);d=encodeURI(d).replace(/;/g,
"%3B");e=b(e);d=i?h.replace(i,d):h+g+f+"="+d;document.cookie=c+"="+d+e},zip:function(c){var f;c=c||false;f=this.getSub("FPI","zip");if(!f&&!c)f=(f=(c=this.getSub("userInfo","zip",","))&&c!==""?c:false)?f.substr(0,5):f;return f},setZip:function(c,f){if(/\d{5}/.test(c)){this.setSub("FPI","zip",c,f);return true}return false}}}()})(ngbs);ngbs.metrics={page:function(){},click:function(){},_load:function(){}};
ngbs.page(function(a){var b=jQuery,c,f=function(){this.PREFIX="s550-";this.$container=b("#"+this.PREFIX+"container");this.$sections=this.$container.find("."+this.PREFIX+"section");this.$nav=this.$container.find(".autofill-stickynav");this.$navItems=this.$nav.find("li");this.ACT_CLASS="active";this.HID_CLASS="hidden";this.firedSocial=this.firedBuzz=false;this.init();this.bindHandlers()};f.prototype={init:function(){this.updateHead();this.isMobile=("ontouchstart"in document.body||"ontouchstart"in window||
"ontouchstart"in document.documentElement)&&b(window).width()<=480;this.badBrowser=navigator.appVersion.indexOf("MSIE 9")===-1&&navigator.appVersion.indexOf("MSIE 1")===-1;this.configurePictureLoader();this.getContentDirection();this.badBrowser||this.configureCollapser();this.configureNav();this.configureBillboard();this.configureViewpoints();this.configureGallerySlider();this.configureView360();this.configureRevealer();this.configureBuzz();this.configureSocialFeed();!this.isMobile&&this.configureParallax();
this.configureBackToTop();a.send(document.body,"s550-metrics",{action:"page",name:"mr-page"})},updateHead:function(){var d=b("head"),e=jQuery(".getupdates-social-list").find(".share-facebook").data("image");d.append('<meta property="og:image" content="'+e+' " />')},bindHandlers:function(){var d=this;this.$container.on("click",".feature-buttons",function(e){e.preventDefault();if(b(this).hasClass("open")&&!b(this).data("opened")){a.send(document.body,"s550-metrics",{action:"click",name:"mr-feature-read-more-interaction",
feature:b(this).data("feature-id")});b(this).attr("data-opened",true)}b(this).toggleClass("open").toggleClass("close").prev(".feature-list").slideToggle();GWS&&GWS.broadcast("features-button",b(this))});this.$container.on("click","#s550-getupdates a",function(e){e.preventDefault();b(this).data("id")&&GWS&&GWS.broadcast("getupdates-"+b(this).data("id"),b(this))});this.$container.on("click",".get-updates-link",function(){d.configureForm();GWS&&GWS.broadcast("getupdates-getupdates",b(this))});this.$container.on("click",
"buzz-item a",function(){GWS&&GWS.broadcast("carousel-slider-read-article")});b(".share-btn").on("click",function(e){e.preventDefault();d.share(b(this));if(e=b(this).data("id"))d.isMobile&&e==="email"?ngbs.metrics.page("mr-share-email-mobile"):a.send(document.body,"s550-metrics",{action:"click",name:"mr-social-share",social:e})});this.$container.on("click","#s550-buzz-slider .arrow",function(){if(!d.firedBuzz){a.send(document.body,"s550-metrics",{action:"click",name:"mr-buzz-news-interaction"});d.firedBuzz=
true}});this.$container.on("click","#s550-social-slider .arrow",function(){if(!d.firedSocial){a.send(document.body,"s550-metrics",{action:"click",name:"mr-buzz-social-interaction"});d.firedSocial=true}});this.$container.on("click",".section-collapser",function(){var e=b(this).parent().attr("data-title");if(!b(this).hasClass("collapsed")&&e){e=e.toLowerCase();ngbs.metrics.page("mr-page-"+e)}})},getSections:function(){for(var d=[],e,g=0;g<this.$sections.length;g++){e=b(this.$sections[g]).attr("id").replace(this.PREFIX,
"");d.push(e)}return d},getElement:function(d){if(this.$container.find(d).length)return this.$container.find(d);return false},getContentDirection:function(){this.direction=b('[dir="rtl"]').length?"right":"left"},configurePictureLoader:function(){var d,e=this;a.send(document.body,"picture-loader",{onInitialized:function(){},onComplete:function(){b("#s550-features .section-collapser, #s550-buzz .section-collapser").trigger("click")},onChange:function(){if(!e.badBrowser){clearTimeout(d);d=setTimeout(function(){a.send(document.body,
"parallax-refresh")},100)}}})},configureNav:function(){this.$nav.length&&a.send(document.body,"sticky-add",{$el:this.$nav,items:this.getSections(),offset:this.$nav.offset().top})},configureBillboard:function(){var d=this.getElement("#s550-billboard-slider"),e=this;if(d){var g=d.find(".carousel-text");a.send(document.body,"carousel-create",{$el:d,onInitialized:function(){d.height()>0?e.showSections():window.setTimeout(function(){e.showSections()},1E3)},onSlideStart:function(h){if(h.toPage!==h.currentPage){g.eq(h.toPage-
1).stop().animate({"margin-left":h.currentPage<h.toPage?"-100%":"100%"},h.speed);g.eq(h.toPage).css({"margin-left":h.currentPage<h.toPage?"100%":"-100%"})}},onSlideEnd:function(h){g.eq(h.toPage-1).css({"margin-left":0});g.eq(h.toPage).stop().animate({"margin-left":0},h.speed/3)}})}},configureViewpoints:function(){var d=this,e,g={$el:b("#s550-billboard, #s550-gallery, #s550-features, #s550-buzz, #s550-CTA"),offset:this.$nav.outerHeight(),inside:function(i,j){e=j.$el[0].id.replace("s550-","");d.$navItems.removeClass(d.ACT_CLASS);
d.$navItems.filter('[data-section="'+e+'"]').addClass(d.ACT_CLASS)}},h={$el:this.$container.find("#s550-view360"),offset:function(){return b(window).height()-d.$container.find(".view360-player").height()},crossing:function(i,j){if(j.direction==="down")if(!d.badBrowser){d.$container.find(".view360-player").spritespin("animate",true,false);i.active=false}}};a.send(document.body,"viewpoints",g);a.send(document.body,"viewpoints",h)},configureBackToTop:function(){var d=this.getElement(".back-to-top-button");
d&&a.send(document.body,"back-to-top-config",{$el:d})},configureGallerySlider:function(){var d=this.getElement(".gallery-slider");d&&a.send(document.body,"gallery-add",{$el:d,arrows:d.data("arrows"),scrollbar:d.data("scrollbar"),direction:this.direction,zoom:!this.isMobile})},configureView360:function(){this.$container.find(".feature-list").hide();var d={$el:this.$container.find("#s550-view360-view")};a.send(document.body,"view360-apply",d)},configureRevealer:function(){var d=this.getElement(".reveal-slider"),
e;if(d){d.find(".scroller-limit").append("<div class='limit-border'/>");e=d.find(".limit-border");a.send(document.body,"revealer-config",{$el:d,onDrag:function(g){e.eq(0).css({opacity:1-g.value/100});e.eq(1).css({opacity:g.value/100})}})}},configureBuzz:function(){var d=this.getElement("#"+this.PREFIX+"buzz"),e,g;if(d){if(this.isMobile){e=d.find(".carousel-item");g=d.find(".buzz-item");d.attr("data-adjustslide",true);b("#s550-buzz-slider").find(".carousel-widget").css({"padding-left":16});g.width(d.width()-
64);e.width(d.width()-32);e.last().css({width:e.last().width()+32})}a.send(document.body,"carousel-create",{$el:d.find("#s550-buzz-slider"),name:"news"})}},configureSocialFeed:function(){var d=0,e=this,g=this.getElement("#s550-social-feed");if(g){g.hide();var h=g.find(".carousel-slider-list");b.ajax({url:g.data("feed-source"),data:{"networks[]":["facebook","twitter"]},dataType:"jsonp"}).done(function(i){i=e.shuffleArray(i.data);if(i.length){g.show();for(d=0;d<=20;d++){var j=i[d],l="",k=jQuery("<li></li>");
k.addClass("carousel-item");if(j&&j.network&&(j.message||j.text)){if(j.network=="facebook"){l=j.message.substring(0,200)+"...";k.addClass("fb")}else{l=j.text;k.addClass("tw")}k.html('<div><span class="social-icon"></span><p>'+l+"</p></div>");h.append(k)}}if(e.isMobile){g.find(".carousel-item").width(g.width());g.find(".carousel-slider").attr("data-adjustslide",true)}a.send(document.body,"carousel-create",{$el:g.find("#s550-social-slider"),name:"social"})}})}},share:function(d){var e=d.attr("href"),
g=d.attr("data-deeplink")||window.location.href;if(d.hasClass("share-twitter")||d.hasClass("share-google"))e+=encodeURIComponent(g);if(d.hasClass("share-twitter")){if(d.data("text"))e+="&text="+d.data("text");if(d.data("hashtags"))e+="&hashtags="+d.data("hashtags")}if(d.hasClass("share-facebook")){if(this.isMobile)e=e.replace("s=100","m2w&s=100");e+="&p[url]="+encodeURIComponent(g)+"&p[title]="+encodeURIComponent(d.data("title"))+"&p[summary]="+encodeURIComponent(d.data("summary"))+"&p[images][0]="+
encodeURIComponent(d.data("image"))}if(d.hasClass("share-by-email"))if(this.isMobile)window.location.href="mailto:?body="+encodeURIComponent((d.data("description")||"")+"\n\n"+g)+"&subject="+encodeURIComponent(d.data("title"))||"";else this.openEmailWindow(d.data());else window.open(e);return false},openEmailWindow:function(d){var e=screen.width/2-357.5,g=screen.height/2-275;d=ngbs.u.encoder(JSON.stringify({t:d.title,l:d.deeplink||window.location.href,d:d.description,s:d.image,n:__params.metricsname,
y:__params.year,level:"asset"}),"base64").encode().replace(/\=/g,"%3D");window.open("/share-email?params="+d,"","width=715,height=550,top="+g+",left="+e+",location=no,resizable=no,scrollbars=no,toolbar=no");return false},shuffleArray:function(d){for(var e,g,h=d.length;h;e=parseInt(Math.random()*h),g=d[--h],d[h]=d[e],d[e]=g);return d},configureParallax:function(){var d=this.getElement(".parallax-feature, .reveal-slider-player");this.getElement(".reveal-slider-player");if(d){d=b.extend({$el:d},d.data());
a.send(document.body,"parallax",d)}},configureCollapser:function(){a.send(document.body,"section-collapser",{$el:this.$sections})},configureScrolling:function(){a.send(document.body,"smooth-scrolling")},configureForm:function(){var d=b("#getupdates-vehicles-select-1");d.length&&window.setTimeout(function(){d.find('option[data-name="Mustang"]').attr("selected","selected")},100)},showSections:function(d){(d||this.$sections).removeClass(this.HID_CLASS)},hideSections:function(d){(d||this.$sections).addClass(this.HID_CLASS)}};
a.listen(document.body,"s550-metrics",function(d,e){c&&c.isMobile?ngbs.metrics[e.action](e.name+"-mobile",e):ngbs.metrics[e.action](e.name,e)});a.listen(document.body,"page-init",function(){c=new f})});
ngbs.widget("picture-loader",function(a){function b(e){this.$preImages=jQuery(".picture-loader");this.mediaCount=this.$preImages.length;this.loadedCount=0;this.options=e;this.largerWidth=c(window).width();this.init();this.bindings();if(navigator.appName.indexOf("Internet Explorer")!==-1)this.badBrowser=navigator.appVersion.indexOf("MSIE 9")===-1&&navigator.appVersion.indexOf("MSIE 1")===-1;typeof e.onInitialized==="function"&&e.onInitialized()}var c=jQuery,f=true,d;b.prototype.init=function(){this.retina=
this.checkPixelRatio();this.update()};b.prototype.loadedCheck=function(e,g){var h=this;c("<img>").on("load",function(){h.loadedCount++;if(h.mediaCount===h.loadedCount)if(g&&typeof h.options.onComplete==="function")h.options.onComplete();else typeof h.options.onChange==="function"&&h.options.onChange()}).attr("src",e)};b.prototype.replaceImage=function(e,g){var h=this,i=e.parent(),j,l,k;i.find("img").remove();l=e.data("class")||"";k=i.data("alt")||"";j=this.retina&&e.data("retina")?e.data("retina"):
e.data("src");g?e.html("<img src='"+j+"' class='"+l+"' alt='"+k+"'/>"):c("<img>").on("load",function(){e.html("<img src='"+j+"' class='"+l+"' alt='"+k+"'/>")}).attr("src",j);h.loadedCheck(j,g)};b.prototype.update=function(){var e=this,g=c(window).width();this.loadedCount=0;this.$preImages.each(function(h,i){h=c(i);h.data("class");h.find(".media-selector").each(function(j,l){j=c(l);l=parseInt(j.data("min-width"),10)||0;var k=parseInt(j.data("max-width"),10)||9999999999999;if(g>=l&&g<=k){if(f){this.largerWidth=
l;e.replaceImage(j,true)}else if(g<e.largerWidth&&j.data("force-replace"))e.replaceImage(j,false);else g>e.largerWidth&&e.replaceImage(j,false);return false}})});f=false};b.prototype.bindings=function(){var e=this;c(window).on("resize",function(){if(!e.badBrowser){clearTimeout(d);setTimeout(function(){e.update()},1E3)}})};b.prototype.checkPixelRatio=function(){return window.devicePixelRatio>1?true:window.matchMedia&&window.matchMedia("(-webkit-min-device-pixel-ratio: 2), (min--moz-device-pixel-ratio: 2), (-o-min-device-pixel-ratio: 2/2), (min-resolution: 2dppx)").matches?
true:false};a.listen(document.body,"picture-loader",function(e,g){new b(g)})});
ngbs.widget("autofill-stickynav",function(a){function b(d){this.$nav=d.$el;this.$content=this.$nav.find(".nav-content");this.$items=this.$content.find("li");this.offset=d.offset;this.items_active=d.items;this.duration=d.duration||500;this.CLASS_NAV="sticky";this.CLASS_ACT="active";this.CLASS_DIS="disabled";this.init();this.bindHandlers()}var c=jQuery,f;b.prototype={init:function(){this.populateNav()},bindHandlers:function(){var d=this;this.$content.on("click","a",function(e){e.preventDefault();e=
c(this).parent("li");GWS&&GWS.broadcast("subnav-item",c(this));if(e.data("section")){c(window).trigger("disableViewPoints");d.toggleActive(e);d.scrollTo(c(this).attr("href"))}e.data("metric")&&a.send(document.body,"s550-metrics",{action:"click",name:"mr-"+e.data("metric")+"-interaction"})});c(window).on("scroll",function(){c(window).scrollTop()>=d.offset?d.enable():d.disable();GWS&&GWS.broadcast("subnav-scroll")})},populateNav:function(){var d=this;this.$items.each(function(){c.inArray(c(this).data("section"),
d.items_active)>-1||c(this).data("show")===true?c(this).removeClass(d.CLASS_DIS):c(this).remove()})},enable:function(){this.$nav.addClass(this.CLASS_NAV)},disable:function(){this.$nav.removeClass(this.CLASS_NAV)},toggleActive:function(d){this.$content.find("li").removeClass(this.CLASS_ACT);d.addClass(this.CLASS_ACT)},scrollTo:function(d){d=c(d).offset().top-this.$content.outerHeight()+1;c("html, body").stop().animate({scrollTop:d},f.duration,function(){c(window).trigger("enableViewPoints")})}};a.listen(document.body,
"sticky-add",function(d,e){f=new b(e)})});
ngbs.widget("carousel-slider",function(a){function b(e){if(!e.$el.hasClass("carousel-enabled")){this.$el=e.$el;this.options={name:e.name,selector:".carousel-item",initialPage:this.$el.data("initialpage")||0,showArrows:this.$el.data("arrows")==false?false:true,speed:this.$el.data("speed")||400,animate:this.$el.data("animate")==false?false:true,easing:this.$el.data("easing")||"swing",autoscroll:this.$el.data("autoscroll")||false,autoscrollTime:this.$el.data("autoscrolltime")||4E3,scrollAmount:this.$el.data("scrollamount")||
0,adjustSlide:this.$el.data("adjustslide")==false?false:true,forceCarousel:this.$el.data("forcecaruosel")||false,hideControls:this.$el.data("hidecontrols")||false,autoControls:this.$el.data("autocontrols")==false?false:true,cycle:this.$el.data("cycle")==false?false:true,infinite:this.$el.data("infinite")||false,onInitialized:e.onInitialized||this.$el.data("oninitialized")||undefined,onSlideStart:e.onSlideStart||this.$el.data("onslidestart")||undefined,onSlideEnd:e.onSlideEnd||this.$el.data("onslideend")||
undefined};this.$disclaimer=e.$disclaimer;this.firedSwipe=this.animating=false;this.init()}}var c=jQuery,f,d="ontouchstart"in window?"touchstart":"click";b.prototype.getImgsToLoad=function(){var e=this.$slides.find("img[data-lazy]");this.imgsLoaded=0;return e};b.prototype.init=function(){var e=this;this.$slider=this.$el.find(".carousel-slider-list");this.$slides=this.$slider.find(this.options.selector);this.imgsToLoad=this.getImgsToLoad();this.slidesLength=this.$slides.length;this.slidesLength===
1&&!this.options.forceCarousel||(this.imgsToLoad.length?this.imgsToLoad.each(function(g,h){e.loadImg(c(h))}):this.launchCarousel())};b.prototype.loadImg=function(e){var g=this,h=e.data("lazy");c("<img>").load(function(){e.attr("src",h);g.imgsLoaded++;g.checkLoaded()}).attr("src",h)};b.prototype.checkLoaded=function(){this.imgsLoaded===this.imgsToLoad.length&&this.launchCarousel()};b.prototype.launchCarousel=function(){var e=0;this.$el.addClass("carousel-enabled");this.createControls();if(this.options.adjustSlide){e=
100*this.slidesLength+"%";this.$slides.addClass("fit-width").css({width:(100/this.slidesLength).toFixed(2)+"%"})}else{this.$slider.width("auto");this.$slides.each(function(){e+=c(this).outerWidth()});this.totalSlidesWidth=e;this.trimLeft=this.$slider.outerWidth()-this.totalSlidesWidth;e+="px"}this.$slider.css({width:e,height:"auto"});this.visibleSlides=Math.round(this.$el.outerWidth()/this.$slides.first().outerWidth());this.totalPages=Math.ceil(this.$slides.length/this.visibleSlides);this.slideTo({to:this.options.initialPage,
animate:false});this.options.autoscroll&&this.autoscroll();if(this.options.hideControls){this.hideControls();this.options.autoControls&&this.autoControls()}if("touchstart"in window||"ontouchstart"in document.documentElement)this.mobileNavigation();this.bindings();typeof this.options.onInitialized==="function"&&this.options.onInitialized.call()};b.prototype.bindings=function(){var e=this;this.$navigationButtons.on(d,function(){e.autoscrollPause();e.slideTo(c(this).index());GWS&&GWS.broadcast("carousel-slider-bullet")});
this.$navigationArrows.on(d,function(){e.autoscrollPause();c(this).hasClass("carousel-prev")?e.prev():e.next();GWS&&GWS.broadcast("carousel-slider-arrow")});c(window).on("resize",function(){e.updateView()})};b.prototype.mobileNavigation=function(){var e,g,h,i,j=0,l=this;c(window).width();this.$el.find(".carousel-item").width();this.$slides.on("touchstart",function(k){if(k.touches===undefined&&k.originalEvent!==undefined)k.touches=k.originalEvent.touches;e=k.touches[0].pageX;g=k.touches[0].pageY;i=
0});this.$slides.on("touchmove",function(k){var m,n;n=k.originalEvent;if(!(n.touches.length>1||n.scale&&n.scale!==1)){n=n.touches[0];n={x:n.pageX-e,y:n.pageY-g};if(typeof m=="undefined")m=!!(m||Math.abs(n.x)<Math.abs(n.y));if(!m){if(k.touches===undefined&&k.originalEvent!==undefined)k.touches=k.originalEvent.touches;h=-((k.touches[0].clientX||k.touches[0].pageX)-e);j=Math.abs(h);if(!(j>10&&j<=15))if(j>15){i=(k.touches[0].clientY||k.touches[0].pageY)-g;if(n.x>0)l.animating||l.prev();else if(n.x<0)l.animating||
l.next()}l.autoscrollPause();if(l.options.name&&!l.firedSwipe){ngbs.metrics.click("mr-buzz-"+l.options.name+"-interaction-mobile");l.firedSwipe=true}}}})};b.prototype.next=function(){return this.slideTo(this.currentPage+1)};b.prototype.prev=function(){return this.slideTo(this.currentPage-1)};b.prototype.slideTo=function(e){var g=this,h;this.animating=true;h=typeof e==="number"?this.checkRange(e):typeof e==="object"?e.to:-1;if(h===-1)return false;this.updateControls(h);this.$slider.attr("data-page",
h);if(this.options.adjustSlide)e=-100*h+"%";else{e=this.options.scrollAmount?parseInt(this.$slider.css("margin-left"),10)-this.options.scrollAmount:Math.abs(h*this.$slides.width()*this.visibleSlides)*-1;if(e<this.trimLeft&&h!==0){e=this.trimLeft;this.currentPage=this.slidesLength-1}}typeof g.options.onSlideStart==="function"&&g.options.onSlideStart.call(g,{toPage:h,currentPage:g.currentPage,speed:g.options.speed});if(this.options.animate)this.$slider.stop().animate({"margin-left":e},g.options.speed,
g.options.easing,function(){g.animating=false;typeof g.options.onSlideEnd==="function"&&g.options.onSlideEnd.call(g,{toPage:h,currentPage:g.currentPage,speed:g.options.speed})});else{this.$slider.stop().css({"margin-left":e});typeof g.options.onSlideEnd==="function"&&g.options.onSlideEnd.call(g,{to:h,currentPage:g.currentPage,speed:g.options.speed})}this.currentPage=h;return true};b.prototype.checkRange=function(e){return e===this.currentPage?-1:e<0?this.options.cycle?this.slidesLength-1:0:e>this.slidesLength-
1?this.options.cycle?0:this.slidesLength-1:e};b.prototype.createControls=function(){var e="",g;for(g=0;g<this.slidesLength;g++)e+="<li class='carousel-meatball'></li>";this.$slider.after("<div class='carousel-text-centered'><ul class='carousel-navigation'>"+e+"</ul></div>");this.options.showArrows&&this.$slider.after("<div class='carousel-prev arrow'></div><div class='carousel-next arrow'></div>");this.$navigationArrows=this.$el.find(".arrow");this.$navigationButtons=this.$el.find(".carousel-meatball");
this.$disclaimer&&this.$disclaimer.length&&this.$disclaimer.addClass("carousel-disclaimer").appendTo(this.$el)};b.prototype.showControls=function(e){e=c.extend({},this.options,e);if(e.animate){this.$navigationArrows.fadeIn(e.speed);this.$navigationButtons.fadeIn(e.speed)}else{this.$navigationArrows.show();this.$navigationButtons.show()}};b.prototype.hideControls=function(e){e=c.extend({},this.options,e);if(e.animate){this.$navigationArrows.fadeOut(e.speed);this.$navigationButtons.fadeOut(e.speed)}else{this.$navigationArrows.hide();
this.$navigationButtons.hide()}};b.prototype.autoControls=function(){var e=this;this.$el.on("mouseenter",function(){clearTimeout(f);f=setTimeout(function(){e.showControls()},e.options.speed/2)});this.$el.on("mouseleave",function(){clearTimeout(f);f=setTimeout(function(){e.hideControls()},e.options.speed/2)})};b.prototype.updateView=function(){if(!this.options.adjustSlide)this.trimLeft=this.$slider.parent().outerWidth()-this.totalSlidesWidth};b.prototype.updateControls=function(e){if(this.options.adjustSlide)if(e===
0&&!this.options.cycle&&!this.options.hideControls)if(this.options.animate){this.$navigationArrows.eq(0).fadeOut();this.slidesLength===2&&this.$navigationArrows.eq(1).fadeIn()}else{this.$navigationArrows.eq(0).hide();this.slidesLength===2&&this.$navigationArrows.eq(1).show()}else if(e===this.slidesLength-1&&!this.options.cycle&&!this.options.hideControls)if(this.options.animate){this.$navigationArrows.eq(1).fadeOut();this.slidesLength===2&&this.$navigationArrows.eq(0).fadeIn()}else{this.$navigationArrows.eq(1).hide();
this.slidesLength===2&&this.$navigationArrows.eq(0).show()}else this.options.hideControls||(this.options.animate?this.$navigationArrows.fadeIn():this.$navigationArrows.show());else{if(e!==0)this.options.animate?this.$navigationArrows.eq(0).fadeIn():this.$navigationArrows.eq(0).show();else this.options.animate?this.$navigationArrows.eq(0).fadeOut():this.$navigationArrows.eq(0).hide();if(e!==this.totalPages-1)this.options.animate?this.$navigationArrows.eq(1).fadeIn():this.$navigationArrows.eq(1).show();
else this.options.animate?this.$navigationArrows.eq(1).fadeOut():this.$navigationArrows.eq(1).hide()}this.$navigationButtons.removeClass("active").eq(e).addClass("active")};b.prototype.autoscroll=function(e){var g=this;e=e||this.options.autoscrollTime;this.timer=setTimeout(function(){g.next()&&g.autoscroll(e+g.options.speed)},e)};b.prototype.autoscrollPause=function(){clearTimeout(this.timer)};a.listen(document.body,"carousel-create",function(e,g){var h={};h=c.extend({},g);g.$el.each(function(i){h.$el=
g.$el.eq(i);new b(h)})})});
ngbs.widget("gallery-slider",function(a){function b(d){this.$gallery=d.$el;this.$container=this.$gallery.find(".gallery-container");this.$wrapper=this.$container.find(".gallery-wrapper");this.$photos=this.$wrapper.find(".gallery-photo");this.$scrollbar=this.$container.find(".gallery-scroller");this.$arrows=this.$container.find(".arrow");if(this.$scrollbar.length)this.$wheel=this.$scrollbar.find(".wheel");this.zoomEnabled=d.zoom;this.firedFull=this.firedScroll=false;this.ACT_CLASS="active";this.DIS_CLASS=
"disabled";if(navigator.appName.indexOf("Internet Explorer")!==-1)this.badBrowser=navigator.appVersion.indexOf("MSIE 9")===-1&&navigator.appVersion.indexOf("MSIE 1")===-1;this.touchSupport="ontouchstart"in document.body;this.animating=false;this.init()}var c=jQuery,f;b.prototype={init:function(){var d=this;this.buildImgs();this.imgsToLoad=this.getImgsToLoad();this.imgsToLoad.length?this.imgsToLoad.each(function(e,g){d.loadImg(c(g))}):this.launch();this.touchSupport&&this.addSwipeSupport()},buildImgs:function(){this.$photos.each(function(d,
e){d=c(e);e=c(window).width();var g=d.find("input[type='hidden']"),h="";d.find("img").remove();if(e<=568)h=g.data("small")||g.data("medium")||g.data("large");else if(e>568&&e<=768)h=g.data("medium")||g.data("large");else if(e>768)h=g.data("large");d.append("<img src='"+h+"' >")})},getImgsToLoad:function(){var d=this.$photos.find("img[data-lazy]");this.imgsLoaded=0;return d},loadImg:function(d){var e=this,g=d.data("lazy");c("<img>").load(function(){d.attr("src",g);e.imgsLoaded++;e.checkLoaded()}).attr("src",
g)},checkLoaded:function(){var d=this;this.imgsLoaded===this.imgsToLoad.length&&window.setTimeout(function(){d.launch()},1E3)},launch:function(){this.$gallery.addClass("gallery-enabled");this.configureWrapper();this.checkArrows();this.setHandlers()},setHandlers:function(){var d=this;this.$container.on("click",".gallery-scroller",function(e){if(!c(e.target).is(d.$wheel)){e=d.calculateShift(e.clientX);d.moveTo(d.$wrapper,-e.wrapper,true);d.moveTo(d.$wheel,e.scroller,true);if(!d.firedScroll){a.send(document.body,
"s550-metrics",{action:"click",name:"mr-gallery-scroll-interaction"});d.firedScroll=true}GWS&&GWS.broadcast("gallery-slider-scroll-click")}});this.$container.on("mousedown",".wheel",".gallery-scroller",function(e){e.preventDefault();d.isMouseDown=true;d.configureDrag(e);GWS&&GWS.broadcast("gallery-slider-scroll-mousedown")});this.$container.on("click",".arrow",function(){var e=c(this).hasClass("prev")?-1:1;d.handleArrows(e);if(!d.firedScroll){a.send(document.body,"s550-metrics",{action:"click",name:"mr-gallery-scroll-interaction"});
d.firedScroll=true}GWS&&GWS.broadcast("gallery-slider-arrow")});this.$container.on("touchstart",".arrow",function(e){e.preventDefault();var g=c(this).hasClass("prev")?-1:1;d.handleArrows(g);if(!d.firedScroll){ngbs.metrics.click("mr-gallery-scroll-interaction-mobile");d.firedScroll=true}GWS&&GWS.broadcast("gallery-slider-arrow");e.stopPropagation()});this.$container.on("touchmove",".arrow",function(e){e.preventDefault();e.stopPropagation()});this.$container.on("touchend",".arrow",function(e){e.preventDefault();
e.stopPropagation()});c("body, html").on("mousemove",function(e){if(e.which===1&&d.isMouseDown){d.configureDrag(e);if(!d.firedScroll){a.send(document.body,"s550-metrics",{action:"click",name:"mr-gallery-scroll-interaction"});d.firedScroll=true}GWS&&GWS.broadcast("gallery-slider-scroll-mousemove")}});c("body, html").on("mouseup",function(){if(d.isMouseDown){d.isMouseDown=false;GWS&&GWS.broadcast("gallery-slider-scroll-mouseup")}});this.$container.on("click",".zoomable",function(e){e.stopPropagation();
if(d.zoomEnabled){d.fireZoom(c(this));if(!d.firedFull){a.send(document.body,"s550-metrics",{action:"click",name:"mr-gallery-full-interaction"});d.firedFull=true}GWS&&GWS.broadcast("gallery-slider-image",c(this))}});c(window).on("resize",function(){if(!d.badBrowser){d.buildImgs();d.configureWrapper()}})},checkArrows:function(){if(this.$arrows){this.$arrows.removeClass(this.DIS_CLASS);if(this.$wrapper.position().left===0)this.$arrows.filter(".prev").addClass(this.DIS_CLASS);else this.$wrapper.position().left-
this.$container.outerWidth()+this.$wrapper.outerWidth()===0&&this.$arrows.filter(".next").addClass(this.DIS_CLASS)}},configureWrapper:function(){var d=this,e=0,g=this.$photos.length,h=0,i;this.$photos.each(function(){c("<img/>").on("load",function(){h++}).attr("src",c(this).find("img").attr("src"))});i=setInterval(function(){if(g===h){clearTimeout(i);d.$photos.each(function(){var j=c(this),l=j.find("img");if(d.badBrowser)e+=l.outerWidth();else{e+=j.outerWidth();l.css("width",j.outerWidth())}});e>
0&&d.$wrapper.width(e+1);d.zoomEnabled&&d.checkDeepLink()}},100)},configureDrag:function(d){var e=d.clientX;this.$wheel.offset();var g={};switch(d.type){case "mousedown":this.wheel_left_ini=e;this.wheel_left_end=null;break;case "mousemove":this.wheel_left_end=e;break}if(this.wheel_left_end){g=this.calculateShift(this.wheel_left_end);this.moveTo(this.$wrapper,-g.wrapper);this.moveTo(this.$wheel,g.scroller)}},handleArrows:function(d){var e=this.$photos.filter("."+this.ACT_CLASS),g=e.position().left;
e.outerWidth();var h;if(!this.animating){this.animating=true;switch(d){case -1:h=this.$wrapper.position().left!==-g?g:e.prev(".gallery-photo").position().left;break;case 1:h=g+e.outerWidth();break}if(-h<=-(this.$wrapper.outerWidth()-this.$container.outerWidth()))h=this.$wrapper.outerWidth()-this.$container.outerWidth();this.moveTo(this.$wrapper,-h,true);if(this.$wheel){d=h/(this.$wrapper.outerWidth()-this.$container.outerWidth())*(this.$scrollbar.outerWidth()-this.$wheel.outerWidth());this.moveTo(this.$wheel,
d,true)}}},calculateShift:function(d){var e=this.$scrollbar.outerWidth(),g=this.$wheel.outerWidth(),h=g/2;d=d+h>=e?e-g:d-h<=0?0:d-h;return{wrapper:(this.$wrapper.outerWidth()-this.$container.outerWidth())*d/(e-g),scroller:d}},moveTo:function(d,e,g){var h=this;if(g)d.animate({left:e},500,function(){h.callback();h.animating=false});else{d.css("left",e);this.callback()}},callback:function(){this.toggleActive();this.checkArrows()},toggleActive:function(){var d=this;this.$photos.removeClass(this.ACT_CLASS);
this.$photos.each(function(){d.$wrapper.position().left<=-c(this).position().left&&d.$wrapper.position().left>-c(this).position().left-c(this).outerWidth()&&c(c(this)[0]).addClass(d.ACT_CLASS)})},addSwipeSupport:function(){var d,e,g,h,i=0,j=this;c(window).width();this.$gallery.on("touchstart",function(l){l=l.originalEvent;d=l.touches[0].pageX;e=l.touches[0].pageY;h=0});this.$gallery.on("touchmove",function(l){var k,m,n;m=l.originalEvent;if(!(m.touches.length>1||m.scale&&m.scale!==1)){m=m.touches[0];
m={x:m.pageX-d,y:m.pageY-e};if(typeof k=="undefined")k=!!(k||Math.abs(m.x)<Math.abs(m.y));if(!k){if(l.touches===undefined&&l.originalEvent!==undefined)l.touches=l.originalEvent.touches;g=-((l.touches[0].clientX||l.touches[0].pageX)-d);i=Math.abs(g);if(!(i>10&&i<=15))if(i>15){h=(l.touches[0].clientY||l.touches[0].pageY)-e;if(m.x>0)j.animating||(n=-1);else if(m.x<0)j.animating||(n=1);j.handleArrows(n);if(!j.firedScroll){ngbs.metrics.click("mr-gallery-scroll-interaction-mobile");j.firedScroll=true}}}}})},
checkDeepLink:function(){var d=this.checkRegex(),e=this;if(d){var g=d[4].indexOf("&")>-1?d[4].split("&")[0]:d[4];this.$photos.each(function(){if(g===c(this).data("name")){e.fireZoom(c(this),window.location.href);return false}})}},checkRegex:function(){return window.location.href.match(/(\?|\&)(gallery)(\=)(.*)/)},constructDeepLink:function(d){var e=this.checkRegex(),g=window.location.href;if(e){e=e[4].indexOf("&")>-1?e[4].split("&")[0]:e[4];d=g.replace(e,d)}else{e=g.indexOf("?")>-1?"&":"?";d=g+e+
"gallery="+d}return d},fireZoom:function(d,e){a.send(document.body,"zoom-open",{$el:d,config:c.extend(d.data(),{deeplink:e||this.constructDeepLink(d.data("name"))})})}};a.listen(document.body,"gallery-add",function(d,e){f=new b(e)});a.listen(document.body,"zoom-deeplink",function(d,e){f.fireZoom(e.$el)})});
ngbs.widget("zoom-fullscreen",function(a){function b(){this.$container=c(".zoom-fullscreen");this.$controls=this.$container.find(".zoom-controlbar");this.firedZoom=this.in_place=false;this.ACT_CLASS="active";this.DIS_CLASS="disabled"}var c=jQuery,f;b.prototype={init:function(d){this.$selected=d.$el;this.config=d.config;this.$controls.find("li").first().addClass("first");if(!this.in_place){this.$container.prependTo("body");this.in_place=true}this.$controls.find(".save").length&&this.configureSave();
this.$controls.find(".share-btn").length&&this.configureShare();this.configureZoom();this.bindHandlers()},bindHandlers:function(){var d=this;this.$container.on("click",".zoom-arrow",function(){if(!c(this).hasClass(d.DIS_CLASS)){d.$selected=c(this).hasClass("prev")?d.$selected.prev():d.$selected.next();d.destroy();a.send(document.body,"zoom-deeplink",{$el:d.$selected});GWS&&GWS.broadcast("zoom-fullscreen-arrow")}});this.$container.on("click",".zoom-close",function(){d.close();GWS&&GWS.broadcast("zoom-fullscreen-close")});
this.$controls.on("click",".save",function(){GWS&&GWS.broadcast("zoom-fullscreen-save")});this.$controls.on("click",".share",function(){c(this).find(".share-popup").toggleClass(d.ACT_CLASS);GWS&&GWS.broadcast("zoom-fullscreen-share")})},configureSave:function(){var d=this.config.src,e=this.config.name?"="+this.config.name:"";this.$controls.find(".save").html('<a href="'+d+'" download'+e+' target="_blank"></a>')},configureShare:function(){this.$controls.find(".share-btn").attr("data-deeplink",this.config.deeplink)},
configureZoom:function(){var d,e=this.config.width||5E3,g=this.config.height||2300,h=this.config.tilespath,i=[],j,l;this.open();d=new OpenLayers.Layer.Zoomify("Zoomify",h,new OpenLayers.Size(e,g));d.transitionEffect="resize";d.isBaseLayer=false;for(j=d.numberOfTiers-1;j>=0;j--)i.push(Math.pow(2,j));h=new OpenLayers.Layer.Image("Image",h+"TileGroup0/0-0-0.jpg",new OpenLayers.Bounds(0,0,e,g),d.tierImageSize[0],{alwaysInRange:true});e={resolutions:i,maxExtent:new OpenLayers.Bounds(0,0,e,g),restrictedExtent:new OpenLayers.Bounds(0,
0,e,g),numZoomLevels:d.numberOfTiers,units:"pixels",controls:[],theme:null};this.map=new OpenLayers.Map("zoom-flip-map",e);this.map.addLayer(d);this.map.addLayer(h);this.map.addControl(new OpenLayers.Control.Zoom({zoomInId:"zoomin",zoomOutId:"zoomout"}));this.map.addControl(new OpenLayers.Control.KeyboardDefaults);this.map.addControl(new OpenLayers.Control.Navigation({mouseWheelOptions:{cumulative:false,interval:0},dragPanOptions:{enableKinetic:false},zoomBoxEnabled:false,zoomWheelEnabled:true}));
if(this.$container.find("#zoom-overviewmap").length){j={div:document.getElementById("zoom-overviewmap"),size:d.tierImageSize[0],autoPan:false,mapOptions:{numZoomLevels:1}};j=new OpenLayers.Control.OverviewMap(j);j.isSuitableOverview=function(){return true};this.map.addControl(j)}for(j=0;j<=e.numZoomLevels;j++){g=h.size.w*i[d.numberOfTiers-1-j];if(g>=this.map.size.w){l=j;this.map.zoomTo(l);break}}this.map.events.register("zoomend",this,function(){this.map.getZoom()<l&&this.map.zoomTo(l);this.fireZoomMetrics()});
this.map.events.register("move",this,function(){this.fireZoomMetrics()})},checkArrows:function(){var d=this.$container.find(".zoom-arrow");d.addClass(this.DIS_CLASS);this.$selected.prev().length&&d.filter(".prev").removeClass(this.DIS_CLASS);this.$selected.next().length&&d.filter(".next").removeClass(this.DIS_CLASS)},open:function(){this.$container.addClass(this.ACT_CLASS);this.checkArrows();a.send(document.body,"view360-remove")},close:function(){this.$container.removeClass(this.ACT_CLASS);this.destroy()},
destroy:function(){this.map.destroy()},fireZoomMetrics:function(){if(!this.firedZoom){a.send(document.body,"s550-metrics",{action:"click",name:"mr-gallery-zoom-interaction"});this.firedZoom=true}}};a.listen(document.body,"zoom-open",function(d,e){if(f instanceof b){f.$controls.off("click");f.$container.off("click")}else f=new b;f.init(e)})});
ngbs.widget("view360",function(a){var b=jQuery,c,f=function(d){this.$el=d instanceof jQuery?d:d.$el;this.options={showControls:this.$el.data("showcontrols")==false?false:true,showArrows:this.$el.data("showarrows")==false?false:true,autoHideControls:this.$el.data("autohidecontrols")==false?false:true,initialColor:parseInt(this.$el.data("initialcolor"),10)||0,initialTrim:parseInt(this.$el.data("initialtrim"),10)||0,initialBackground:parseInt(this.$el.data("initialbackground"),10)||0,fixedOnBadIE:this.$el.data("fixedonbadie")==
false?false:true,direction:this.$el.data("direction")||-1};this.init(d)};f.prototype.init=function(d){this.$player=this.$el.find(".view360-player");this.$components=this.$el.find(".view360-components");this.$arrows=this.$el.find(".view360-arrows").children("div");this.firedRim=this.firedColor=this.firedSpin=false;this.$components.find(".view360-color-picker li").each(function(e){var g=b(this).data("color");b(this).attr("data-index",e).css({"background-color":g})});this.options.showControls||this.$components.hide();
this.options.showArrows||this.$arrows.hide();this.fn=d.onFrame||function(){};this.readSettings();if(this.resX&&this.resY)this.ratio=this.resX/this.framesX/(this.resY/this.framesY);if(this.options.fixedOnBadIE)if(navigator.appName.indexOf("Internet Explorer")!==-1)(this.badBrowser=navigator.appVersion.indexOf("MSIE 9")===-1&&navigator.appVersion.indexOf("MSIE 1")===-1)&&this.$arrows.parent().addClass("light");this.bindings();this.trimPath=this.$components.find(".view360-trims li").eq(this.options.initialTrim).addClass("active").data("trim-path");
this.backgroundSuffix=this.$components.find(".view360-backgrounds li").eq(this.options.initialBackground).addClass("active").data("background-id");d=this.$components.find(".view360-color-picker li").eq(this.options.initialColor);this.changeColor(d);d.addClass("active");this.preload=this.preloadHtml();this.render()};f.prototype.readSettings=function(){var d=this,e=b(window).width();this.$el.find(".qualityChoser").each(function(g,h){g=b(h);h=parseInt(g.data("min-width"),10)||0;var i=parseInt(g.data("max-width"),
10)||9999999999999;if(e>=h&&e<i){d.quality=g.val();d.extension=g.data("extension");d.framesX=parseInt(g.data("columns"),10);d.framesY=parseInt(g.data("rows"),10);d.framesCount=d.framesX*d.framesY;d.resX=parseInt(g.data("asset-width"),10);d.resY=parseInt(g.data("asset-height"),10);return false}})};f.prototype.preloadHtml=function(){return"<div class='view360-preloader'><div class='view360-spinner-container'></div></div>"};f.prototype.bindings=function(){var d=this,e,g;this.$arrows.on("mousedown",function(){var h=
b(this);d.badBrowser||(e=setInterval(function(){if(h.data("direction")==="right"){d.$player.spritespin("animate",false);d.$player.spritespin("prev")}else{d.$player.spritespin("animate",false);d.$player.spritespin("next")}},60))}).on("mouseup mouseleave",function(){if(!d.badBrowser){clearInterval(e);d.fireRotateMetrics();GWS&&GWS.broadcast("360-view-rotate")}});this.$components.on("click","li",function(){var h=b(this),i=h.parent();if(!h.hasClass("active")){i.find("li").removeClass("active");h.addClass("active");
if(i.hasClass("trims")){d.trimPath=h.data("trim-path");d.$components.find(".view360-modifier-label")&&d.$components.find(".view360-modifier-label").css("display")==="block"&&d.$components.find(".view360-modifier-label").text(h.find(".picker-title").text());if(!d.firedRim){a.send(document.body,"s550-metrics",{action:"click",name:"mr-360-rim-interaction"});d.firedRim=true}GWS&&GWS.broadcast("360-view-wheel",h)}else if(i.hasClass("backgrounds"))d.backgroundSuffix=h.data("background-id");else if(i.hasClass("colors")){d.changeColor(h);
if(!d.firedColor){a.send(document.body,"s550-metrics",{action:"click",name:"mr-360-colorizor-interaction"});d.firedColor=true}GWS&&GWS.broadcast("360-view-color",h)}d.preload=d.preloadHtml();d.render()}});if(/android/i.test(navigator.userAgent)&&/webkit/i.test(navigator.userAgent)||/chrome/i.test(navigator.userAgent))this.$player.on("touchstart",function(h){h.preventDefault()});this.$player.on("mousedown",function(){if(!d.badBrowser){d.$player.spritespin("animate",false).addClass("playing");d.options.autoHideControls&&
d.$components.stop(false,true).fadeOut();b(window).on("mouseup",function(){d.$player.removeClass("playing");d.options.autoHideControls&&d.$components.stop(false,true).fadeIn();d.fireRotateMetrics();GWS&&GWS.broadcast("360-view-rotate")})}});this.$player.on("touchstart",function(){d.fireRotateMetrics()});b(window).on("resize",function(){clearTimeout(g);g=setTimeout(function(){d.readjust()},200)})};f.prototype.render=function(d){var e=this,g=this.$el.width();d=b.extend({},d);d.source=this.trimPath+
this.folder+this.quality+this.filename+this.backgroundSuffix+this.extension;this.currentOptions={width:g,height:g/e.ratio,resolutionX:g*e.framesX,resolutionY:g/e.ratio*e.framesY,resX:e.resX,resY:e.resY,frames:this.framesCount,framesX:this.framesX,frame:d.frame||this.$player.hasClass("spritespin-instance")?this.$player.spritespin("frame"):0,animate:false,sense:d.direction||e.options.direction,source:d.source,preloadHtml:this.preload};this.destroy()};f.prototype.changeColor=function(d){this.folder=
d.data("folder");this.filename=d.data("filename");this.$components.find(".picker-label")&&this.$components.find(".picker-label").css("display")==="block"&&this.$components.find(".picker-label").text(d.find(".picker-title").text())};f.prototype.destroy=function(){var d=this;this.$player.removeClass("light");if(this.badBrowser){d.$player.addClass("light");a.send(document.body,"view360-light-init",{element:d.$player,options:d.currentOptions})}else{this.$player.spritespin("destroy");this.$player.spritespin(this.currentOptions)}};
f.prototype.readjust=function(){var d=this;if(this.badBrowser)a.send(document.body,"view360-light-reset",{element:d.$player,options:d.currentOptions});else{this.preload=undefined;this.render(this.currentOptions)}};f.prototype.fireRotateMetrics=function(){if(!this.firedSpin){a.send(document.body,"s550-metrics",{action:"click",name:"mr-360-spin-interaction"});this.firedSpin=true}};a.listen(document.body,"view360-apply",function(d,e){c=new f(e)});a.listen(document.body,"view360-remove",function(){c.destroy()})});
jQuery(function(){function a(){i=h=1;b()}function b(){h++;i++;var r={x:0,y:0};r.y=(Math.ceil(h/l)-1)*s.height();r.x=(i-1)*s.width();v.css({left:-1*r.x+"px",top:-1*r.y+"px"});if(i>=4)i=0}function c(){h--;i--;if(i<=0)i=4;var r={x:0,y:0};r.y=(Math.ceil(h/l)-1)*s.height();r.x=(i-1)*s.width();v.css({left:-1*r.x+"px",top:-1*r.y+"px"})}function f(){h=36;i=4;c()}function d(){if(s!==undefined&&s.length>0&&v!==undefined&&v.length>0){p=k=false;i=h=1;j=0;v.css({top:0,left:0})}}function e(){s.find(".draggable").on("mousedown",
function(r){r.preventDefault();p=k=true;m=r.clientX});s.find(".draggable").on("mouseup",function(r){r.preventDefault();m=p=k=false});u.on("mousedown","div",function(r){p=false;r.preventDefault();var w=jQuery(this).data("direction");if(w==="left")t=setInterval(function(){if(h<36){b();k=false;setTimeout(function(){k=true},50)}else if(h===36){i=4;a()}},100);else if(w==="right")t=setInterval(function(){if(h<1)h=1;if(h>1){c();k=false;setTimeout(function(){k=true},50)}else h===1&&f()},100);r.stopPropagation()});
u.find("div").on("mouseup",function(r){k=p=false;r.preventDefault();clearInterval(t);r.stopPropagation()});u.find("div").on("mouseleave",function(r){k=p=false;r.preventDefault();clearInterval(t);r.stopPropagation()});s.find(".draggable").on("mousemove",function(r){r.preventDefault();if(k===true){n=r.clientX;if(n>m&&n-m>50)if(h>1){c();k=false;setTimeout(function(){if(p)k=true},30)}else h===1&&f();else if(n<m&&h<=36&&m-n>50)if(h===36){i=4;a()}else{b();k=false;setTimeout(function(){if(p)k=true},30)}}});
jQuery(window).on("resize",function(){s.height(s.width()/q);v.width(s.width()*l);d()})}function g(r,w){if(o)v.attr("src",w.source);else{s=r;s.html('<div class="draggable"></div>');v=jQuery("<img/>");v.attr("src",w.source);s.find(".draggable").html(v);s.height(s.width()/q);v.width(s.width()*l);e();o=true}}var h=1,i=1,j=0,l=4,k=false,m=0,n=false,q=2.23,p=false,o=false,t=false,u=jQuery(".view360-arrows"),s,v;ngbs._message_bus.listen(document.body,"view360-light-init",function(r,w){g(w.element,w.options)});
ngbs._message_bus.listen(document.body,"view360-light-reset",function(r,w){o?d():g(w.element,w.options)})});
ngbs.widget("reveal-slider",function(a){function b(e){if(!e.$el.hasClass("reveal-slider-enabled")){this.$slider=e.$el;this.options=c.extend({},d,e);this.onDrag=e.onDrag;this.$scroller=this.$slider.find(".reveal-scroller");this.$dragger=this.$scroller.find(".scroller-dragger");this.$limits=this.$scroller.find(".scroller-limit");this.$background=this.$slider.find(".reveal-img").eq(0);this.rangeStart=this.$slider.data("rangestart")||0;this.rangeEnd=this.$slider.data("rangeend")||100;this.lastPos=this.initPos=
this.$slider.data("initposition")||0;this.firedMetric=false;this.init()}}var c=jQuery,f,d={maskSelector:"*:first"};b.prototype.init=function(){this.$slider.addClass("reveal-slider-enabled");this.drag(0);this.setHandlers()};b.prototype.setHandlers=function(){var e=this;this.$dragger.on("mousedown touchstart",function(g){g.preventDefault();g.stopPropagation();GWS&&GWS.broadcast("reveal-slider-scroll-mousedown");c("body").on("mouseup touchend",function(){e.$dragger.removeClass("active");c("body").off("mousemove.reveal-slider, touchmove.reveal-slider");
GWS&&GWS.broadcast("reveal-slider-scroll-mouseup")}).on("mousemove.reveal-slider, touchmove.reveal-slider",function(h){h.preventDefault();e.$dragger.addClass("active");e.calculateDrag(h);if(!e.firedMetric){a.send(document.body,"s550-metrics",{action:"click",name:"mr-convertible-interaction"});e.firedMetric=true}GWS&&GWS.broadcast("reveal-slider-scroll-mousemove")})})};b.prototype.calculateDrag=function(e){var g;g=e.originalEvent.clientX||e.clientX||e.originalEvent.touches[0].clientX||e.touches[0].clientX||
e.originalEvent.pageX||e.pageX||e.originalEvent.touches[0].pageX||e.touches[0].pageX;e=this.$scroller.outerWidth();var h=this.$dragger.outerWidth(),i=h/2;g=g-this.$scroller.offset().left-i;g=g>=e-h?e-h:g<=0?0:g;this.drag(g)};b.prototype.drag=function(e){var g=e*100/this.$scroller.outerWidth();e=e*100/(this.$scroller.outerWidth()-this.$dragger.outerWidth());var h=e*(this.rangeEnd-this.rangeStart)/100+this.rangeStart;this.$dragger.css("left",g+"%");this.play(h);this.lastPos=h;typeof this.onDrag==="function"&&
this.onDrag({value:e,bounded:h})};b.prototype.play=function(e){this.$background.css("left",e+"%").find(this.options.maskSelector).css("left",-e+"%")};a.listen(document.body,"revealer-update",function(){f.play(f.lastPos)});a.listen(document.body,"revealer-config",function(e,g){f=new b(g)})});
ngbs.widget("back-to-top-button",function(a){function b(f){this.$widget=f.$el;this.$button=this.$widget.find(".btt-button");this.duration=f.duration||500;this.$button.on("click",function(){c("body, html").animate({scrollTop:0},self.duration);GWS.broadcast("back-to-top")})}var c=jQuery;a.listen(document.body,"back-to-top-config",function(f,d){new b(d)})});
ngbs.widget("wechat-barcode",function(){function a(){c.on("click",function(){f.hasClass("show")?f.removeClass("show"):f.addClass("show")})}var b=jQuery,c=b(".share-by-wechat"),f=b(".wechat-qrcode");a()});
ngbs.widget("viewpoints",function(a){function b(d){this.viewpoints=d.$el;this.options=c.extend({},f,d);this.init(d);return this.viewpoints}var c=jQuery,f={offset:0,autoUpdate:true,forceUpdate:false};b.prototype.init=function(d){this.active=true;this.offsets=[];this.heights=[];this.triggered=[];this.inside=d.inside;this.before=d.before;this.after=d.after;this.crossing=d.crossing;this.update();this.bindHandlers();this.events();c(window).trigger("scroll")};b.prototype.bindHandlers=function(){var d=this,
e=c(window),g,h=[],i=[],j,l,k;for(g=0;g<this.viewpoints.length;g++){h.push(false);i.push(false)}if(this.options.autoUpdate){e.on("resize.viewpoints, load",function(){d.update()});this.options.forceUpdate&&e.on("scroll.viewpoints",function(){++g%3===0&&d.update()})}e.on("scroll.viewpoints",function(){var m={};if(d.active){j=e.scrollTop()+d.offset;if(l!==j){if(j>l)k="down";else if(j<l)k="up";m={direction:k,scrollTop:j-d.offset,scroll:j};d.viewpoints.each(function(n,q){if(d.inside&&j>=d.offsets[n]&&
j<=d.offsets[n]+d.heights[n]&&!d.triggered[n]){c.each(d.triggered,function(p){d.triggered[p]=false});d.triggered[n]=true;m.$el=c(q);d.inside(d,m)}if(d.before&&j<d.offsets[n]){m.$el=c(q);d.before(d,m)}if(d.after&&j>d.offsets[n]+d.heights[n]){m.$el=c(q);d.after(d,m)}if(d.crossing)if(j>=d.offsets[n]&&k==="down"&&!h[n]){m.$el=c(q);d.crossing(d,m);h[n]=true;i[n]=false}else if(j<=d.offsets[n]&&k==="up"&&!i[n]){m.$el=c(q);d.crossing(d,m);h[n]=false;i[n]=true}});l=j}}})};b.prototype.destroy=function(){c(window).off("scroll.viewpoints")};
b.prototype.update=function(){var d=this;this.offsets.length=0;this.heights.length=0;this.triggered.length=0;this.viewpoints.each(function(e,g){d.offsets.push(c(g).offset().top);d.heights.push(c(g).outerHeight());d.triggered.push(false)});this.offset=typeof this.options.offset==="function"?this.options.offset():this.options.offset||0};b.prototype.enable=function(){this.active=false};b.prototype.disable=function(){this.active=true};b.prototype.events=function(){var d=this;a.listen(document.body,"viewpoints-update",
function(){d.update()});a.listen(document.body,"viewpoints-enable",function(){d.enable()});a.listen(document.body,"viewpoints-disable",function(){d.disable()})};a.listen(document.body,"viewpoints",function(d,e){new b(e)})});
ngbs.widget("parallax",function(a){function b(g){this.options=c.extend({},e,g);this.$el=g.$el||c();this.$container=g.cont||c("body");this.init()}var c=jQuery,f,d=0,e={adjustSize:false,heightcrop:0.875,animate:true,animateSpeed:180,offset:0};b.prototype.init=function(){var g=this,h,i;this.$el.wrap("<div class='parallax-container' />");this.$parallax=this.$el.parent(".parallax-container");this.$insideImages=this.$parallax.find("img");h=this.$insideImages.length;this.active=true;if(h){this.insideImagesCount=
0;this.$insideImages.each(function(j,l){c("<img/>").on("load",function(){g.insideImagesCount++}).attr("src",l.src)});i=setInterval(function(){if(g.insideImagesCount===h){clearInterval(i);g.updateView();g.bindings()}},500)}else{g.updateView();g.bindings()}};b.prototype.bindings=function(){var g=this,h;c(window).on("resize",function(){clearTimeout(h);h=setTimeout(function(){g.updateView()},500)}).on("scroll",function(){if(g.active){d=c(window).scrollTop()-g.options.offset;g.parallax(d)}})};b.prototype.parallax=
function(g){var h=this;this.$parallax.each(function(i,j){var l=c(j),k,m,n=l.offset().top-h.wHeight;i=l.children().eq(0);j=l.height();k=h.wHeight+j;m=i.height();if(g>n&&g<n+l.outerHeight()+h.wHeight){l=-1*(g-l.offset().top-j);k=100-l*100/k;j=(m-j)*k/100;h.options.animate?i.css("position","relative").stop().animate({top:-j+"px"},h.options.animateSpeed):i.css({position:"relative",top:-j+"px"})}})};b.prototype.disable=function(){this.active=false};b.prototype.enable=function(){this.active=true};b.prototype.updateView=
function(){var g=this,h;this.wHeight=c(window).height();this.wWidth=c(window).width();if(g.options.heightcrop!==1){h=g.options.heightcrop*g.$el.height();g.$parallax.css({height:h})}this.parallax(d);a.send(document.body,"paralax-update-view-done")};a.listen(document.body,"parallax-refresh",function(){f.updateView()});a.listen(document.body,"parallax-enable",function(){f.enable()});a.listen(document.body,"parallax-disable",function(){f.disable()});a.listen(document.body,"parallax",function(g,h){if("ontouchstart"in
document.body||"ontouchstart"in window||"ontouchstart"in document.documentElement)return false;f=new b(h)})});
ngbs.widget("smooth-scrolling",function(a){function b(e){this.options=c.extend({},d,e);navigator.appVersion.indexOf("Mac")>-1||this.bindings()}var c=jQuery,f,d={speed:200,distance:150,deltaScalar:3,easing:"linear"};b.prototype.bindings=function(){var e=this;c(window).on("mousewheel.scrolling",function(g){e.wheel(g.originalEvent)})};b.prototype.wheel=function(e){var g=this,h=0;e.preventDefault();if(e.wheelDelta)h=e.wheelDelta/(g.options.deltaScalar*40);else if(e.detail)h=-e.detail/g.options.deltaScalar;
c("html, body").stop(false,false).animate({scrollTop:c(window).scrollTop()-g.options.distance*h},g.options.speed,g.options.easing)};b.prototype.disable=function(){c(window).off("mousewheel.scrolling")};b.prototype.enable=function(){this.bindings()};a.listen(document.body,"smooth-scrolling",function(e,g){g=g||{};f=new b(g)});a.listen(document.body,"smooth-scrolling-disable",function(){f.disable()});a.listen(document.body,"smooth-scrolling-enable",function(){f.enable()})});
ngbs.widget("section-collapser",function(a){function b(d){this.$el=d.$el;this.options=c.extend({},f,d);this.init();this.bindings()}var c=jQuery,f={speed:400};b.prototype.init=function(){this.$el.each(function(d,e){d=c(e);e=false;if(d.data("collapsible")){if(d.data("collapsed")===true)e=true;d.wrapInner("<div class='collapsible' style='display: "+(e?"none":"block")+"'/>");d.prepend("<div class='section-collapser "+(e?"collapsed":"")+"'>"+(d.data("title")?d.data("title"):d[0].id)+"<div class='collapser-status' /></div>")}});
this.$collapserBtn=this.$el.find(".section-collapser");this.$collapserArea=this.$el.find(".collapsible")};b.prototype.bindings=function(){var d=this;this.$collapserBtn.on("click",function(e){e.preventDefault();c(this).toggleClass("collapsed").next(".collapsible").slideToggle(d.options.speed,function(){typeof d.options.onChange==="function"&&d.options.onChange()})})};b.prototype.deactivate=function(){this.$el.find(".section-collapser").hide();this.$el.find(".collapsible").show()};b.prototype.activate=
function(){this.$el.find(".section-collapser").show();this.$el.find(".collapsible").hide()};a.listen(document.body,"section-collapser",function(d,e){new b(e)})});
var GWS=function(){var a=jQuery,b={},c=false;return{listen:function(f,d){if(typeof d=="function"){b[f]=d;return true}return false},broadcast:function(f,d){if(typeof d=="undefined")d={};var e;if(f in b){try{if(d instanceof HTMLElement)d=a(d)}catch(g){}if(d instanceof jQuery){e=a(d).data();d=a(d).attr("id");if(typeof d!=="undefined"&&d!==false)e=a.extend(e,{id:d})}else e=d;e.event=f;b[f](e);return true}return false},ignore:function(f){if(f in b){delete b[f];return true}return false},init:function(){if(!c){this.$widgets=
a(".GWS-widget");if(this.$widgets.length){this.$widgets.wrapAll('<div id="s550-container"></div>');window.ngbs._message_bus.send(document.body,"page-init");a.each(".feature-buttons.open",function(){a(this).attr("data-feature-id",a(this))})}c=true}}}}();

var s550eventmap={};function flagEventFired(c){s550eventmap[c]=true}function hasEventFired(c){return!(s550eventmap[c]===undefined||s550eventmap[c]===false)}function showShareThisLink(c,a){$.publish("/analytics/link/",{title:"share this",nameplate:"none",link:true,type:"e",onclicks:"share this:"+c});window.open(a)}function showFollowLink(c,a){$.publish("/analytics/link/",{title:"social:follow",nameplate:"none",link:true,type:"e",onclicks:"social:follow:"+c,events:"event4"});window.open(a)}
function publishS550Link(c,a,h,g){if(g===undefined)$.publish("/analytics/link/",{title:c,link:true,type:a,onclicks:h});else if(!hasEventFired(g)){flagEventFired(g);$.publish("/analytics/link/",{title:c,link:true,type:a,onclicks:h})}}
$(function(){GWS.init();GWS.listen("features-button",function(e){var b="",f="";if(e.featuresId)if(e.featuresId==="performance"){b=f="reveal:performance:read more:ford mustang";publishS550Link("reveal:5:performance:read more","o",b,f)}else if(e.featuresId==="tech"){b=f="reveal:tech:read more:ford mustang";publishS550Link("reveal:6:tech:read more","o",b,f)}});GWS.listen("gallery-slider-image",function(){publishS550Link("reveal:1:gallery:image","o","reveal:gallery:image:ford mustang","gallery-slider-image")});
GWS.listen("gallery-slider-arrow",function(){publishS550Link("reveal:1:gallery:scroll","o","reveal:gallery:scroll:ford mustang","gallery-slider-arrow")});GWS.listen("360-view-rotate",function(){publishS550Link("reveal:2:360:spin","o","reveal:360:spin:ford mustang","360-view-rotate")});GWS.listen("360-view-color",function(){publishS550Link("reveal:2:360:colorizor","o","reveal:360:colorizor:ford mustang","360-view-color")});GWS.listen("360-view-wheel",function(){publishS550Link("reveal:2:360:select rim",
"o","reveal:360:select rim:ford mustang","360-view-wheel")});GWS.listen("zoom-fullscreen-save",function(){publishS550Link("reveal:1:gallery:image:download","d","reveal:gallery:image:download:ford mustang","zoom-fullscreen-save")});GWS.listen("reveal-slider-scroll-mousemove",function(){publishS550Link("reveal:7:convertible","o","reveal:convertible:ford mustang","reveal-slider-scroll-mousemove")});if($("#s550-billboard").length>0){$.each(["facebook","twitter","googleplus","weibo"],function(e,b){$("a[data-id='"+
b+"']").each(function(f,d){$(d).unbind();var i=$(d).data("url");f===0?$(d).click(function(){showShareThisLink(b,i);return false}):$(d).click(function(){showFollowLink(b,i);return false})})});$("a.share-by-email").each(function(e){var b=$(this),f=e===0?"share this":"social:follow",d=e===0?"share this:email":"social:follow:email";b.unbind();b.on("click",function(){$.publish("/analytics/link/",{title:f,nameplate:"none",link:true,type:"e",onclicks:d,events:"event4"});window.location.href="mailto:"+b.data("email")})});
var c=["gallery","features"];$("ul.nav-content").find("li > a").each(function(){var e=$(this),b=$(this).attr("href");$.each(c,function(f,d){if(b==="#s550-"+d){$(e).on("click",function(){publishS550Link("reveal:0:"+d,"o","reveal:"+d+":ford mustang","subnav:"+d)});return false}})});var a=document.querySelectorAll(".get-updates-link");if(a.length>=2){if(typeof a[0]!=="undefined"){var h=a[0].getAttribute("href");a[0].onclick=function(){window.location=h}}if(typeof a[1]!=="undefined"){var g=a[1].getAttribute("href");
a[1].onclick=function(){window.location=g}}}}});
