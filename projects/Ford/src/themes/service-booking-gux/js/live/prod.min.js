
var SB=SB||{};
(function(a){SB.overlay={init:function(){a(".service-booking-overlay").not("#content-modal").on("click",function(b){b.preventDefault();SB.overlay.scrollToTop();b=a(this).attr("href");SB.keyword=a(this).data("sb-keyword");SB.serviceURL=a(this).data("sb-url");a.ajax({url:b,success:function(c){SB.overlay.modalSuccess(c)},error:function(){SB.overlay.modalError()}})});SB.overlay.modalClose()},modalSuccess:function(b){a("#content-modal .content").html(b);SB.templateWrap=a(".content-col");SB.dealers.init();
a("#content-modal").foundation("reveal","open",{animationSpeed:100,animation:"fade"})},modalError:function(){a("#content-modal .content").html('<div class="row"><div class="columns"><div class="content-col"><h3>An Error Occurred</h3><p>There seems to be a problem.</p></div></div></div>');a("#content-modal").foundation("reveal","open",{animationSpeed:100,animation:"fade"})},modalClose:function(){a("#content-modal .close-reveal-modal").on("click",function(b){b.preventDefault();a(".reveal-modal").foundation("reveal",
"close");setTimeout(function(){a("#content-modal .content").html("")},500);a("body").focus()})},scrollToTop:function(){a("html, body").animate({scrollTop:0},400)}};a(function(){SB.overlay.init()})})(jQuery);

var SB=SB||{};
(function(a){SB.dealers={init:function(){if(a(".service-booking-overlay").length){this.checkPreferredDealer();this.menuURL=a("#xtimeURL").embeddedData();this.authorisedFilter=this.menuURL.authorisedFilter||"";this.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);this.urlAtrrib="&provider=FORDAUPORTAL&keywordParam=null"}},fetchData:function(d,b,c){SB.templateWrap&&SB.templateWrap.addClass("loading");a.ajax({url:d,async:true,dataType:"json",success:function(e){if(e.length>
0||typeof e.dealerCode!=="undefined")b(e);else{a(".search-error").show();SB.templateWrap.removeClass("loading")}},error:function(e,f){c(d,e,f)}})},renderDealerTemplate:function(d,b){if(d){a("#preferred-dealer-template").tmpl(b).appendTo(".preferred-dealer",SB.templateWrap);SB.templateWrap.removeClass("loading")}else{a(".dealer-search").show();a(".search-error").show();SB.templateWrap.removeClass("loading");d=a(".dealer-search");a("form",d).submit(function(c){c.preventDefault();SB.dealers.formSubmit()})}},
renderSearchListTemplate:function(d,b){if(d){a("#search-template").tmpl(b).appendTo("#search-items",SB.templateWrap);SB.templateWrap.removeClass("loading");b.length===1?a(".pagination").hide():a(".pagination").show();a.each(b,function(c){if(b[c].fullXtimeParticipant==="Y"){var e=SB.serviceURL.indexOf("?")==-1?"?":"&";a(".search-results .request-service").eq(c).attr("href",SB.serviceURL+e+"dcode="+b[c].dealerCode+"&keyword="+SB.keyword).attr("data-dcode",b[c].dealerCode);a(".search-results .no-service").eq(c).hide()}else if(b[c].fullXtimeParticipant===
null)if(SB.dealers.isMobile){e=this.mobileURL;if(e===""||e===null)a(".search-results .request-service").eq(c).hide();else{a(".search-results .request-service").eq(c).attr("href",e+SB.dealers.urlAtrrib);a(".search-results .no-service").eq(c).hide()}}else{e=this.consumerURL;if(e===""||e===null)a(".search-results .request-service").eq(c).hide();else{e=SB.serviceURL.indexOf("?")==-1?"?":"&";a(".search-results .request-service").eq(c).attr("href",SB.serviceURL+e+"dcode="+b[c].dealerCode+"&keyword="+SB.keyword).attr("data-dcode",
b[c].dealerCode+ +SB.dealers.urlAtrrib);a(".search-results .no-service").eq(c).hide()}}else a(".search-results .request-service").eq(c).hide()});a(".search-results").after("<a href='#' class='btn change-dealer results'>Change Dealer</a>");a(".listing-details .results").show();a("div.pagination").pagination({callback:function(c,e){a(".listing-details .results").html("Results : "+e.range.start+"-"+e.range.end+" of "+e.count)}});a(".btn.request-service").on("click",function(c){c.preventDefault();c=a(this).attr("href");
var e=a(this).data("dcode");SB.dealers.requestServiceTracking(e,c)})}else{a(".search-error").show();SB.templateWrap.removeClass("loading")}},requestServiceTracking:function(d,b){var c={type:"o"};c.link=c.title=_da.pname+":request service";c.onclicks="service:book online";c.pname=_da.pname;s.prop1=s.eVar1=d;a.publish("/analytics/link/",c);window.location.href=b},templateError:function(d){d={error:"An error has occurred: "+d.statusText};a("#dealer-template-error").tmpl(d).appendTo(SB.templateWrap)},
templateErrorSearch:function(d){d={error:"An error has occurred: "+d.statusText};a("#search-template-error").tmpl(d).appendTo(SB.templateWrap)},checkPreferredDealer:function(){a(".dealer-search").hide();if(a.cookie("dfy.dl"))this.populatePrefDealer();else a.cookie("sp.pc")?setTimeout(function(){SB.dealers.nearestDealer()},100):this.searchDealer()},populatePrefDealer:function(){var d=a.cookie("dfy.dl");this.fetchData(SB.restServices["dealer.code"].replace("{site}",SB.site).replace("{code}",d)+SB.dealers.authorisedFilter,
function(b){if(b.fullXtimeParticipant==="Y"){SB.dealers.renderDealerTemplate(true,b);a(".preferred-dealer .large-text").hide();a(".preferred-dealer .large-text.xtime").show();a(".alert-text").hide();var c=SB.serviceURL.indexOf("?")==-1?"?":"&";a(".request-service").attr("href",SB.serviceURL+c+"dcode="+b.dealerCode+"&keyword="+SB.keyword);a(".btn.request-service").on("click",function(f){f.preventDefault();f=a(this).attr("href");SB.dealers.requestServiceTracking(b.dealerCode,f)})}else if(b.fullXtimeParticipant===
null)if(SB.dealers.isMobile){var e=b.mobileURL;if(e===""||e===null){SB.dealers.renderDealerTemplate(true,b);a(".preferred-dealer .large-text").hide();a(".preferred-dealer .large-text.noxtime").show();a(".request-service").hide();a(".change-dealer.results").hide()}else{SB.dealers.renderDealerTemplate(true,b);a(".preferred-dealer .large-text").hide();a(".preferred-dealer .large-text.xtime").show();a(".alert-text").hide();c=SB.serviceURL.indexOf("?")==-1?"?":"&";a(".request-service").attr("href",e+SB.dealers.urlAtrrib);
a(".btn.request-service").on("click",function(f){f.preventDefault();f=a(this).attr("href");SB.dealers.requestServiceTracking(b.dealerCode,f)})}}else{c=b.consumerURL;if(c===""||c===null){SB.dealers.renderDealerTemplate(true,b);a(".preferred-dealer .large-text").hide();a(".preferred-dealer .large-text.noxtime").show();a(".request-service").hide();a(".change-dealer.results").hide()}else{SB.dealers.renderDealerTemplate(true,b);a(".preferred-dealer .large-text").hide();a(".preferred-dealer .large-text.xtime").show();
a(".alert-text").hide();c=SB.serviceURL.indexOf("?")==-1?"?":"&";a(".request-service").attr("href",SB.serviceURL+c+"dcode="+b.dealerCode+"&keyword="+SB.keyword+SB.dealers.urlAtrrib);a(".btn.request-service").on("click",function(f){f.preventDefault();f=a(this).attr("href");SB.dealers.requestServiceTracking(b.dealerCode,f)})}}else{SB.dealers.renderDealerTemplate(true,b);a(".preferred-dealer .large-text").hide();a(".preferred-dealer .large-text.noxtime").show();a(".request-service").hide();a(".change-dealer.results").hide()}a(".change-dealer").on("click",
function(f){f.preventDefault();SB.dealers.searchDealer()})},function(b,c){SB.dealers.renderDealerTemplate(false,null,c)})},nearestDealer:function(){var d=a.cookie("sp.pc"),b=a(".dealer-search");b=a("form",b);var c=SB.restServices["dealer.byAddressUrl"].replace("{site}",SB.site).replace("{location}",d)+SB.dealers.authorisedFilter;a(".your-location").show().find("span").html(d);SB.dealers.fetchData(c,function(e){a(".dealer-search").hide();a(".search-results").show();SB.dealers.renderSearchListTemplate(true,
e);a(".change-dealer").on("click",function(f){SB.dealers.changeDealerBtn(f)})},function(e,f){SB.dealers.renderSearchListTemplate(false,null,f)});b.submit(function(e){e.preventDefault();SB.dealers.formSubmit()})},searchDealer:function(){var d=a(".dealer-search");a(".preferred-dealer").hide();a(".search-results").hide();d.show();a("form",d).submit(function(b){b.preventDefault();SB.dealers.formSubmit()})},formSubmit:function(){a(".search-error").hide();var d=a(".dealer-search"),b=a("#sb-dealerlocation").val(),
c=a("#sb-dealername").val();if(b===""&&c==="")a(".search-error",d).show();else{a(".reveal-modal .item").remove();SB.dealers.runSearch(b,c)}},runSearch:function(d,b){var c=SB.restServices["dealer.name"].replace("{site}",SB.site).replace("{name}",b)+SB.dealers.authorisedFilter,e=SB.restServices["dealer.byAddressUrl"].replace("{site}",SB.site).replace("{location}",d)+SB.dealers.authorisedFilter,f=SB.restServices["dealer.byLocationName"].replace("{site}",SB.site).replace("{location}",d).replace("{name}",
b)+SB.dealers.authorisedFilter;a(".dealer-name").hide();a(".your-location").hide();b&&a(".dealer-name").show().find("span").html(b);d&&a(".your-location").show().find("span").html(d);if(b!==""&&d!==""&&b!==undefined){a("reveal-modal .item").remove();SB.dealers.fetchData(f,function(h){a(".dealer-search").hide();a(".search-results").show();SB.dealers.renderSearchListTemplate(true,h);a(".change-dealer").on("click",function(g){SB.dealers.changeDealerBtn(g)})},function(h,g){SB.dealers.renderSearchListTemplate(false,
null,g)})}else if(b!==""&&d===""){a("reveal-modal .item").remove();SB.dealers.fetchData(c,function(h){a(".dealer-search").hide();a(".search-results").show();SB.dealers.renderSearchListTemplate(true,h);a(".change-dealer").on("click",function(g){SB.dealers.changeDealerBtn(g)})},function(h,g){SB.dealers.renderSearchListTemplate(false,null,g)})}else if(b===""&&d!==""||b===undefined&&d!==""){a("reveal-modal .item").remove();SB.dealers.fetchData(e,function(h){a(".dealer-search").hide();a(".search-results").show();
SB.dealers.renderSearchListTemplate(true,h);a(".change-dealer").on("click",function(g){SB.dealers.changeDealerBtn(g)})},function(h,g){SB.dealers.renderSearchListTemplate(false,null,g)});d=a(".dealer-search");a("form",d)}},changeDealerBtn:function(d){d.preventDefault();SB.overlay.scrollToTop();a(".dealer-search").show();a(".search-results").hide();a(".change-dealer.results").remove()}};a(function(){var d=a("#common-config").embeddedData();SB.site=d.site;SB.restServices=a("#rest-services").embeddedData();
if(a(".service-booking .iframe").length>0){a(".service-booking .iframe").addClass("loading");a(".service-booking .iframe iframe").on("load",function(){a(".service-booking .iframe").removeClass("loading")})}})})(jQuery);

(function(d,i,j,h){function g(a,b){this.options=d.extend({},k,b);this._container=d("#"+this.options.containerID);if(this._container.length){this.jQwindow=d(i);this.jQdocument=d(j);this._holder=d(a);this._nav={};this._first={};this._previous=d(this.options.previous);this._next=d(this.options.next);this._last={};this._items=this._container.children(":visible");this._itemsShowing=d([]);this._itemsHiding=d([]);this._numPages=Math.ceil(this._items.length/this.options.perPage);this._currentPageNum=this.options.startPage;
this._clicked=false;this._cssAnimSupport=this.getCSSAnimationSupport();this.init()}}var f=null,k={containerID:"search-items",previous:"Prev",next:"Next",startPage:1,perPage:3,midRange:5,startRange:1,endRange:1,delay:50,direction:"forward",animation:"",fallback:0,callback:h};g.prototype={constructor:g,getCSSAnimationSupport:function(){var a=false,b="Webkit Moz O ms Khtml".split(" "),c="";c=this._container.get(0);if(c.style.animationName)a=true;if(a===false)for(var e=0;e<b.length;e++)if(c.style[b[e]+
"AnimationName"]!==h){c=b[e];c.toLowerCase();a=true;break}return a},init:function(){this.setStyles();this.setNav();this.paginate(this._currentPageNum)},setStyles:function(){d("<style>.pag-invisible { visibility: hidden !important; } .pag-hidden { display: none !important; }</style>").appendTo("head");this._cssAnimSupport&&this.options.animation.length?this._items.addClass("animated pag-hidden"):this._items.hide()},setNav:function(){var a=this.writeNav();this._holder.each(this.bind(function(b,c){var e=
d(c);e.html(a);this.cacheNavElements(e,b);this.bindNavHandlers(b);this.disableNavSelection(c)},this))},writeNav:function(){var a=1,b;for(b=this.writeBtn("first")+this.writeBtn("previous");a<=this._numPages;a++){if(a===1&&this.options.startRange===0)b+="<span>...</span>";b+=a>this.options.startRange&&a<=this._numPages-this.options.endRange?"<a href='#' class='pag-hidden'>":"<a>";b+=a;b+="</a>";if(a===this.options.startRange||a===this._numPages-this.options.endRange)b+="<span>...</span>"}b+=this.writeBtn("next")+
this.writeBtn("last")+"</div>";return b},writeBtn:function(a){return this.options[a]!==false&&!d(this["_"+a]).length?"<a class='pag-"+a+"'>"+this.options[a]+"</a>":""},cacheNavElements:function(a,b){this._nav[b]={};this._nav[b].holder=a;this._nav[b].first=this._first.length?this._first:this._nav[b].holder.find("a.pag-first");this._nav[b].previous=this._previous.length?this._previous:this._nav[b].holder.find("a.pag-previous");this._nav[b].next=this._next.length?this._next:this._nav[b].holder.find("a.pag-next");
this._nav[b].last=this._last.length?this._last:this._nav[b].holder.find("a.pag-last");this._nav[b].fstBreak=this._nav[b].holder.find("span:first");this._nav[b].lstBreak=this._nav[b].holder.find("span:last");this._nav[b].pages=this._nav[b].holder.find("a").not(".pag-first, .pag-previous, .pag-next, .pag-last");this._nav[b].permPages=this._nav[b].pages.slice(0,this.options.startRange).add(this._nav[b].pages.slice(this._numPages-this.options.endRange,this._numPages));this._nav[b].pagesShowing=d([]);
this._nav[b].currentPage=d([])},bindNavHandlers:function(a){var b=this._nav[a];b.holder.bind("click.pagination",this.bind(function(c){var e=this.getNewPage(b,d(c.target));if(this.validNewPage(e)){this._clicked=true;this.paginate(e)}c.preventDefault()},this));this._previous.length&&this._previous.bind("click.pagination",this.bind(function(){var c=this._currentPageNum-1;if(this.validNewPage(c)){this._clicked=true;this.paginate(c)}},this));this._next.length&&this._next.bind("click.pagination",this.bind(function(){var c=
this._currentPageNum+1;if(this.validNewPage(c)){this._clicked=true;this.paginate(c)}},this))},disableNavSelection:function(a){if(typeof a.onselectstart!="undefined")a.onselectstart=function(){return false};else if(typeof a.style.MozUserSelect!="undefined")a.style.MozUserSelect="none";else a.onmousedown=function(){return false}},getNewPage:function(a,b){if(b.is(a.currentPage))return this._currentPageNum;if(b.is(a.pages))return a.pages.index(b)+1;if(b.is(a.first))return 1;if(b.is(a.last))return this._numPages;
if(b.is(a.previous))return a.pages.index(a.currentPage);if(b.is(a.next))return a.pages.index(a.currentPage)+2},validNewPage:function(a){return a!==this._currentPageNum&&a>0&&a<=this._numPages},paginate:function(a){var b,c;b=this.updateItems(a);c=this.updatePages(a);this._currentPageNum=a;d.isFunction(this.options.callback)&&this.callback(a,b,c)},updateItems:function(a){var b=this.getItemRange(a);this._itemsHiding=this._itemsShowing;this._itemsShowing=this._items.slice(b.start,b.end);this._cssAnimSupport&&
this.options.animation.length?this.cssAnimations(a):this.jQueryAnimations(a);return b},getItemRange:function(a){var b={};b.start=(a-1)*this.options.perPage;b.end=b.start+this.options.perPage;if(b.end>this._items.length)b.end=this._items.length;return b},cssAnimations:function(a){clearInterval(this._delay);this._itemsHiding.removeClass(this.options.animation+" pag-invisible").addClass("pag-hidden");this._itemsShowing.removeClass("pag-hidden").addClass("pag-invisible");this._itemsOriented=this.getDirectedItems(a);
this._index=0;this._delay=setInterval(this.bind(function(){this._index===this._itemsOriented.length?clearInterval(this._delay):this._itemsOriented.eq(this._index).removeClass("pag-invisible").addClass(this.options.animation);this._index+=1},this),this.options.delay)},jQueryAnimations:function(a){clearInterval(this._delay);this._itemsHiding.addClass("pag-hidden");this._itemsShowing.fadeTo(0,0).removeClass("pag-hidden");this._itemsOriented=this.getDirectedItems(a);this._index=0;this._delay=setInterval(this.bind(function(){this._index===
this._itemsOriented.length?clearInterval(this._delay):this._itemsOriented.eq(this._index).fadeTo(this.options.fallback,1);this._index+=1},this),this.options.delay)},getDirectedItems:function(a){switch(this.options.direction){case "backwards":a=d(this._itemsShowing.get().reverse());break;case "random":a=d(this._itemsShowing.get().sort(function(){return Math.round(Math.random())-0.5}));break;case "auto":a=a>=this._currentPageNum?this._itemsShowing:d(this._itemsShowing.get().reverse());break;default:a=
this._itemsShowing;break}return a},updatePages:function(a){var b,c,e;b=this.getInterval(a);for(c in this._nav)if(this._nav.hasOwnProperty(c)){e=this._nav[c];this.updateBtns(e,a);this.updateCurrentPage(e,a);this.updatePagesShowing(e,b);this.updateBreaks(e,b)}return b},getInterval:function(a){var b,c;b=Math.ceil(this.options.midRange/2);c=this._numPages-this.options.midRange;c=a>b?Math.max(Math.min(a-b,c),0):0;a=a>b?Math.min(a+b-(this.options.midRange%2>0?1:0),this._numPages):Math.min(this.options.midRange,
this._numPages);return{start:c,end:a}},updateBtns:function(a,b){if(b===1){a.first.addClass("pag-disabled");a.previous.addClass("pag-disabled")}if(b===this._numPages){a.next.addClass("pag-disabled");a.last.addClass("pag-disabled")}if(this._currentPageNum===1&&b>1){a.first.removeClass("pag-disabled");a.previous.removeClass("pag-disabled")}if(this._currentPageNum===this._numPages&&b<this._numPages){a.next.removeClass("pag-disabled");a.last.removeClass("pag-disabled")}},updateCurrentPage:function(a,b){a.currentPage.removeClass("pag-current");
a.currentPage=a.pages.eq(b-1).addClass("pag-current")},updatePagesShowing:function(a,b){b=a.pages.slice(b.start,b.end).not(a.permPages);a.pagesShowing.not(b).addClass("pag-hidden");b.not(a.pagesShowing).removeClass("pag-hidden");a.pagesShowing=b},updateBreaks:function(a,b){b.start>this.options.startRange||this.options.startRange===0&&b.start>0?a.fstBreak.removeClass("pag-hidden"):a.fstBreak.addClass("pag-hidden");b.end<this._numPages-this.options.endRange?a.lstBreak.removeClass("pag-hidden"):a.lstBreak.addClass("pag-hidden")},
callback:function(a,b,c){a={current:a,interval:c,count:this._numPages};b={showing:this._itemsShowing,oncoming:this._items.slice(b.start+this.options.perPage,b.end+this.options.perPage),range:b,count:this._items.length};a.interval.start+=1;b.range.start+=1;this.options.callback(a,b)},bind:function(a,b){return function(){return a.apply(b,arguments)}},destroy:function(){this.jQdocument.unbind("keydown.pagination");this._container.unbind("mousewheel.pagination DOMMouseScroll.pagination");this._cssAnimSupport&&
this.options.animation.length?this._items.removeClass("animated pag-hidden pag-invisible "+this.options.animation):this._items.removeClass("pag-hidden").fadeTo(0,1);this._holder.unbind("click.pagination").empty()}};d.fn.pagination=function(a){var b=d.type(a);if(b==="object"){if(this.length&&!d.data(this,"pagination")){f=new g(this,a);this.each(function(){d.data(this,"pagination",f)})}return this}if(b==="string"&&a==="destroy"){f.destroy();this.each(function(){d.removeData(this,"pagination")});return this}if(b===
"number"&&a%1===0){f.validNewPage(a)&&f.paginate(a);return this}return this}})(jQuery,window,document);
