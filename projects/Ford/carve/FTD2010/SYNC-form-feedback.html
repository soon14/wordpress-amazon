<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<script src="Common.js" type="text/javascript"></script>
<script type="text/javascript">

		function checkTextArea(textString, countField, maxLength) {
		    alert(window.event.keyCode);
		    return !(document.getElementById(textString).value.length >= maxLength);
		}

		var a_messages = new Array();
		var a_fields = new Array();
		var series_list = new Array();
		var make_cks_list = new Array();
		var model_list = new Array();
		var model_cks_list = new Array();
		var derivative_list = new Array();
		var derivative_cks_list = new Array();
		var derivative_year_list = new Array();
		var derivative_brochure_code_list = new Array();
		var derivative_testdrive_code_list = new Array();
		var derivative_quote_code_list = new Array();
		var listContactPhone = new Array();
		var contactPhoneIndex = 0;
		//listSameValueField is the variable that will hold all fields needs to be matched for having same value (i.e. e-mail and confirm e-mail)
		var listSameValueField = new Array();
		var sameValueIndex = 0;
		var listComplexNeedUpdate = new Array();


		//Checking for selected date from the drop-down list
		function dateCheck(m, d, y)
		{
		    var select_array = document.getElementsByTagName("select");
		    var dob_array = new Array(10);
		    var count = 0;
		    
		    //Check if all the elements exist
		    if(m && d && y){
		        for(i = 0; i < select_array.length; i++){
		            if(select_array[i].id.indexOf("_Day") >= 0 || select_array[i].id.indexOf("_Month") >= 0 || select_array[i].id.indexOf("_Year") >= 0 ) {
		                dob_array[count] = select_array[i].id.substring(0, select_array[i].id.lastIndexOf("_"));
		                count ++;
		            }
		        }
		        var lastdobchecked;
		        for(i = 0; dob_array[i] ; i++) {
		            if(lastdobchecked != dob_array[i]) {
		                lastdobchecked = dob_array[i];
		                var day = document.getElementById(dob_array[i] + "_Day");
		                var month = document.getElementById(dob_array[i] + "_Month");
		                var year = document.getElementById(dob_array[i] + "_Year");
		                if(!(day.selectedIndex == 0 && month.selectedIndex == 0 && year.selectedIndex == 0)){
		                    if(day.selectedIndex == 0 || month.selectedIndex == 0 || year.selectedIndex == 0)
		                    {
		                        alert("Please enter a valid date.");
		                        return false;
		                    }
		                }
		            }
		        }
		        return true;


		        /*if(m){
		            //Check for months with only 30 days
		            if(m.value == "4" || m.value == "6" || m.value == "9" || m.value == "11"){
		                if(d.value == "31"){
		                    alert("There are only 30 days\nin this month")
		                    d.focus();
		                    return false;
		                }
		            }

		            if(m.value == "2"){ //Month of February
		                if(parseInt(y.value)%4 != 0 && d.value == "29"){ // If the year is divisible by 4 then it is a leap year
		                    alert("There are only 28 days in the month \nof February unless it is a leap year.")
		                    d.focus();
		                    return false;
		                }
		                else if(d.value == 30 || d.value == 31){ // There are never more than 29 days in February
		                    alert("There are never more than 29 days\nin the month of February")
		                    d.focus();
		                    return false;
		                }
		            }
		            return true;
		        }
		        else {
		            return true;
		        }*/
		    } else {
		        return true;
		    }
		}

		//Checking for selected date from the drop-down list
		function checkDay(obj)
		{
		    var oname = obj.id.substring(0, obj.id.lastIndexOf("_"));
		    var day = document.getElementById(oname + "_Day");
		    var month = document.getElementById(oname + "_Month");
		    var year = document.getElementById(oname + "_Year");

		    if(month && (month.value == "4" || month.value == "6" || month.value == "9" || month.value == "11")) {
		        if(day && day.selectedIndex > 30)
		            day.selectedIndex = 0;
		    }
		    else if(day && month && year && month.value == "2" && year.options[year.selectedIndex].value != '') {
		        if(parseInt(year.options[year.selectedIndex].value)%4 == 0 && day.selectedIndex > 29  )
		            day.selectedIndex = 0;
		        else if( parseInt(year.options[year.selectedIndex].value)%4 != 0 && day.selectedIndex > 28 )
		            day.selectedIndex = 0;
		    }
		}

		function toggle(element, group){
		    if(element.checked) {
		        document.getElementById(group).style.display="block";
		    }
		    else {
		        document.getElementById(group).style.display="none";
		    }
		}


		//Models will be populated based on a selected make
		function populateModels(element)
		{
		    var oname = element.id.substring(0, element.id.lastIndexOf("_"));
		    var modelDropDown = document.getElementById(oname + "_Model");
		    var defaultText="";
		    var selectedMake="";

		    if(!modelDropDown) {
		    	modelDropDown = document.getElementById(oname + "_Select Model");
		    }

		    defaultText=modelDropDown[0].text;

		    //find the make selected value
		    for(var z=0;z<element.length&&selectedMake.length==0;z++){
		        if(element[z].selected){
		            selectedMake=element[z].text;
		        }
		    }
		    //if CKS exist for the selected make set the CKS value otherwise reset to empty string
		    if(make_cks_list[selectedMake]){
		        if(document.getElementById(oname+"_Make_CKSCode")){
		            document.getElementById(oname+"_Make_CKSCode").value=make_cks_list[selectedMake];
		        }
		    }else{
		        if(document.getElementById(oname+"_Make_CKSCode")){
		            document.getElementById(oname+"_Make_CKSCode").value="";
		        }
		    }


		    modelDropDown.options.length=0;
		    var counter =0;

		    if (element.options[element.options.selectedIndex].value == "")
		    {
		        modelDropDown.options[counter]=document.createElement("OPTION");
		        modelDropDown.options[counter].text=defaultText;
		    }
		    else
		    {
		        modelDropDown.options[0]=document.createElement("OPTION");
		        modelDropDown.options[0].text=defaultText;
		        modelDropDown.options[0].value="";

		        while (counter < model_list[element.options[element.options.selectedIndex].value].length)
		        {
		             modelDropDown.options[counter+1]=document.createElement("OPTION");
		             modelDropDown.options[counter+1].text=model_list[element.options[element.options.selectedIndex].value][counter];
		             modelDropDown.options[counter+1].value=model_list[element.options[element.options.selectedIndex].value][counter];
		             counter ++;
		        }
		    }

		    populateSeries(modelDropDown);
		}


		//Series will be populated based on a selected model
		function populateSeries(element)
		{
		    var oname = element.id.substring(0, element.id.lastIndexOf("_"));
		    var seriesDropDown = document.getElementById(oname + "_Series");
		    var defaultText="";
		    var selectedModel="";

		    //find the model selected value
		    for(var z=0;z<element.length&&selectedModel.length==0;z++){
		        if(element[z].selected){
		            selectedModel=element[z].text;
		        }
		    }

		    //if CKS exist for the selected mode set the CKS value otherwise reset to empty string
		    if(model_cks_list[selectedModel]){
		        if(document.getElementById(oname+"_Model_CKSCode")){
		            document.getElementById(oname+"_Model_CKSCode").value=model_cks_list[selectedModel];
		        }
		    }else{
		        if(document.getElementById(oname+"_Model_CKSCode")){
		            document.getElementById(oname+"_Model_CKSCode").value="";
		        }
		    }

		    if(!seriesDropDown){
		        return false;
		    }

		    defaultText=seriesDropDown[0].text;

		    seriesDropDown.options.length=0;
		    var counter =0;

		    if (element.options[element.options.selectedIndex].value == "")
		    {
		        seriesDropDown.options[counter]=document.createElement("OPTION");
		        seriesDropDown.options[counter].text= defaultText;
		    }
		    else
		    {
		       seriesDropDown.options[0]=document.createElement("OPTION");
		       seriesDropDown.options[0].text=defaultText;
		       seriesDropDown.options[0].value="";

		       while (counter < series_list[element.options[element.options.selectedIndex].value].length)
		       {
		            seriesDropDown.options[counter+1]=document.createElement("OPTION");
		            seriesDropDown.options[counter+1].text=series_list[element.options[element.options.selectedIndex].value][counter];
		            seriesDropDown.options[counter+1].value=series_list[element.options[element.options.selectedIndex].value][counter];
		            counter ++;
		       }
		    }
		    updateDerivativeHiddenField(seriesDropDown);
		}


		function updateDerivativeHiddenField(element){
		    var oname = element.id.substring(0, element.id.lastIndexOf("_"))
		    var selectedDerivative="";

		    //find the derivative selected value
		    for(var z=0;z<element.length&&selectedDerivative.length==0;z++){
		        if(element[z].selected){
		            selectedDerivative=element[z].text;
		        }
		    }
		    //if CKS exist for the selected derivative set the CKS value otherwise reset to empty string
		    if(derivative_cks_list[selectedDerivative]){
		        if(document.getElementById(oname+"_Series_CKSCode")){
		            document.getElementById(oname+"_Series_CKSCode").value=derivative_cks_list[selectedDerivative];
		        }
		    }else{
		        if(document.getElementById(oname+"_Series_CKSCode")){
		            document.getElementById(oname+"_Series_CKSCode").value="";
		        }
		    }

		    //if year exist for the selected derivative set the year value otherwise reset to empty string
		    if(derivative_year_list[selectedDerivative]){
		        if(document.getElementById(oname+"_Series_Year")){
		            document.getElementById(oname+"_Series_Year").value=derivative_year_list[selectedDerivative];
		        }
		    }else{
		        if(document.getElementById(oname+"_Series_Year")){
		            document.getElementById(oname+"_Series_Year").value="";
		        }
		    }

		    //if brochure code exist for the selected derivative set the brochure code value otherwise reset to empty string
		    if(derivative_brochure_code_list[selectedDerivative]){
		        if(document.getElementById(oname+"_Series_Brochure_Code")){
		            document.getElementById(oname+"_Series_Brochure_Code").value=derivative_brochure_code_list[selectedDerivative];
		        }
		    }else{
		        if(document.getElementById(oname+"_Series_Brochure_Code")){
		            document.getElementById(oname+"_Series_Brochure_Code").value="";
		        }
		    }

		    //if testdrive code exist for the selected derivative set the testdrive code value otherwise reset to empty string
		    if(derivative_testdrive_code_list[selectedDerivative]){
		        if(document.getElementById(oname+"_Series_Testdrive_Code")){
		            document.getElementById(oname+"_Series_Testdrive_Code").value=derivative_testdrive_code_list[selectedDerivative];
		        }
		    }else{
		        if(document.getElementById(oname+"_Series_Testdrive_Code")){
		            document.getElementById(oname+"_Series_Testdrive_Code").value="";
		        }
		    }

		    //if quote code exist for the selected derivative set the brochure code value otherwise reset to empty string
		    if(derivative_quote_code_list[selectedDerivative]){
		        if(document.getElementById(oname+"_Series_Quote_Code")){
		            document.getElementById(oname+"_Series_Quote_Code").value=derivative_quote_code_list[selectedDerivative];
		        }
		    }else{
		        if(document.getElementById(oname+"_Series_Quote_Code")){
		            document.getElementById(oname+"_Series_Quote_Code").value="";
		        }
		    }


		    //alert("CKS:"+document.getElementById(oname+"_Series_CKSCode").value+" Year:"+document.getElementById(oname+"_Series_Year").value+" Brochure:"+document.getElementById(oname+"_Series_Brochure_Code").value+" Testdrive:"+document.getElementById(oname+"_Series_Testdrive_Code").value+" Quote:"+document.getElementById(oname+"_Series_Quote_Code").value);
		}


		function resetFields() {
		    var seriesDropDown = document.getElementById("derivative");
		    var modelDropDown = document.getElementById("modelonly");

		    if (seriesDropDown && modelDropDown){
		        seriesDropDown.options.length = 0;
		        modelDropDown.options.length = 0;

		        seriesDropDown.options[0] =new Option(" Select Derivative ", " Select Derivative ");
		        modelDropDown.options[0] =new Option (" Select Model ", " Select Model ");
		    }
		}
		
		function checkDOB(){
			var select_array = document.getElementsByTagName("select");
		    var dob_array = new Array(10);
		    var count = 0;
		    var today = new Date();
		    var inputDate = new Date();

		    //Check if all the elements exist
		        for(i = 0; i < select_array.length; i++){
		            if(select_array[i].id.indexOf("_Day") >= 0 || select_array[i].id.indexOf("_Month") >= 0 || select_array[i].id.indexOf("_Year") >= 0 ) {
		                dob_array[count] = select_array[i].id.substring(0, select_array[i].id.lastIndexOf("_"));
		                count ++;
		            }
		        }
		        var lastdobchecked;
		        for(i = 0; dob_array[i] ; i++) {
		            if(lastdobchecked != dob_array[i]) {
		                lastdobchecked = dob_array[i];
		                var day = document.getElementById(dob_array[i] + "_Day");
		                var month = document.getElementById(dob_array[i] + "_Month");
		                var year = document.getElementById(dob_array[i] + "_Year");
		                if(!(day.selectedIndex == 0 && month.selectedIndex == 0 && year.selectedIndex == 0)){
		                    if(day.selectedIndex == 0 || month.selectedIndex == 0 || year.selectedIndex == 0)
		                    {
		                        alert("Please enter a valid date.");
		                        return false;
		                    }
		                }
						inputDate.setFullYear(year.value,month.value,day.value);

		                if(inputDate > today){
		                  alert('Invalid date cannot accept future date.');
		                  return false;
		                } 
		                
		            }
		        }
		        return true;
		
		}

		function submitForm() {
			
		    if(!dateCheck(document.dragonflyform.Month, document.dragonflyform.Day, document.dragonflyform.Year)){
		        return false;
		    }
		    else {

		        if (!check_RTB()) {
		            return false;
		        }else if (!checkContactPhone()){
		            return false;
		        }else if (!checkSameValue()){
		            return false;
		        }else if (!checkConditionalMandatory()){
		            return false;
		        }else if(!checkDOB()){
					return false;
				}else {

		            if (document.getElementById('passwordFieldName') != null
		                    && document.getElementById('usernameFieldName') != null) {

		                var passwordValid = validatePassword(true,
		                        document.getElementById(document.getElementById('usernameFieldName').value),
		                        document.getElementById(document.getElementById('passwordFieldName').value));

		                if (!passwordValid) {
		                    return false;
		                }
		            }

		            var ecardPreview = document.getElementById('ecardpreview');
		            ecardPreview.value = "";
		            getForm().target='_self';
		            return true;
		        }
		    }
		}

		function previewECard(){
		    if (!check_RTB()) {
		        return false;
		    } else {
		        var ecardPreview = document.getElementById('ecardpreview');
		        ecardPreview.value = "true";
		        var pagenameIs = getForm().pagename.value;

		        
		        getForm().pagename.value="DFY/DFYECard/PreviewECard";
		        
		        getForm().target='_blank';
		        getForm().submit();

		        //Reset the values for submit purposes
		        getForm().pagename.value = pagenameIs;
		        getForm().target='_self';
		        ecardPreview.value = "";

		        return true;
		    }
		}

		function checkContactPhone(){
		    var z=0;
		    var noError=true;
		    var oForm=getForm();

		    //check if there is error in any complex form field type contactPhoneNumber
		    for(z=0;z<listContactPhone.length&&noError;z++){
		        if(oForm.elements[listContactPhone[z]['phone1']].value.replace(/(^\s+)|(\s+$)/g, '').length==0 && oForm.elements[listContactPhone[z]['phone2']].value.replace(/(^\s+)|(\s+$)/g, '').length==0 && oForm.elements[listContactPhone[z]['phone3']].value.replace(/(^\s+)|(\s+$)/g, '').length==0){
		            alert(listContactPhone[z]['message']);
		            noError=false;
		        }
		    }
		    return noError;
		}

		function checkSameValue(){
			var z=0;
			var noError=true;
			var oForm=getForm();

			for(z=0;z<listSameValueField.length&&noError;z++){
				if(oForm.elements[listSameValueField[z]['field1']].value != oForm.elements[listSameValueField[z]['field2']].value){
					alert(listSameValueField[z]['message']);
					noError=false;
				}
			}
			return noError;
		}
</script>
<link type="text/css" rel="stylesheet" href="themes/ftd/css/global.css" media="screen, projection" />
<link type="text/css" rel="stylesheet" href="themes/ftd/css/modules.css" media="screen, projection" />
<link type="text/css" rel="stylesheet" href="themes/ftd/css/print.css" media="print" />
</head>
<body>
<div class="feedback ltr">
<form name="dragonflyform" class="fbform" id="dragonflyform" action='sync-feedback-submmited.html' method="post" onSubmit="javascript: onSubmitForm();"><input type=hidden name="formname" value='feedback-form'><input type=hidden id="pagenumber" name="pagenumber" value='1'><input type=hidden name="ecardpreview" id="ecardpreview" value=""><input type=hidden name="preview" value='null'><input type=hidden name="embedded" value='true'><input type=hidden name="sitename" value='Master2'><input type=hidden name="site" value='Master2'><input type=hidden name="pagename" value="RTB/FormBuilder/Common/RequestProcessor"><input type=hidden name="cid" value='null'><input type="hidden" id="feedback_url" name="feedback_url" value="" />
            
            
          
          <div class="group"><div><label for="feedback_positive">Was this article useful?</label><div><div><input type="radio" class="radio" id="feedback_positive1" name="feedback_positive" value="Y" title="" checked="checked" /><label class="alt6">Yes</label></div><div><input type="radio" class="radio" id="feedback_positive2" name="feedback_positive" value="N" title=""  /><label class="alt6">No</label></div></div>
            
            
          </div>
          
            <div><label for="feedback_comment">Comment<span class="ast">*</span></label><input type="hidden" id="feedback_comment_remLength" name="feedback_comment_remLength" value=500><textarea id="feedback_comment" name="feedback_comment" title="" style="width:500px;height:100px;"   ></textarea>
            
            
          </div>

          </div>
					<p class="mandatory"></p>
					
              <div class="group buttons"><div>
            
            <input class="buttonright" type="submit" id="feedback_submit" name="feedback_submit" title="" value="Submit"  onClick="return submitForm()"/>
          
          </div></div></form></div>

<script type="text/javascript">
    var ffIds = new Array();
    var ffMandatoryMessages = new Array();
    var i = 0;
</script>

<script type="text/javascript">
    function checkConditionalMandatory(){
        var doValidation = false;
        //check whether either field was picked
        for( var i = 0; i < ffIds.length; i++){
            var formFieldValue = document.getElementById(ffIds[i]).value;
            if (formFieldValue != ""){
                doValidation = true;
                break;
            }
        }

        if (doValidation){
            for( var i = 0; i < ffIds.length; i++){
                var formFieldValue = document.getElementById(ffIds[i]).value;
                if (formFieldValue == ""){
                    alert (ffMandatoryMessages[i]);
                    return false;
                }
            }
        
        }

        return true;
    }
</script>

<script type="text/javascript">

a_fields['feedback_url'] = {'l':'feedback_url','r'   :false,'f'   :false,'mn'  :false,'mnmx':false,'mx'  :false,'grt' :false,'less':false,'v':""}
a_messages['feedback_url'] = {'r':"",'f'   :"",'mn'  :"",'mnmx':"",'mx'   :"",'grt' :"",'less':""}
a_fields['feedback_positive'] = {'l':'feedback_positive','r'   :false,'f'   :false,'mn'  :false,'mnmx':false,'mx'  :false,'grt' :false,'less':false,'v':""}
a_messages['feedback_positive'] = {'r':"",'f'   :"",'mn'  :"",'mnmx':"",'mx'   :"",'grt' :"",'less':""}
a_fields['feedback_comment'] = {'l':'feedback_comment','r'   :false,'f'   :false,'mn'  :false,'mnmx':false,'mx'  :false,'grt' :false,'less':false,'v':""}
a_messages['feedback_comment'] = {'r':"",'f'   :"",'mn'  :"",'mnmx':"",'mx'   :"",'grt' :"",'less':""}
a_fields['feedback_comment']['r'] = true
a_messages['feedback_comment']['r'] = 'comment is required'
a_fields['feedback_comment']['mx'] = '500'
a_messages['feedback_comment']['mx'] = ''        
            document.getElementById('feedback_comment').onkeypress = function(event) { 
                if(window.event) { return !(this.value.length >= document.getElementById(this.id+"_remLength").value);}
                else if(event) { if(event.keyCode == 0) {return !(this.value.length >= document.getElementById(this.id+"_remLength").value);}}
                else { if(document.getElementById(this.id+"_remLength")){ 
                    if(parseInt(this.value.length) == document.getElementById(this.id+"_remLength").value){ return false; }}} }
                
        
a_fields['feedback_submit'] = {'l':'feedback_submit','r'   :false,'f'   :false,'mn'  :false,'mnmx':false,'mx'  :false,'grt' :false,'less':false,'v':""}
a_messages['feedback_submit'] = {'r':"",'f'   :"",'mn'  :"",'mnmx':"",'mx'   :"",'grt' :"",'less':""}
</script><script type="text/javascript">
            function onSubmitForm(){
                
            }
            // regular expressions or function to validate the format
            var re_dt = /^(\d{1,2})\-(\d{1,2})\-(\d{4})$/;
            var re_tm = /^(\d{1,2})\:(\d{1,2})\:(\d{1,2})$/;
            var a_formats = {

                 'alpha'       : /^[^0-9`~\s!\\@#$%\^&*()=+{\]\[}?\/,\><]*$/,
                 'alphaspaces' : /^[^0-9`~!\\@#$%^&*()=+{\]\[}?\/,\><]+[^`~!@#$%^&*()=+{\]\[}?\/,\><]*$/,
                 'alphanum'    : /^[^`~!\\#%^*={\]\[}?\/,\><]+$/,
                 'alphanumspecial'    : /^[^`~!#%^*=,{\]}?><]+$/,
                 'unsigned'    : /^\d+$/,
                 'integer'     : /^[\+\-]?\d*$/,
                 'positive_integer'     : /^[^\-\s][\+]?\d*$/,
                 'real'        : /^[\+\-]?\d*\.?\d*$/,
                 'email'       : /^[A-Za-z0-9]+([_\.-][A-Za-z0-9]+)*@[A-Za-z0-9]+([_\.-][A-Za-z0-9]+)*\.([A-Za-z]){2,4}$/i,
                 'phone'       : /^[\d\.\s\-()]+$/,
                 'year'        : /^19\d{2}|20\d{2}$/,
                 'date'        : function (s_date) {
                 // check format
                 if (!re_dt.test(s_date))
                     return false;
                // check allowed ranges
                if (RegExp.$1 > 31 || RegExp.$2 > 12)
                     return false;
                // check number of day in month
                var dt_test = new Date(RegExp.$3, Number(RegExp.$2-1), RegExp.$1);
                if (dt_test.getMonth() != Number(RegExp.$2-1))
                     return false;
                return true;
                },
                'time'    : function validate_time(s_time) {
                // check format
                 if (!re_tm.test(s_time))
                      return false;
                 // check allowed ranges
                 if (RegExp.$1 > 23 || RegExp.$2 > 59 || RegExp.$3 > 59)
                      return false;
                 return true;
                 }
           };

            

    function getForm(){
        for (var f in document.forms) {
            if(document.forms[f].name == "dragonflyform") {
                return document.forms[f];
            }
        }   
    }
    
    // validator counstruction routine
    function validator(s_form, a_fields, o_cfg)
    {
        this.f_error = display_validator_error;
        this.f_alert = o_cfg && o_cfg.alert
            ? function(s_msg) { alert(s_msg); return false }
            : function() { return false };

        // check required parameters
        if (!s_form)
            return this.f_alert(this.f_error(0));
        this.s_form = s_form;

        if (!a_fields || typeof(a_fields) != 'object')
            return this.f_alert(this.f_error(1));
        this.a_fields = a_fields;

        this.a_2disable = o_cfg && o_cfg['to_disable'] && typeof(o_cfg['to_disable']) == 'object'
            ? o_cfg['to_disable']
            : [];

        this.exec = validator_exec;
    }

    // is controlling method which should be called after checkFields in ContentForm1, you can define your own test in array and alert will appear if test fails
    function check_RTB()
    {
        o_config =
        {
            'to_disable' : ['Submit', ''],
            'alert' : 1
        }
        // validator constructor call
        var v = new validator('AppForm', this.a_fields, o_config);

        //alert(this.a_fields);

        return validator_exec(this.a_fields);
    }

    // this method performs the bulk of the work for validation
    function validator_exec(a_fields)
    {

        var temp_map=new Array();
        
        // check integrity of the form fields description structure
        for (var n_key in a_fields)
        {

            var o_input;
            found = false;            

            o_input = getForm().elements[n_key];

            if (!o_input) {
                //alert(n_key);
                //return false;
            }else{
                // check input description entry
                a_fields[n_key]['n'] = n_key;
                if (!a_fields[n_key]['l']) {
                    return false;
                }
                a_fields[n_key].o_input = o_input;
                temp_map[n_key]=a_fields[n_key];
            }            
        }
        a_fields=temp_map;

        //alert('2 temp_map' + temp_map);

        // collect values depending on the type of the input
        for (var n_key in a_fields)
        {
        
            //alert("2 n_key="+n_key);

            var s_value = '';
            o_input = a_fields[n_key].o_input;
            if (o_input.type == 'checkbox') // checkbox
                s_value = o_input.checked ? o_input.value : '';
            else if (o_input.value) // text, password, hidden
                s_value = o_input.value;
            else if (o_input.options) // select
                s_value = o_input.selectedIndex > -1
                    ? o_input.options[o_input.selectedIndex].value
                    : null;
            else if (o_input.length > 0) // radiobuton
                for (var n_index = 0; n_index < o_input.length; n_index++)
                    if (o_input[n_index].checked)
                    {
                        s_value = o_input[n_index].value;
                        break;
                    }

            //if it is an empty string trim it else don't
            //alert(n_key+" : "+s_value.replace(/(^\s+)|(\s+$)/g, '').length);
            if(s_value.replace(/(^\s+)|(\s+$)/g, '').length==0){
               a_fields[n_key]['v'] = s_value.replace(/(^\s+)|(\s+$)/g, '');               
            }else{
               a_fields[n_key]['v'] = s_value;
               
            }

            //alert(n_key+": "+a_fields[n_key]['v'].length);
        }



        // check for errors and display error message as defined in a_messages array.  Note: this behaves differently to test page InputText.html.  InputText gather all messages and then
        // displayed one alert with all messages.  contentServer behaves differently so now displays alert and exits immediately.
        var n_errors_count = 0,
        n_another, o_format_check;

        //alert(a_fields);

        // loop thru the array you've defined with fields to validate against rules
        for (var n_key in a_fields)
        {

            o_format_check = a_fields[n_key]['f'] && a_formats[a_fields[n_key]['f']]
                ? a_formats[a_fields[n_key]['f']]
                : null;

            // //alert("RTB debug - text field:+ " n_key: " + n_key); //

            //check if field is mandatory or not
            if (a_fields[n_key]['r'] && String(a_fields[n_key]['v']).length == 0)
            {
                display_validator_error(n_key, 'r');
                return false;
            }

            // check length of the text entered, minimun (mn) first
            else if (a_fields[n_key]['mn'] && String(a_fields[n_key]['v']).length < a_fields[n_key]['mn'])
            {
                //if mandatory is set to no and the length of the value is 0, don't do the checking
                if(String(a_fields[n_key]['v']).length > 0){
                    display_validator_error(n_key, 'mn');
                    return false;
                }
            }

            // check if field follows the correct format
            //else if (a_fields[n_key]['f'])
            //{
            //    alert('1')
            //    display_validator_error(n_key, 'f');
            //    return false;
            //}

            // check the text entered for year (yr)
            else if (a_fields[n_key]['yr'] && (String(a_fields[n_key]['v']).length < a_fields[n_key]['yr'] || String(a_fields[n_key]['v']).length > a_fields[n_key]['yr']))
            {
                display_validator_error(n_key, 'yr');
                return false;
            }

            // check length of the text entered, must equal to (mnmx)
            else if (a_fields[n_key]['mnmx'] && String(a_fields[n_key]['v']).length > a_fields[n_key]['mnmx'])
            {
                display_validator_error(n_key, 'mnmx');
                return false;
            }

            // check length of the text entered, must be greater than the value specified


            //var x = new Number(parseInt(a_fields[n_key]['v'].value));
            //var y  = new Number(parseInt(a_fields[n_key]['grt']));

            //alert(x);

            else if (a_fields[n_key]['grt'] && parseInt(a_fields[n_key]['v']) < parseInt(a_fields[n_key]['grt']))
            {
                display_validator_error(n_key, 'grt');
                return false;
            }

            // check length of the text entered, must be less than the value specified
            else if (a_fields[n_key]['less'] && parseInt(a_fields[n_key]['v']) > parseInt(a_fields[n_key]['less']))
            {
                display_validator_error(n_key, 'less');
                return false;
            }

            // now check maximum length
            else if (a_fields[n_key]['mx'] && String(a_fields[n_key]['v']).length > a_fields[n_key]['mx'])
            {
                display_validator_error(n_key, 'mx');
                return false;
            }

            // check if format of the value passes rules defined
            else if (a_fields[n_key]['v'] && a_fields[n_key]['f']
                    && ((typeof(o_format_check) == 'function'  && !o_format_check(a_fields[n_key]['v']))
                            || (typeof(o_format_check) != 'function'  && !o_format_check.test(a_fields[n_key]['v'])))
            )
            {
                display_validator_error(n_key, 'f');
                return false;
            }

            // check match
            else if (a_fields[n_key]['m'])
            {
                for (var n_key2 in a_fields)
                {
                    if (n_key2 == a_fields[n_key]['m'])
                    {
                        n_another = n_key2;
                        break;
                    }
                }
                if (n_another == null)
                {
                    display_validator_error(n_key, 'm');
                    return false;
                }
                if (a_fields[n_another]['v'] != a_fields[n_key]['v'])
                {
                    display_validator_error(n_key, 'm');
                    return false;
                }
            }
         }
        return true;

        }

    // the a_field array row should be based as 2nd argument, this method then substitues the attributes of the array row object to format an error message to display

        function display_validator_error(element, type)

        {

            //alert("error for field=" + element + ", error type=" + type)
            var s_message = a_messages[element][type];
            // now display alert
              alert(s_message); 
        }
    
            
                
            

function validatePassword(shouldValidate, username, password) {

    var valid = true;
    
    if (!shouldValidate) {
        return true;
    }
    
    //check pass length
    if (valid && password.value.length < 6) {
        alert('');
        valid = false;
    }

    //check if password contains username
    if (valid && password.value.indexOf(username.value) != -1) {
        alert('');
        valid = false;
    }

    return valid;
}





            //call the update function for complex form field
            var updateComplexEval = "";
            for(var updateComplexFieldId in listComplexNeedUpdate) {
                updateComplexEval="updateValidation_"+updateComplexFieldId+"(null);";
                eval(updateComplexEval);
            }
        </script>

